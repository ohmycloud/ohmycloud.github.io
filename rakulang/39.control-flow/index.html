<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">

    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    
    
    

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

    
    <meta name="referrer" content="no-referrer">

    <title>
        
            控制流 ❚ 焉知非鱼
        
    </title>

    
    


    
    
    
    

    
    
    
    

    
    
    

    
    
    
    <style>
     
     
     :root {
         --theme-color: #ac4142;
         --theme-color-light: rgba(172, 65, 66, 0.2);
     }
     
     html {
         line-height: 1.5;
     }
    </style>

    
    

    
    
    
    
    <link rel="stylesheet" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css">
    
    <link rel="preload" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css" as="style">

    



    
        <style>
         
         /* Background */ .chroma { background-color: #ffffff }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
/* LineHighlight */ .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* LineNumbers */ .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

         
         /* Overrides on top of the theme and Chroma CSS */
/* Chroma-based lines highlighting in code blocks */
.chroma .hl {
    background-color: #e8e8e8;
    /* Extend highlight up to 100 characters (assuming that the code blocks never have more than 100 characters in a line) */
    min-width: 100ch;
}
/* GenericHeading */ .chroma .gh { color: #999999; font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa; font-weight: bold }

         
        </style>
    

    

    
    
    

    
    <script src="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js"></script>
    
    <link rel="preload" href="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js" as="script">

    
    
    <script defer src="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js"></script>
    
    <link rel="preload" href="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js" as="script">

    

    

    
    
    

    
    
<!-- rel="me" links for IndieAuth -->







    
 
<meta property="og:title" content="控制流" />
<meta property="og:description"
      content=" " />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/rakulang/39.control-flow/" />


    
        <meta property="article:published_time" content="2018-11-14T21:13:31&#43;08:00"/>
    
    
        <meta property="article:modified_time" content="2018-11-14T21:13:31&#43;08:00"/>
    









    




     <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="控制流"/>
<meta name="twitter:description" content=" "/>


    
    
    <link rel="alternate" type="application/jf2post+json" href="http://localhost:1313/rakulang/39.control-flow/jf2post.json" title="Jf2post for 焉知非鱼" />
    
     



    
    
    
        
    


     
        
        <meta name="DC.Creator" content="焉知非鱼"/>
    



    
    
    
    <meta name="hugo-build-date" content="2024-03-01T16:16:06Z"/>
    <meta name="hugo-commit-hash" content="312735366b20d64bd61bff8627f593749f86c964"/>
    <meta name="generator" content="Hugo 0.123.7">
</head>


    
        <body lang="en">
    

        
        <div class="border" id="home"></div>

        <div class="wrapper">   
            
<nav id="nav" class="nav-collapse opened" aria-hidden="false">
    <ul class="navbar">
        <li><a class="" href="/">Home</a></li>
        
            
                <li><a class="" href="http://localhost:1313/posts/">Posts</a></li>
            
        
            
                <li><a class="" href="http://localhost:1313/notes/">Notes</a></li>
            
        
            
                <li><a class="" href="http://localhost:1313/rakulang/">Rakulang</a></li>
            
        
        
            <li><a class="" href="http://localhost:1313/search/">Search</a></li>
        
    </ul>
</nav>

            <div class="container">
                <header class="masthead">
                    <div class="masthead-title no-text-decoration">
                        <a href="/">焉知非鱼</a> <span class="blinking-cursor">❚</span>
                    </div>
                    <div class="masthead-tagline">
                        Wait the light to fall
                    </div>
                </header>

                








<article class="post h-entry rakulang">
    <header>
        <div class="center">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="http://localhost:1313/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="http://localhost:1313/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>

        <h1 class="post-title p-name">控制流</h1>

        
        <data class="u-url" value="http://localhost:1313/rakulang/39.control-flow/"></data>

        <div class="date-syndication">
            


    
    
    <div class="post-date">
        
        <time datetime="2018-11-14T21:13:31+0800" class="dt-published">Wed Nov 14, 2018</time>
        
        
    </div>


            




        </div>
         



    
    
    
        
    


    
        
        <span class="hide">
            &mdash; <a href="http://localhost:1313/" class="u-author">焉知非鱼</a>
        </span>
    


    </header>

    <div class="content">
        


        





                       


        <div class="e-content">
            




<h1 id="语句">语句</h1>
<p>Raku 程序由一个或多个语句组成。简单语句由分号分隔。以下程序将打印 “Hello”，然后在下一行打印“World”。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Hello</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">World</span><span class="p">&#34;;</span>
</span></span></code></pre></div><p>在语句中出现空白的大多数地方，且在分号之前，语句可能会分成许多行。此外，多个语句可能出现在同一行。这会很尴尬，但上面的内容也可以写成：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span>
</span></span><span class="line"><span class="cl"><span class="p">&#34;</span><span class="s2">Hello</span><span class="p">&#34;;</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">World</span><span class="p">&#34;;</span>
</span></span></code></pre></div><h1 id="块儿httpsdocsrakuorglanguagecontrol___top"><a href="https://docs.raku.org/language/control#___top">块儿</a></h1>
<p>与许多语言一样，Raku 使用 <code>{</code> 和 <code>}</code> 将 <code>blocks</code>括起来以将多个语句转换为单个语句。可以省略块中最后一个语句和闭合 <code>}</code>之间的分号。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Hello</span><span class="p">&#34;;</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">World</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p>When a block stands alone as a statement, it will be entered immediately after the previous statement finishes, and the statements inside it will be executed.</p>
<p>当块单独作为一个语句存在时，它将在前一个语句完成后立即进入，并且其中的语句将被执行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="mi">1</span><span class="p">;</span>                    <span class="c1"># OUTPUT: «1» </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="nb">say</span> <span class="mi">2</span><span class="p">;</span> <span class="nb">say</span> <span class="mi">3</span> <span class="p">};</span>         <span class="c1"># OUTPUT: «23» </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="mi">4</span><span class="p">;</span>                    <span class="c1"># OUTPUT: «4» </span>
</span></span></code></pre></div><p>除非它作为一个语句单独存在，否则一个块只会创建一个闭包。内部的语句不会立即执行。闭包是另一个主题，如何使用它们在<a href="https://docs.raku.org/language/functions#Blocks_and_lambdas">别处</a>有解释。现在，了解块何时运行以及何时不运行是非常重要的：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">We get here</span><span class="p">&#34;;</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">then here.</span><span class="p">&#34;</span> <span class="p">};</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">not here</span><span class="p">&#34;;</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="ow">or</span> <span class="nb">die</span><span class="p">;</span>
</span></span></code></pre></div><p>在上面的示例中，在运行第一个语句之后，第一个块独立作为第二个语句，因此我们运行里面的语句。第二个块不是单独作为一个语句，所以相反，它创建了一个 <code>Block</code> 类型的对象，但不运行它。对象实例通常被认为是 true，因此代码不会死掉，即使该块被计算为 0，它是否被执行。该示例没有说明如何处理<code>Block</code>对象，因此它会被丢弃。</p>
<p>下面介绍的大多数流控制结构只是告诉 Raku 何时，如何以及多少次进入像第二个块那样的块。</p>
<p>在我们深入这些之前，关于语法的一个重要的注意事项：如果在通常放置分号的结束大括号之后的行上没有任何内容（或者只有注释），则不需要分号：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="c1"># All three of these lines can appear as a group, as is, in a program </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>                <span class="c1"># OUTPUT: «42» </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>                <span class="c1"># OUTPUT: «43» </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">};</span> <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>    <span class="c1"># OUTPUT: «42 43» </span>
</span></span></code></pre></div><p>&hellip;但是:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>    <span class="c1"># Syntax error </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="p">}</span> <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>    <span class="c1"># Also a syntax error, of course </span>
</span></span></code></pre></div><p>因此，在换行编辑器中退格时要小心：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span> <span class="p">&#34;</span><span class="s2">Without semicolons line-wrapping can be a bit treacherous.</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> \
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="c1"># Syntax error </span>
</span></span></code></pre></div><p>无论如何，在大多数语言中你必须注意这一点，以防止代码意外被注释掉。为清楚起见，下面的许多示例可能包含不必要的分号。</p>
<p>对于任何顶级表达式，类主体的行为类似于简单的块;  这同样适用于角色和其他包，如语法（实际上是类）或模块。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I live</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">die</span> <span class="p">&#34;</span><span class="s2">I will never live!</span><span class="p">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$c</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="nb">new</span><span class="p">;</span>                              │
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: Fails and writes «I live␤II will never live!␤I</span>
</span></span></code></pre></div><p>该块首先运行第一个语句，然后<code>die</code>打印第二个语句。<code>$c</code> 永远不会得到值。</p>
<h1 id="phasers">Phasers</h1>
<p>块可能有<em>phasers</em>：即将他们的执行分解成特别阶段运行阶段的特殊标记块。有关详细信息，请参阅页面<a href="https://docs.raku.org/language/phasers">phasers</a>。</p>
<h1 id="do">do</h1>
<p>块不能是独立的语句, 运行这样一个块的最简单方法是在它前面写上一个 <code>do</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="c1"># This dies half of the time </span>
</span></span><span class="line"><span class="cl"><span class="nb">do</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Heads I win, tails I die.</span><span class="p">&#34;;</span> <span class="kt">Bool</span><span class="o">.</span><span class="nb">pick</span> <span class="p">}</span> <span class="ow">or</span> <span class="nb">die</span><span class="p">;</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I win.</span><span class="p">&#34;;</span>
</span></span></code></pre></div><p>请注意，您需要在 <code>do</code> 和块之间留一个空格。</p>
<p>整个 <code>do {...}</code> 计算为块儿的最终值。当需要该值时，将运行该块以计算表达式的剩余部分。所以：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="kt">False</span> <span class="ow">and</span> <span class="nb">do</span> <span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">};</span>
</span></span></code></pre></div><p>&hellip;不会打印 42。但是，每次计算包含它的表达式时，只会计算一次：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="c1"># This says &#34;(..1 ..2 ..3)&#34; not &#34;(..1 ...2 ....3)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$f</span> <span class="o">=</span> <span class="p">&#34;</span><span class="s2">.</span><span class="p">&#34;;</span> <span class="nb">say</span> <span class="nb">do</span> <span class="p">{</span> <span class="nv">$f</span> <span class="o">~=</span> <span class="p">&#34;</span><span class="s2">.</span><span class="p">&#34;</span> <span class="p">}</span> <span class="ow">X</span><span class="o">~</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="p">;</span>
</span></span></code></pre></div><p>换句话说，它遵循与其他所有东西相同的具体规则。</p>
<p>从技术上讲，<code>do</code> 是一个只运行一次迭代的循环。</p>
<p><code>do</code> 也可以用在一个裸语句上（没有花括号）但这主要是为了避免需要用圆括号扩住语句的语法，如果它是表达式中的最后一个：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="mi">3</span><span class="o">,</span> <span class="nb">do</span> <span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="mi">2</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># OUTPUT: «(3, 2)» </span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span><span class="o">,</span>   <span class="p">(</span><span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="mi">2</span> <span class="p">})</span> <span class="p">;</span> <span class="c1"># OUTPUT: «(3, 2)» </span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span><span class="o">,</span>    <span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="mi">2</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># Syntax error </span>
</span></span></code></pre></div><h1 id="start">start</h1>
<p><strong>异步</strong>运行块的最简单方法是在它之前写上一个 <code>start</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">start</span> <span class="p">{</span> <span class="nb">sleep</span> <span class="mi">1</span><span class="p">;</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">done</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">working</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># working, done </span>
</span></span></code></pre></div><p>请注意，您需要在 <code>start</code> 和块儿之间留一个空格。在上面的示例中，<code>start</code> 块处于 sink 上下文中，因为它未赋值给变量。从版本 6.d 开始，这种块儿附加了一个异常处理程序：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">start</span> <span class="p">{</span> <span class="nb">die</span> <span class="p">&#34;</span><span class="s2">We&#39;re dead</span><span class="p">&#34;;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">working</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="nb">sleep</span> <span class="mi">10</span><span class="p">;</span>
</span></span></code></pre></div><p>此代码将在版本 6.d 中打印 <code>Unhandled exception in code scheduled on thread 4 We're dead</code>，而在版本 6.c 中等待 10 秒后它将立即退出。</p>
<p>如果你对块儿的结果不感兴趣, <code>start {...}</code> 会立即返回一个可被安全忽略的 <code>Promise</code>。如果你对块儿的最终值<strong>感</strong>兴趣，你可以调用返回的 promise 上的 <code>.result</code> 方法。所以：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$promise</span> <span class="o">=</span> <span class="k">start</span> <span class="p">{</span> <span class="nb">sleep</span> <span class="mi">10</span><span class="p">;</span> <span class="mi">42</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ... do other stuff </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">The result is </span><span class="nv">$promise</span><span class="o">.</span><span class="nf">result</span><span class="p">()&#34;;</span>
</span></span></code></pre></div><p>如果块内的代码尚未完成，则 <code>.result</code> 调用将等待直到完成。</p>
<p><code>start</code> 也可用于裸语句（不带花括号）。这主要用于, 当在对象上调用子例程/方法是异步执行的唯一事情时。</p>
<h1 id="if">if</h1>
<p>要有条件地运行代码块，请使用 <code>if</code> 后跟条件。条件，表达式，将在 <code>if</code> 完成之前的语句之后立即进行计算。只有在条件被强转为 <code>Bool</code> 为真时, 才会计算附加到条件的块。与某些语言不同，条件不必用圆括号括起来，而块周围的 <code>{</code> 和 <code>}</code> 是必需的：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">1 is true</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># says &#34;1 is true&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">1</span>   <span class="p">&#34;</span><span class="s2">1 is true</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span>    <span class="p">;</span> <span class="c1"># syntax error, missing block </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">0 is true</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># does not say anything, because 0 is false </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">0</span> <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">};</span> <span class="c1"># says &#34;42&#34; but does not say &#34;43&#34; </span>
</span></span></code></pre></div><p>还有一种“语句修饰符”的形式的 <code>if</code>。在这种情况下，if 和 then 条件在您想要有条件地运行的代码之后。请注意，仍然始终首先计算条件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="k">if</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1"># says &#34;42&#34; but does not say &#34;43&#34; </span>
</span></span><span class="line"><span class="cl"><span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="k">if</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">1</span><span class="p">;</span>     <span class="c1"># says &#34;42&#34; and then says &#34;43&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">It is easier to read code when &#39;if&#39;s are kept on left of screen</span><span class="p">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="kt">True</span><span class="p">;</span>                <span class="c1"># says the above, because it is true </span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="k">if</span> <span class="kt">True</span><span class="p">;</span>         <span class="c1"># says &#34;43&#34; as well </span>
</span></span></code></pre></div><p>语句修饰符形式最好谨慎使用。</p>
<p><code>if</code> 语句本身要么 <a href="https://docs.raku.org/type/Slip">slip</a>我们一个空列表，如果它不运行块，否则就会返回该块产生的值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nv">$d</span><span class="p">);</span> <span class="c1"># says &#34;(1 3 0)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nv">$c</span><span class="p">);</span> <span class="c1"># says &#34;(1 2 3 42)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="k">if</span> <span class="mi">1</span> <span class="p">{</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">2</span> <span class="p">})</span><span class="o">,</span> <span class="mi">3</span><span class="p">);</span>         <span class="c1"># does not slip, says &#34;(1 (2 2) 3)&#34; </span>
</span></span></code></pre></div><p>对于语句修饰符，是一样的，除非你有语句的值而不是块：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="mi">42</span> <span class="k">if</span> <span class="kt">True</span><span class="p">)</span> <span class="o">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1"># says &#34;(1 42 2)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="mi">42</span> <span class="k">if</span> <span class="kt">False</span><span class="p">)</span><span class="o">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1"># says &#34;(1 2)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span>  <span class="mi">42</span> <span class="k">if</span> <span class="kt">False</span> <span class="o">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1"># says &#34;(1 42)&#34; because &#34;if False, 2&#34; is true </span>
</span></span></code></pre></div><p><code>if</code> 默认不改变主题变量（<code>$_</code>）。为了访问条件表达式生成的值，您必须更强烈地要求它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="mi">42</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>                <span class="p">;</span> <span class="c1"># says &#34;1&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="mi">42</span> <span class="k">-&gt;</span> <span class="nv">$_</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>          <span class="p">;</span> <span class="c1"># says &#34;42&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="mi">42</span> <span class="k">-&gt;</span> <span class="nv">$a</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>  <span class="nv">$a</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;1&#34; then says &#34;42&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="mi">42</span>       <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="nv">$^a</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;1&#34; then says &#34;42&#34; </span>
</span></span></code></pre></div><h2 id="elseelsif">else/elsif&nbsp;<a class="headline-hash no-text-decoration" href="#elseelsif">#</a> </h2>
<p>组合条件可以通过用 <code>else</code> 跟在 <code>if</code> 条件后面来产生, 以提供一个备选块，当条件表达式为假来运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span>   <span class="p">;</span> <span class="c1"># says &#34;yes&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">else</span><span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span>    <span class="p">;</span> <span class="c1"># says &#34;yes&#34;, space is not required </span>
</span></span></code></pre></div><p><code>else</code> 不能用分号将条件语句分开，但作为一个特例，换行符是可行的。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">};</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># syntax error </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span>                     <span class="p">;</span> <span class="c1"># says &#34;yes&#34; </span>
</span></span></code></pre></div><p>使用 <code>elsif</code>, 额外的条件可以被夹在 <code>if</code> 和 <code>else</code> 之间。只有在前面的所有条件都为假的情况下才会计算额外条件，并且只运行第一个真实条件旁边的块。如果你愿意，你可以以一个 <code>elsif</code> 而不是一个 <code>else</code> 结束。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">elsif</span> <span class="kt">False</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">NO</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span> <span class="c1"># says &#34;yes&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">elsif</span> <span class="kt">True</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">YES</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span> <span class="c1"># says &#34;YES&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">elsif</span> <span class="kt">False</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">NO</span><span class="p">&#34;</span> <span class="p">}</span> <span class="c1"># does not say anything </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">sub</span> <span class="nb">right</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">Right!</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="kt">True</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">wrong</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">Wrong!</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="kt">False</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nf">wrong</span><span class="p">()</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">elsif</span> <span class="nb">right</span><span class="p">()</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">maybe</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The above says &#34;Wrong!&#34; then says &#34;Right!&#34; then says &#34;yes&#34; </span>
</span></span></code></pre></div><p>您不能将语句修饰符形式用于 <code>else</code> 或 <code>elsif</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="k">if</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>            <span class="c1"># syntax error </span>
</span></span></code></pre></div><p>对于分号和换行, 所有相同的规则都适用，始终如一。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">0</span> <span class="p">};</span> <span class="k">elsif</span> <span class="mi">1</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">1</span> <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">how?</span><span class="p">&#34;</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># syntax error </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">0</span> <span class="p">}</span>  <span class="k">elsif</span> <span class="mi">1</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">1</span> <span class="p">};</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">how?</span><span class="p">&#34;</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># syntax error </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">0</span> <span class="p">}</span>  <span class="k">elsif</span> <span class="mi">1</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">1</span> <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">how?</span><span class="p">&#34;</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;1&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">0</span> <span class="p">}</span> <span class="k">elsif</span> <span class="mi">1</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">1</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">how?</span><span class="p">&#34;</span> <span class="p">}</span>                                    <span class="p">;</span> <span class="c1"># says &#34;1&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">0</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">elsif</span> <span class="mi">1</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">1</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">how?</span><span class="p">&#34;</span> <span class="p">}</span>                  <span class="p">;</span> <span class="c1"># says &#34;1&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span>        <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">no</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">elsif</span> <span class="kt">False</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">NO</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>        <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">yes</span><span class="p">&#34;</span> <span class="p">}</span>                              <span class="p">;</span> <span class="c1"># says &#34;yes&#34; </span>
</span></span></code></pre></div><p>整个东西要么<a href="https://docs.raku.org/type/Slip">slips</a>我们一个空列表（如果没有运行块）或者返回由运行的块产生的值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="p">&#34;</span><span class="s2">two</span><span class="p">&#34;;</span> <span class="p">}</span> <span class="k">elsif</span> <span class="kt">False</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">+=</span> <span class="mi">43</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">3</span><span class="o">,</span> <span class="nv">$d</span><span class="p">);</span> <span class="c1"># says &#34;(1 3 0)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="p">&#34;</span><span class="s2">two</span><span class="p">&#34;;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">+=</span> <span class="mi">43</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="mi">3</span><span class="o">,</span> <span class="nv">$c</span><span class="p">);</span> <span class="c1"># says &#34;(1 2 3 43)&#34; </span>
</span></span></code></pre></div><p>可以在 <code>else</code> 中获取前一个表达式的值，它可以来自 <code>if</code> 或者最后一个 <code>elsif</code>,  如果存在的话：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="mi">0</span>     <span class="p">{</span> <span class="p">}</span> <span class="k">else</span> <span class="k">-&gt;</span> <span class="nv">$a</span> <span class="p">{</span> <span class="p">&#34;</span><span class="nv">$_</span><span class="s2"> </span><span class="nv">$a</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;1 0&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="kt">False</span> <span class="p">{</span> <span class="p">}</span> <span class="k">else</span> <span class="k">-&gt;</span> <span class="nv">$a</span> <span class="p">{</span> <span class="p">&#34;</span><span class="nv">$_</span><span class="s2"> </span><span class="nv">$a</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;1 False&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="kt">False</span> <span class="p">{</span> <span class="p">}</span> <span class="k">elsif</span> <span class="mi">0</span> <span class="p">{</span> <span class="p">}</span> <span class="k">else</span> <span class="k">-&gt;</span> <span class="nv">$a</span> <span class="p">{</span> <span class="nv">$a</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># says &#34;0&#34; </span>
</span></span></code></pre></div><h2 id="unless">unless&nbsp;<a class="headline-hash no-text-decoration" href="#unless">#</a> </h2>
<p>当你厌倦了输入 “if not (X)” 时，你可能会用 <code>unless</code> 来反转条件语句的意义。你不能使用把 <code>else</code> 或 <code>elsif</code> 与 <code>unless</code> 用在一起。因为那最终会让人感到困惑。除了这两个不同,  <code>unless</code> 的工作方式和 <a href="https://docs.raku.org/language/control#if">if</a> 相同：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">unless</span> <span class="mi">1</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">1 is false</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># does not say anything, since 1 is true </span>
</span></span><span class="line"><span class="cl"><span class="k">unless</span> <span class="mi">1</span>   <span class="p">&#34;</span><span class="s2">1 is false</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span>    <span class="p">;</span> <span class="c1"># syntax error, missing block </span>
</span></span><span class="line"><span class="cl"><span class="k">unless</span> <span class="mi">0</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">0 is false</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>  <span class="p">;</span> <span class="c1"># says &#34;0 is false&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">unless</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">1</span> <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;42&#34; but does not say &#34;43&#34; </span>
</span></span><span class="line"><span class="cl"><span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="k">unless</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">0</span><span class="p">;</span>      <span class="c1"># says &#34;42&#34; and then says &#34;43&#34; </span>
</span></span><span class="line"><span class="cl"><span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="k">unless</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="ow">and</span> <span class="mi">1</span><span class="p">;</span>      <span class="c1"># says &#34;42&#34; but does not say &#34;43&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">unless</span> <span class="mi">0</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>           <span class="p">;</span> <span class="c1"># says &#34;1&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">unless</span> <span class="mi">0</span> <span class="k">-&gt;</span> <span class="nv">$_</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>     <span class="p">;</span> <span class="c1"># says &#34;0&#34; </span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">unless</span> <span class="kt">False</span> <span class="k">-&gt;</span> <span class="nv">$a</span> <span class="p">{</span> <span class="nv">$a</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="p">;</span> <span class="c1"># says &#34;False&#34; </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="k">unless</span> <span class="mi">0</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nv">$c</span><span class="p">);</span> <span class="c1"># says &#34;(1 2 3 42)&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">say</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="p">(</span><span class="k">unless</span> <span class="mi">1</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">+=</span> <span class="mi">42</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nv">$d</span><span class="p">);</span> <span class="c1"># says &#34;(1 3 0)&#34; </span>
</span></span></code></pre></div><h2 id="with-orwith-withouthttpsdocsrakuorglanguagecontrol___top"><a href="https://docs.raku.org/language/control#___top"><code>with</code>, <code>orwith</code>, <code>without</code></a>&nbsp;<a class="headline-hash no-text-decoration" href="#with-orwith-withouthttpsdocsrakuorglanguagecontrol___top">#</a> </h2>
<p><code>with</code> 语句像 <code>if</code> 一样，但它测试 definedness 而不是真假。此外，它在条件上主题化，很像 <code>given</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">with</span> <span class="p">&#34;</span><span class="s2">abc</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">index</span><span class="p">(&#34;</span><span class="s2">a</span><span class="p">&#34;)</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span> <span class="p">}</span>      <span class="c1"># prints 0 </span>
</span></span></code></pre></div><p>代替 <code>elsif</code>，<code>orwith</code> 可用于链定义性测试：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="c1"># The below code says &#34;Found a at 0&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$s</span> <span class="o">=</span> <span class="p">&#34;</span><span class="s2">abc</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span>   <span class="nv">$s</span><span class="o">.</span><span class="nb">index</span><span class="p">(&#34;</span><span class="s2">a</span><span class="p">&#34;)</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Found a at </span><span class="nv">$_</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">orwith</span> <span class="nv">$s</span><span class="o">.</span><span class="nb">index</span><span class="p">(&#34;</span><span class="s2">b</span><span class="p">&#34;)</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Found b at </span><span class="nv">$_</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">orwith</span> <span class="nv">$s</span><span class="o">.</span><span class="nb">index</span><span class="p">(&#34;</span><span class="s2">c</span><span class="p">&#34;)</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Found c at </span><span class="nv">$_</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>                 <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Didn&#39;t find a, b or c</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p>您可以混合基于 <code>if</code> 和基于 <code>with</code> 的子句。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="c1"># This says &#34;Yes&#34; </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">No</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">orwith</span> <span class="kt">Nil</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">No</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">orwith</span> <span class="mi">0</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Yes</span><span class="p">&#34;</span> <span class="p">};</span>
</span></span></code></pre></div><p>与 <code>unless</code> 一样，您可以使用 <code>without</code> 检查 undefinedness，但是您可能不会添加一个 <code>else</code> 子句：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$answer</span> <span class="o">=</span> <span class="kt">Any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">without</span> <span class="nv">$answer</span> <span class="p">{</span> <span class="nb">warn</span> <span class="p">&#34;</span><span class="s2">Got: </span><span class="p">{</span><span class="nv">$_</span><span class="o">.</span><span class="nb">perl</span><span class="p">}&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p>也有 <code>with</code> 和 <code>without</code> 语句修饰符：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$answer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Any</span><span class="o">,</span> <span class="kt">True</span><span class="p">)</span><span class="o">.</span><span class="nb">roll</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="mi">42</span> <span class="k">with</span> <span class="nv">$answer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">warn</span> <span class="p">&#34;</span><span class="s2">undefined answer</span><span class="p">&#34;</span> <span class="k">without</span> <span class="nv">$answer</span><span class="p">;</span>
</span></span></code></pre></div><h1 id="when">when</h1>
<p><code>when</code> 块类似于 <code>if</code> 块，它们中的一个或两个都可以用在外部块中; 他们也都有一个“语句修饰符”形式。但是如何处理外部块中的相同代码是有区别的：当 <code>when</code> 块执行时，控制被传递到封闭块并忽略后面的语句; 但是当 <code>if</code> 块执行时，后面的语句会被执行。[<a href="https://docs.raku.org/language/control#fn-1">1]</a>以下例子应说明 <code>if</code> 或 <code>when</code> 块的默认行为，假设没有特殊出口或其他副作用的语句被包括在 <code>if</code> 或 <code>when</code> 块中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">X</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1"># if X is true in boolean context, block is executed </span>
</span></span><span class="line"><span class="cl">    <span class="c1"># following statements are executed regardless </span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="ow">X</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1"># if X is true in boolean context, block is executed </span>
</span></span><span class="line"><span class="cl">                 <span class="c1"># and control passes to the outer block </span>
</span></span><span class="line"><span class="cl">    <span class="c1"># following statements are NOT executed </span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>如果以上 <code>if</code> 和 <code>when</code> 块出现在文件作用域内，则在每种情况下都会执行后面的语句。</p>
<p>还有另外一个功能，<code>when</code> 有而 <code>if</code> 没有的：<code>when</code> 的布尔上下文测试默认为 <code>$_ ~~</code>，而 <code>if</code> 的不是。这会影响如何在没有 <code>$_</code> (在这种情况下是 <code>Any</code>。 并且 <code>Any</code> 智能匹配<code>True</code>：<code>Any ~~ True</code> 产生 <code>True</code>)值的 <code>when</code> 块儿中使用X。请看以下代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$b</span> <span class="o">=</span> <span class="kt">True</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="nv">$a</span>    <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;</span> <span class="p">};</span> <span class="c1"># no output </span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="nb">so</span> <span class="nv">$a</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;</span> <span class="p">}</span>  <span class="c1"># a (in &#34;so $a&#34; &#39;so&#39; coerces $a to Boolean context True </span>
</span></span><span class="line"><span class="cl">                            <span class="c1"># which matches with Any) </span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="nv">$b</span>    <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">b</span><span class="p">&#39;</span> <span class="p">};</span> <span class="c1"># no output (this statement won&#39;t be run) </span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>最后，<code>when</code> 语句修饰符形式不影响在另一个块内部或外部执行以下语句：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span> <span class="k">when</span> <span class="ow">X</span><span class="err">;</span> <span class="c1"># if X is true statement is executed </span>
</span></span><span class="line"><span class="cl">                  <span class="c1"># following statements are not affected </span>
</span></span></code></pre></div><p>由于成功匹配将退出块，这段代码的行为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="kt">True</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="o">=</span> <span class="nb">do</span> <span class="k">when</span> <span class="o">.</span><span class="nb">so</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nv">$a</span><span class="p">;</span> <span class="c1"># OUTPUT: «(Any)» </span>
</span></span></code></pre></div><p>解释了，因为在存储或处理任何值之前放弃了 <code>do</code> 块。但是，在这种情况下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="kt">False</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="o">=</span> <span class="nb">do</span> <span class="k">when</span> <span class="o">.</span><span class="nb">so</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nv">$a</span><span class="p">;</span> <span class="c1"># OUTPUT: «False» </span>
</span></span></code></pre></div><p>因为比较是假的，所以不会放弃该块，因此 <code>$a</code> 实际上会得到一个值。</p>
<h1 id="for">for</h1>
<p><code>for</code> 循环迭代一个列表，每次迭代, 运行<a href="https://docs.raku.org/type/Block">块</a>中的语句一次，。如果块接受参数，则列表元素作为参数提供。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@foo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">.</span><span class="nb">print</span> <span class="p">}</span> <span class="c1"># prints each value contained in @foo </span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="p">{</span> <span class="o">.</span><span class="nb">print</span> <span class="p">}</span>   <span class="c1"># same thing, because .print implies a $_ argument </span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">print</span> <span class="p">}</span> <span class="c1"># prints 42 as many times as @foo has elements </span>
</span></span></code></pre></div><p>当然，尖括号语法或<a href="https://docs.raku.org/language/variables#The_%5E_twigil">占位符</a>可用于命名参数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@foo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="k">-&gt;</span> <span class="nv">$item</span> <span class="p">{</span> <span class="nb">print</span> <span class="nv">$item</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="p">{</span> <span class="nb">print</span> <span class="nv">$^item</span> <span class="p">}</span>            <span class="c1"># same thing </span>
</span></span></code></pre></div><p>可以声明多个参数，在这种情况下，迭代器在运行块之前根据需要从列表中获取尽可能多的元素。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@foo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span><span class="o">.</span><span class="nb">kv</span> <span class="k">-&gt;</span> <span class="nv">$idx</span><span class="o">,</span> <span class="nv">$val</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$idx:</span><span class="s2"> </span><span class="nv">$val</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">%hash</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">a b c</span><span class="p">&gt;</span> <span class="ow">Z</span><span class="o">=&gt;</span> <span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">%hash</span><span class="o">.</span><span class="nb">kv</span> <span class="k">-&gt;</span> <span class="nv">$key</span><span class="o">,</span> <span class="nv">$val</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$key</span><span class="s2"> =&gt; </span><span class="nv">$val</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="mi">1</span><span class="o">,</span> <span class="mf">1.1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mf">2.1</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$^x</span><span class="s2"> &lt; </span><span class="nv">$^y</span><span class="p">&#34;</span> <span class="p">}</span>  <span class="c1"># says &#34;1 &lt; 1.1&#34; then says &#34;2 &lt; 2.1&#34; </span>
</span></span></code></pre></div><p>尖块的参数可以具有默认值，允许处理缺少元素的列表。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@list</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@list</span> <span class="k">-&gt;</span> <span class="nv">$a</span><span class="o">,</span> <span class="nv">$b</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">N/A</span><span class="p">&#39;</span><span class="o">,</span> <span class="nv">$c</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">N/A</span><span class="p">&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$a</span><span class="s2"> </span><span class="nv">$b</span><span class="s2"> </span><span class="nv">$c</span><span class="p">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «1 2 3</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span><span class="o">»</span> 
</span></span></code></pre></div><p>If the postfix form of <code>for</code> is used a block is not required and the topic is set for the statement list.</p>
<p>如果使用 <code>for</code> 的后缀形式，则不需要块，并且为语句列表设置主题。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> „<span class="n">I</span> <span class="nv">$_</span> <span class="n">butterflies</span><span class="o">!</span>“ <span class="k">for</span> <span class="p">&lt;</span><span class="s">♥ ♥ ♥</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT«I ♥ butterflies!</span>
</span></span><span class="line"><span class="cl"><span class="n">I</span> ♥ <span class="n">butterflies</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="n">I</span> ♥ <span class="n">butterflies</span><span class="o">!»</span> 
</span></span></code></pre></div><p><code>for</code> 可以在惰性列表上使用 - 只在需要时从列表中取元素，因此要逐行读取文件，您可以使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">for</span> <span class="vg">$*IN</span><span class="o">.</span><span class="nb">lines</span> <span class="k">-&gt;</span> <span class="nv">$line</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span></code></pre></div><p>迭代变量总是有词法的，因此您无需使用 <code>my</code> 来为它们提供适当的作用域。此外，它们是只读别名。如果您需要它们进行读写，请使用 <code>&lt;-&gt;</code> 而不是 <code>-&gt;</code>。如果需要 <code>$_</code> 在 for 循环中进行读写，请明确执行此操作。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@foo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@foo</span> <span class="o">&lt;-&gt;</span> <span class="nv">$_</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">++</span> <span class="p">}</span>
</span></span></code></pre></div><p>for 循环可以生成每个附加块运行产生的值的 <code>List</code>。要捕获这些值，请将 for 循环放在括号中或将它们赋值给数组：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">(</span><span class="k">for</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">})</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>              <span class="c1"># OUTPUT «(2 4 6)» </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@a</span> <span class="o">=</span> <span class="nb">do</span> <span class="k">for</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">};</span> <span class="nv">@a</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT «[2 4 6]» </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@b</span> <span class="o">=</span> <span class="p">(</span><span class="k">for</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">});</span> <span class="nv">@b</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>  <span class="c1"># OUTPUT: «[2 4 6]» </span>
</span></span></code></pre></div><h1 id="gathertake">gather/take</h1>
<p><code>gather</code> 是一个返回值的<a href="https://docs.raku.org/type/Seq">序列</a>的语句或块前缀。该值来自在 <code>gather</code> 块的动态作用域的<a href="https://docs.raku.org/type/Mu#routine_take">take</a>调用。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@a</span> <span class="o">=</span> <span class="k">gather</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nb">join</span> <span class="p">&#39;</span><span class="s1">, </span><span class="p">&#39;</span><span class="o">,</span> <span class="nv">@a</span><span class="p">;</span>          <span class="c1"># OUTPUT: «1, 5, 42» </span>
</span></span></code></pre></div><p><code>gather/take</code> 可以懒惰地生成值，具体取决于上下文。如果要强制延迟计算 ，请使用<a href="https://docs.raku.org/type/Iterable#method_lazy">lazy</a>子例程或方法。绑定到标量或无符号的容器也会导致懒惰。</p>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@vals</span> <span class="o">=</span> <span class="nb">lazy</span> <span class="k">gather</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Produced a value</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nv">@vals</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#39;</span><span class="s1">between consumption of two values</span><span class="p">&#39;;</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nv">@vals</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1 </span>
</span></span><span class="line"><span class="cl"><span class="c1"># between consumption of two values </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Produced a value </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2 </span>
</span></span></code></pre></div><p><code>gather/take</code> 是动态作用域的，因此您可以从 <code>gather</code> 里面的 subs 或方法内部调用 <code>take</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">weird</span><span class="p">(</span><span class="nv">@elems</span><span class="o">,</span> <span class="o">:</span><span class="nv">$direction</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">forward</span><span class="p">&#39;)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">%direction</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">forward</span>  <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">take</span> <span class="nv">$_</span> <span class="k">for</span> <span class="nv">@elems</span> <span class="p">}</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">backward</span> <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">take</span> <span class="nv">$_</span> <span class="k">for</span> <span class="nv">@elems</span><span class="o">.</span><span class="nb">reverse</span> <span class="p">}</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">random</span>   <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">take</span> <span class="nv">$_</span> <span class="k">for</span> <span class="nv">@elems</span><span class="o">.</span><span class="nb">pick</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="p">}</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">gather</span> <span class="nv">%direction</span><span class="p">{</span><span class="nv">$direction</span><span class="p">}();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nf">weird</span><span class="p">(&lt;</span><span class="s">a b c</span><span class="p">&gt;</span><span class="o">,</span> <span class="p">:</span><span class="s">direction</span><span class="p">&lt;</span><span class="s">backward</span><span class="p">&gt;</span> <span class="p">);</span>          <span class="c1"># OUTPUT: «(c b a)» </span>
</span></span></code></pre></div><p>如果值需要在调用方可变，请使用<a href="https://docs.raku.org/type/Mu#routine_take-rw">take-rw</a>。</p>
<p>请注意，<code>gather/take</code> 也适用于哈希。返回值仍然是一个 <code>Seq</code> 但在以下示例中对散列的赋值使其成为散列。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">%h</span> <span class="o">=</span> <span class="k">gather</span> <span class="p">{</span> <span class="nb">take</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">;</span> <span class="nb">take</span> <span class="p">&#34;</span><span class="s2">bar</span><span class="p">&#34;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nv">%h</span><span class="p">;</span>                                             <span class="c1"># OUTPUT: «{bar =&gt; 2, foo =&gt; 1}» </span>
</span></span></code></pre></div><h1 id="supplyemit">supply/emit</h1>
<p>将调用者发射到闭合的 <a href="https://docs.raku.org/language/concurrency#index-entry-supply_%28on-demand%29">supply</a> 中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$supply</span> <span class="o">=</span> <span class="k">supply</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">emit</span> <span class="nv">$_</span> <span class="k">for</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mf">.5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$supply</span><span class="o">.</span><span class="nb">tap</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">received </span><span class="p">{</span><span class="o">.^</span><span class="nb">name</span><span class="p">}</span><span class="s2"> (</span><span class="nv">$_</span><span class="s2">)</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: </span>
</span></span><span class="line"><span class="cl"><span class="c1"># received Str (foo) </span>
</span></span><span class="line"><span class="cl"><span class="c1"># received Int (42) </span>
</span></span><span class="line"><span class="cl"><span class="c1"># received Rat (0.5) </span>
</span></span></code></pre></div><h1 id="given">given</h1>
<p><code>given</code> 语句是 Raku 中的 topicalizing 关键字, 类似于 C 语言中的 <code>switch</code>。换句话说，<code>given</code> 设置后面跟着的块里面的 <code>$_</code>。单独用例的关键词是 <code>when</code> 和 <code>default</code>。通常的惯用法看起来像这样：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$var</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Any</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="nb">any</span> <span class="p">&lt;</span><span class="s">answer lie</span><span class="p">&gt;)</span><span class="o">.</span><span class="nb">pick</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">given</span> <span class="nv">$var</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">21</span>    <span class="p">{</span> <span class="nb">say</span> <span class="nv">$_</span> <span class="o">*</span> <span class="mi">2</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="p">&#39;</span><span class="s1">lie</span><span class="p">&#39;</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span>          <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>    <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">default</span><span class="p">&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><code>given</code> 语句通常单独使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="o">.</span><span class="kt">Numeric</span><span class="p">;</span> <span class="p">}</span>
</span></span></code></pre></div><p>这比下面的写法更容易理解：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">{</span> <span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="o">.</span><span class="kt">Numeric</span><span class="p">;</span> <span class="p">}(</span><span class="mi">42</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="default-和-when">default 和 when&nbsp;<a class="headline-hash no-text-decoration" href="#default-和-when">#</a> </h2>
<p>当 <code>default</code> 语句后面的 sub-block 离开时, 包含 <code>default</code> 语句的块立马离开。好像跳过了块中的其余语句。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&#34;</span><span class="s2">This says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_</span> <span class="o">==</span> <span class="mi">42</span> <span class="ow">and</span> <span class="p">(</span> <span class="k">default</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">This says, too</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="mi">43</span><span class="p">;</span> <span class="p">}</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">&#34;</span><span class="s2">This never says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The above block evaluates to 43 </span>
</span></span></code></pre></div><p><code>when</code> 语句也将这样做（但 <code>when</code> 语句修饰符将<em>不会</em>。）</p>
<p>此外，<code>when</code> 语句针对提供的表达式和 <code>topic</code>（<code>$_</code>）进行 智能匹配，以便在指定匹配时可以检查值，正则表达式和类型。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">for</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;</span><span class="o">,</span> <span class="mi">44</span><span class="o">,</span> <span class="p">&#34;</span><span class="s2">bar</span><span class="p">&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="o">/</span><span class="p">:</span><span class="s">i</span> <span class="o">^</span><span class="n">Bar</span><span class="o">/</span> <span class="p">{</span> <span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>  <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Not an Int or a Bar</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «42</span>
</span></span><span class="line"><span class="cl"><span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">Not</span> <span class="n">an</span> <span class="kt">Int</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">Bar</span>
</span></span><span class="line"><span class="cl"><span class="mi">44</span>
</span></span><span class="line"><span class="cl"><span class="n">Bar</span><span class="o">»</span> 
</span></span></code></pre></div><p>在这种形式中，<code>given</code>/<code>when</code> 结构的行为很像一组 <code>if</code>/<code>elsif</code>/<code>else</code> 语句。注意 <code>when</code> 语句的顺序。下面的代码打印 <code>&quot;Int&quot;</code> 而不是 <code>42</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Int</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">42</span>  <span class="p">{</span> <span class="nb">say</span> <span class="mi">42</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>  <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">huh?</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Int» </span>
</span></span></code></pre></div><p>当 <code>when</code> 语句或 <code>default</code> 语句导致外部块返回时，嵌套 <code>when</code> 或 <code>default</code> 块不计为外部块，因此只要不打开新块，就可以嵌套这些语句并仍然在同一个“开关”(switch)中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">when</span> <span class="mi">42</span>  <span class="p">{</span> <span class="nb">say</span> <span class="mi">42</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Int</span><span class="p">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>  <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">huh?</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «42» </span>
</span></span></code></pre></div><p><code>when</code> 语句可以智能匹配<a href="https://docs.raku.org/language/syntax#Signature_literals">签名</a>。</p>
<h2 id="proceed">proceed&nbsp;<a class="headline-hash no-text-decoration" href="#proceed">#</a> </h2>
<h2 id="succeed">succeed&nbsp;<a class="headline-hash no-text-decoration" href="#succeed">#</a> </h2>
<p><code>proceed</code> 和 <code>succeed</code> 意在仅用于 <code>when</code> 或 <code>default</code> 块的内部。</p>
<p><code>proceed</code> 语句将立即离开 <code>when</code> 或 <code>default</code> 块, 跳过其余的语句，并在块后重新开始。这可以防止 <code>when</code> 或 <code>default</code> 退出外部块。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="o">*</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">proceed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&#34;</span><span class="s2">This never says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&#34;</span><span class="s2">This says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span></code></pre></div><p>这通常用于进入多个 <code>when</code> 块。<code>proceed</code> 在成功匹配后将恢复匹配，如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span>   <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Int</span><span class="p">&#34;;</span> <span class="k">proceed</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">42</span>    <span class="p">{</span> <span class="nb">say</span> <span class="mi">42</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">40</span><span class="o">..*</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">greater than 40</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>    <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">huh?</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Int» </span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «42» </span>
</span></span></code></pre></div><p>请注意，<code>when 40..*</code> 匹配未发生。为了匹配这样的情况，人们需要在 <code>when 42</code> 块中添加 <code>proceed</code>。</p>
<p>这不像 <code>C</code> 的 <code>switch</code> 语句，因为 <code>proceed</code> 不仅仅是进入直接跟随的块，它还会再次尝试匹配 <code>given</code> 值，请看以下代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">Int</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="k">proceed</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">43</span>  <span class="p">{</span> <span class="mi">43</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">42</span>  <span class="p">{</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>  <span class="p">{</span> <span class="p">&#34;</span><span class="s2">got change for an existential answer?</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Int» </span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «42» </span>
</span></span></code></pre></div><p>&hellip;匹配 <code>Int</code>，跳过 <code>43</code>， 因为值不匹配，匹配 <code>42</code>，因为这是下一个真实的匹配，但不进入 <code>default</code> 块，因为该 <code>when 42</code> 块不包含 <code>proceed</code>。</p>
<p>相反，<code>succeed</code> 关键字短路执行并在此时退出整个 <code>given</code> 块。它也可能需要参数来指定块的最终值。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="kt">Int</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Int</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">        <span class="k">succeed</span> <span class="p">&#34;</span><span class="s2">Found</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">never this!</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="mi">42</span> <span class="p">{</span> <span class="nb">say</span> <span class="mi">42</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">dunno?</span><span class="p">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Int» </span>
</span></span></code></pre></div><p>如果您不在 <code>when</code> 或 <code>default</code> 块中，则尝试使用 <code>proceed</code> 或 <code>succeed</code> 是错误的。还要记住，<code>when</code> 语句修饰符形式不会导致任何块被丢弃，并且这样的语句中的任何 <code>succeed</code> 或 <code>proceed</code> 都应用于周围的子句，如果有的话：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">given</span> <span class="mi">42</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">This says</span><span class="p">&#34;</span> <span class="p">}</span> <span class="k">when</span> <span class="kt">Int</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&#34;</span><span class="s2">This says too</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">when</span> <span class="o">*</span> <span class="o">&gt;</span> <span class="mi">41</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="p">{</span> <span class="p">&#34;</span><span class="s2">And this says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="k">proceed</span> <span class="p">}</span> <span class="k">when</span> <span class="o">*</span> <span class="o">&gt;</span> <span class="mi">41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="p">&#34;</span><span class="s2">This never says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&#34;</span><span class="s2">This also says</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="given-作为语句">given 作为语句&nbsp;<a class="headline-hash no-text-decoration" href="#given-作为语句">#</a> </h2>
<p><code>given</code> 可以跟在语句后面, 以在给它所跟的语句中设置主题(topic)。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="o">.</span><span class="nb">say</span> <span class="k">given</span> <span class="p">&#34;</span><span class="s2">foo</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «foo» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="p">&#34;</span><span class="nv">%s</span><span class="s2"> </span><span class="nv">%02i</span><span class="s2">.</span><span class="nv">%02i</span><span class="s2">.</span><span class="nv">%i</span><span class="p">&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="s">Mo Tu We Th Fr Sa Su</span><span class="p">&gt;</span><span class="o">[.</span><span class="nb">day-of-week</span> <span class="o">-</span> <span class="mi">1</span><span class="o">],</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="nb">day</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="nb">month</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="nb">year</span>
</span></span><span class="line"><span class="cl">    <span class="k">given</span> <span class="kt">DateTime</span><span class="o">.</span><span class="nb">now</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Sa 03.06.2016» </span>
</span></span></code></pre></div><h1 id="loop">loop</h1>
<p><code>loop</code> 语句接收 3 个参数, 分别是初始化, 条件和增量, 它们在元括号中用 <code>;</code> 分隔。初始化执行一次，任何变量声明都将溢出到周围的块中。每次迭代执行一次条件并将其强转为 <code>Bool</code>，如果为 <code>False</code> 则循环停止。每次迭代执行一次增量器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">loop</span> <span class="p">(</span><span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="nv">$i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>无限循环不需要圆括号。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">loop</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">forever</span><span class="p">&#39;</span> <span class="p">}</span>
</span></span></code></pre></div><p><code>loop</code> 如果出现在列表中，则该语句可用于从附加块的每次运行结果中生成值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">(</span><span class="k">loop</span> <span class="p">(</span> <span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;)</span> <span class="p">{</span> <span class="nv">$i</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">})</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>               <span class="c1"># OUTPUT: «(2 4 6)» </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@a</span> <span class="o">=</span> <span class="p">(</span><span class="k">loop</span> <span class="p">(</span> <span class="k">my</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span><span class="o">++</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;)</span> <span class="p">{</span> <span class="nv">$j</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">});</span> <span class="nv">@a</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>   <span class="c1"># OUTPUT: «[2 4 6]» </span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@b</span> <span class="o">=</span> <span class="nb">do</span> <span class="k">loop</span> <span class="p">(</span> <span class="k">my</span> <span class="nv">$k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$k</span><span class="o">++</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;)</span> <span class="p">{</span> <span class="nv">$k</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">};</span> <span class="nv">@b</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span>  <span class="c1"># same thing </span>
</span></span></code></pre></div><p>与 <code>for</code> 循环不同，不应该依赖于返回的值是否是惰性生成的。最好使用 <code>eager</code> 来保证循环的返回值真实运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">heads-in-a-row</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">eager</span> <span class="k">loop</span> <span class="p">(;</span> <span class="mi">2</span><span class="o">.</span><span class="nb">rand</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;)</span> <span class="p">{</span> <span class="p">&#34;</span><span class="s2">heads</span><span class="p">&#34;</span><span class="o">.</span><span class="nb">say</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="while-until">while, until</h1>
<p>只要条件为真，<code>while</code> 语句就会执行该块。所以</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nv">$x</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="p">&#34;</span><span class="se">\n</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «123» </span>
</span></span></code></pre></div><p>类似地，只要表达式为 false ，<code>until</code> 语句就会执行该块。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">until</span> <span class="nv">$x</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="p">&#34;</span><span class="se">\n</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «123» </span>
</span></span></code></pre></div><p><code>while</code> 或 <code>until</code> 的条件可以用括号括起来，但关键字和条件的左括号之间必须有空格。</p>
<p><code>while</code> 和 <code>until</code> 两者可作为语句修饰符。例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x--</span> <span class="k">while</span> <span class="nv">$x</span> <span class="o">&gt;</span> <span class="mi">12</span>
</span></span></code></pre></div><p>另见 <code>repeat/while</code> 和下面的 <code>repeat/until</code>。</p>
<p>所有这些形式都可以以和 <code>loop</code> 相同的方式产生返回值。</p>
<h1 id="repeatwhile-repeatuntil">repeat/while, repeat/until</h1>
<p><em>至少</em>执行<em>一次</em>该块，如果条件允许，则重复执行该块。这与 <code>while</code>/<code>until</code> 的不同之处在于，即使条件出现在前面，也会在循环结束时计算条件。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">while</span> <span class="nv">$x</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «5» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">while</span> <span class="nv">$x</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «6» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="k">while</span> <span class="nv">$x</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «10» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="k">while</span> <span class="nv">$x</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «11» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">until</span> <span class="nv">$x</span> <span class="o">&gt;=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «15» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">until</span> <span class="nv">$x</span> <span class="o">&gt;=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «16» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="k">until</span> <span class="nv">$x</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «20» </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">repeat</span> <span class="k">until</span> <span class="nv">$x</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">.</span><span class="nb">say</span><span class="p">;</span> <span class="c1"># OUTPUT: «21» </span>
</span></span></code></pre></div><p>所有这些形式都可以以和 <code>loop</code> 相同的方式产生返回值。</p>
<h1 id="return">return</h1>
<p>sub <code>return</code> 将停止子程序或方法的执行，运行所有相关的<a href="https://docs.raku.org/language/phasers#Block_phasers">phasers</a>，并提供给定的返回值给调用者。默认返回值是 <code>Nil</code>。如果提供了返回值<a href="https://docs.raku.org/type/Signature#Constraining_return_types">类型约束</a>，则将检查它，除非返回值为 <code>Nil</code>。如果类型检查失败，则抛出异常 <a href="https://docs.raku.org/type/X::TypeCheck::Return">X::TypeCheck::Return</a>。如果它通过了, 则发生控制异常，可以通过 <a href="https://docs.raku.org/language/phasers#CONTROL">CONTROL</a> 捕获。</p>
<p>无论嵌套有多深，块中的任何 <code>return</code> 都与该块外部词法作用域中的第一个 <code>Routine</code> 绑定。请注意，包的根目录中的 <code>return</code> 将在运行时失败。块中被惰性计算（例如在 <code>map</code> 里面）的<code>return</code> 可能发现外部词法例程在块执行时消失了。几乎在任何情况下 <code>last</code> 都是更好的选择。有关如何处理和生成返回值的更多信息，请查看<a href="https://docs.raku.org/language/functions#Return_values">函数文档</a>。</p>
<h1 id="return-rw">return-rw</h1>
<p>sub <code>return</code> 将返回值，而不是容器。这些是不可变的，并且在尝试可变(mutated)时会导致运行时错误。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="k">s</span><span class="p">(){</span> <span class="k">my</span> <span class="nv">$a</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="k">return</span> <span class="nv">$a</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="o">++</span><span class="k">s</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">CATCH</span> <span class="p">{</span> <span class="k">default</span> <span class="p">{</span> <span class="nb">say</span> <span class="o">.^</span><span class="nb">name</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">: </span><span class="p">&#39;</span><span class="o">,</span> <span class="o">.</span><span class="kt">Str</span> <span class="p">}</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «X::Multi::NoMatch.new(dispatcher … </span>
</span></span></code></pre></div><p>要返回可变容器，请使用 <code>return-rw</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="k">s</span><span class="p">(){</span> <span class="k">my</span> <span class="nv">$a</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="k">return-rw</span> <span class="nv">$a</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="o">++</span><span class="k">s</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «42» </span>
</span></span></code></pre></div><p><code>return</code> 适用于关于 phasers 和控制异常的规则。</p>
<h1 id="fail">fail</h1>
<p>在执行所有相关的 <a href="https://docs.raku.org/language/phasers#Block_phasers">phasers</a>之后，离开例程并返回提供的 <a href="https://docs.raku.org/type/Exception">Exception</a> 或包含在 <a href="https://docs.raku.org/type/Failure">Failure</a> 里面的 <code>Str</code> 。如果调用者通过编译指令 <code>use fatal;</code> 激活致命异常，则抛出异常而不是作为 <code>Failure</code> 返回。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nb">f</span> <span class="p">{</span> <span class="nb">fail</span> <span class="p">&#34;</span><span class="s2">WELP!</span><span class="p">&#34;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="nb">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">CATCH</span> <span class="p">{</span> <span class="k">default</span> <span class="p">{</span> <span class="nb">say</span> <span class="o">.^</span><span class="nb">name</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">: </span><span class="p">&#39;</span><span class="o">,</span> <span class="o">.</span><span class="kt">Str</span> <span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «X::AdHoc: WELP!» </span>
</span></span></code></pre></div><h1 id="once">once</h1>
<p>带有前缀 <code>once</code> 的块即使放在循环或递归例程中，也只执行一次。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$guard</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">loop</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">last</span> <span class="k">if</span> <span class="nv">$guard--</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">once</span> <span class="p">{</span> <span class="nb">put</span> <span class="p">&#39;</span><span class="s1">once</span><span class="p">&#39;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="p">&#39;</span><span class="s1">many</span><span class="p">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1"># OUTPUT: «once</span>
</span></span><span class="line"><span class="cl"><span class="n">manymanymany</span><span class="o">»</span> 
</span></span></code></pre></div><p>这适用于包含代码对象的每个“克隆”，因此：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="p">({</span> <span class="n">once</span> <span class="mi">42</span><span class="o">.</span><span class="nb">say</span> <span class="p">}</span> <span class="ow">xx</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="nb">map</span><span class="o">:</span> <span class="p">{</span><span class="nv">$_</span><span class="p">()</span><span class="o">,</span> <span class="nv">$_</span><span class="p">()};</span> <span class="c1"># says 42 thrice </span>
</span></span></code></pre></div><p>请注意，当多个线程运行同一个块儿的同一克隆时，这<strong>不是</strong>线程安全的构造。还要记住，方法每个类只有一个克隆，而不是每个对象。</p>
<h1 id="quietly">quietly</h1>
<p><code>quietly</code> 块将抑制其生成的所有警告。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="n">quietly</span> <span class="p">{</span> <span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">kaput!</span><span class="p">&#39;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">still kaput!</span><span class="p">&#39;;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «still kaput! [...]» </span>
</span></span></code></pre></div><p>从块内调用的任何例程生成的任何警告也将被抑制：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">told-you</span> <span class="p">{</span> <span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">hey...</span><span class="p">&#39;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">quietly</span> <span class="p">{</span> <span class="n">told-you</span><span class="p">;</span> <span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">kaput!</span><span class="p">&#39;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">Only telling you now!</span><span class="p">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «Only telling you now!</span>
</span></span><span class="line"><span class="cl"> <span class="o">[...]</span> <span class="o">»</span> 
</span></span></code></pre></div><h1 id="labelshttpsdocsrakuorglanguagecontrol___top"><a href="https://docs.raku.org/language/control#___top">LABELs</a></h1>
<p><code>while</code>，<code>until</code>，<code>loop</code> 和 <code>for</code> 循环都可以带一个标签，它可以用来标识 <code>next</code>，<code>last</code> 和 <code>redo</code> 。支持嵌套循环，例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nl">OUTAHERE</span><span class="o">:</span> <span class="k">while</span> <span class="kt">True</span>  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span> <span class="k">-&gt;</span> <span class="nv">$n</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">last</span> <span class="n">OUTAHERE</span> <span class="k">if</span> <span class="nv">$n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>标签也可以在嵌套循环中用于命名每个循环，例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nl">OUTAHERE</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="k">loop</span> <span class="p">(</span> <span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kt">True</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nl">OUTFOR</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span> <span class="k">-&gt;</span> <span class="nv">$n</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># exits the for loop before its natural end </span>
</span></span><span class="line"><span class="cl">      <span class="nb">last</span> <span class="n">OUTFOR</span> <span class="k">if</span> <span class="nv">$n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="c1"># exits the infinite loop </span>
</span></span><span class="line"><span class="cl">  <span class="nb">last</span> <span class="n">OUTAHERE</span> <span class="k">if</span> <span class="nv">$i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="next">next</h1>
<p><code>next</code>  命令启动循环的下一次迭代。所以代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@x</span> <span class="k">-&gt;</span> <span class="nv">$x</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">next</span> <span class="k">if</span> <span class="nv">$x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="nv">$x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>打印 “1245”。</p>
<p>如果存在<a href="https://docs.raku.org/language/phasers#NEXT"><code>NEXT</code> phaser</a>，它将在下一次迭代之前运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="kt">Int</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="nv">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$i</span><span class="s2"> is odd.</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="k">NEXT</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «1 is odd.</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span> <span class="k">is</span> <span class="nc">odd</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span> <span class="k">is</span> <span class="nc">odd</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span> <span class="k">is</span> <span class="nc">odd</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span> <span class="k">is</span> <span class="nc">odd</span><span class="o">.»</span> 
</span></span></code></pre></div><p><em>从版本 6.d 开始，对于它们运行的迭代，循环中收集其最后一个语句值的 <code>next</code> 命令将返回 <code>Empty</code></em></p>
<h1 id="last">last</h1>
<p><code>last</code> 命令立即退出当前循环。</p>
<pre tabindex="0"><code>my @x = 1, 2, 3, 4, 5;
for @x -&gt; $x {
    last if $x == 3;
    print $x;
}
</code></pre><p>打印 “12”。</p>
<p>如果存在<a href="https://docs.raku.org/language/phasers#LAST"><code>LAST</code> phaser</a>，则在退出循环之前运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="kt">Int</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="nv">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">last</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="k">LAST</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">The last number was </span><span class="nv">$i</span><span class="s2">.</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">NEXT</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: «The last number was 5.» </span>
</span></span></code></pre></div><p><em>从版本 6.d 开始，对于它们运行的迭代，循环中收集其最后一个语句值的 <code>last</code> 命令将返回 <code>Empty</code></em></p>
<h1 id="redo">redo</h1>
<p><code>redo</code> 命令重新启动循环块，而不再计算条件。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">loop</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="nb">prompt</span><span class="p">(&#34;</span><span class="s2">Enter a number</span><span class="p">&#34;);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">redo</span> <span class="k">unless</span> <span class="nv">$x</span> <span class="o">~~</span> <span class="p">/</span><span class="se">\d</span><span class="o">+</span><span class="p">/;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">last</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>

        </div>
    </div>
</article>



                <footer>
                    




<div class="no-text-decoration">
    <div class="jump top"><a href="#" title="Top of this page">⮉</a></div>
    <div class="jump bottom"><a href="#bottom" title="Bottom of this page">⮋</a></div>
</div>


 
    
        <div class="hugotoc no-text-decoration">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#elseelsif">else/elsif</a></li>
    <li><a href="#unless">unless</a></li>
    <li><a href="#with-orwith-withouthttpsdocsrakuorglanguagecontrol___top"><a href="https://docs.raku.org/language/control#___top"><code>with</code>, <code>orwith</code>, <code>without</code></a></a></li>
  </ul>

  <ul>
    <li><a href="#default-和-when">default 和 when</a></li>
    <li><a href="#proceed">proceed</a></li>
    <li><a href="#succeed">succeed</a></li>
    <li><a href="#given-作为语句">given 作为语句</a></li>
  </ul>
</nav>
            <a href="#" class="back-to-top">Back to top</a>
        </div>
    
    
<script src="/js/libs/jquery/3.3.1/jquery.slim.min.min.22ee3db0c0e99fd0fbce3aee19672bd53d25469daf734bd4c165649f6eaf7d7f.js"></script>

<link rel="preload" href="/js/libs/jquery/3.3.1/jquery.slim.min.min.22ee3db0c0e99fd0fbce3aee19672bd53d25469daf734bd4c165649f6eaf7d7f.js" as="script">

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6, .h-feed h2');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>








<div class="backtotop center no-text-decoration">
    <a href="#">back to <span class="top">top</span></a>
</div>


<div class="right">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="http://localhost:1313/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="http://localhost:1313/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>
<div class="clear-float"></div>



<div class="prev-next-navigator clear-float">
    
        <span class="prev-post left no-text-decoration">
            <a href="http://localhost:1313/rakulang/40.data-structures/" class="nobr">« 数据流</a>
        </span>
    
    
        <span class="next-post right no-text-decoration">
            <a href="http://localhost:1313/rakulang/38.contexts-and-contextualizers/" class="nobr">上下文和上下文器 »</a>
        </span>
    
</div>


<a id="bottom"></a>









                       







                    <ul class="no-bullets feed right inline">
    
        
        
    
</ul>
<div class="clear-float"></div>

                </footer>
                <hr />
            </div>               

            <footer> 
                

<ul class="social no-text-decoration">
    
</ul>










 
    
    



<p class="generated no-text-decoration">
    Generated using  <a href="https://gitlab.com/kaushalmodi/hugo-theme-refined"><code class="nobr">hugo-theme-refined</code></a> + <span class="nobr">Hugo <a href="https://github.com/gohugoio/hugo/commit/312735366b20d64bd61bff8627f593749f86c964">0.123.7</a></span>
</p>

<p>
    
</p>




<div class="badges no-text-decoration">
    
    

    
</div>




<script type="application/javascript">var nav=responsiveNav("#nav");</script>




<script defer src="/js/libs/fragmentions/wrapper.min.e8c468c89edc4f5dccaa8c720c6b220b3088a16cd7b1e4a1e3345985788260c9.js"></script>









            </footer>
        </div> 
    </body>
</html>
