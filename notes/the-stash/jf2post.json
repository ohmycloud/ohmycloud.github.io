{"author":{"name":null,"type":"card","url":"https://ohmycloud.github.io/"},"content":{"html":"\u003cp\u003e\u003cimg src=\"https://mojolicious.io/blog/2017/12/02/day-2-the-stash/bag-1854148_1920.jpg\" alt=\"img\"\u003e\u003c/p\u003e\n\u003cp\u003e在 Mojolicious 中，当处理请求并准备响应时，最重要的概念之一是“藏匿”。由于它是一个非阻塞框架，因此您的代码在处理期间不能使用全局变量来存储任何状态。如果您运行了一些其他代码，那么很容易在请求之间进行串扰。\u003c/p\u003e\n\u003cp\u003e存储是您在处理信息时可以存储信息的地方。它只是一个简单的哈希引用，它附加到处理请求的控制器对象上。它与这一笔交易一起生存和死亡。\u003c/p\u003e\n\u003cp\u003e虽然你可以而且应该将它用作暂存器，但实际上还是要多得多。存储控制几乎控制了您生成的响应的每个方面。让我们仔细看看它是如何工作的\u003c/p\u003e\n\u003ch2 id=\"使用-stash-渲染文本\"\u003e使用 Stash 渲染文本\u003c/h2\u003e\n\u003cp\u003e在上一篇文章中，我们讨论了最简单的“Hello world”应用程序。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Hello 🌍 World!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e虽然这是一个非常简单的工作案例，但更常见的例子就是这样\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Hello 🌍 World!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在此示例中，GET /请求由“动作回调”处理。回调是函数引用，打算将来调用;在这种情况下，当客户端请求进入与该类型的请求匹配时，将调用回调。\u003c/p\u003e\n\u003cp\u003e使用一个参数调用操作，称为\u003ca href=\"http://mojolicious.org/perldoc/Mojolicious/Controller\"\u003e控制器\u003c/a\u003e。控制器是一个对象，表示我们的应用程序与当前事务的交互。它包含一个表示\u003ca href=\"http://mojolicious.org/perldoc/Mojo/Transaction\"\u003e事务\u003c/a\u003e的对象，该对象又保存\u003ca href=\"http://mojolicious.org/perldoc/Mojo/Message/Request\"\u003e请求\u003c/a\u003e和\u003ca href=\"http://mojolicious.org/perldoc/Mojo/Message/Response\"\u003e响应\u003c/a\u003e的对象。它有一些方法可用于生成响应，其中一个是渲染，您可以在上面看到。在这里，您会看到我们将呈现一些文本。\u003c/p\u003e\n\u003cp\u003e事实上，渲染的大多数参数实际上只是合并到了藏匿处。实际上，上面的例子是相同的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Hello 🌍 World!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e你现在看到的是，Mojolicious 看着藏匿处看看如何呈现回应。事实上，如果你不调用 render，但它有足够的信息来在 stash 中呈现响应，它就会这样做。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Hello 🌍 World!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"stash-defaults\"\u003eStash Defaults\u003c/h2\u003e\n\u003cp\u003e在上面的示例中，我们了解了如何在控制响应的请求期间设置存储值。请记住，只有在请求进入时才会调用动作回调。但是，我们需要等待理解如何响应它的请求没有什么特别之处。\u003c/p\u003e\n\u003cp\u003e在 Mojolicious 中，在建立路由时，我们还可以指定一些默认值以添加到每个请求的存储中（除非它们被更改）。这些默认值作为路径构造函数 \u003ccode\u003eget\u003c/code\u003e 的哈希引用传递。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Hello 🌍 World!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是现在我们的行动没有做任何事情，所以我们根本不需要它，我们回到原来的例子。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;hello 🌍 world!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"使用占位符\"\u003e使用占位符\u003c/h2\u003e\n\u003cp\u003e我们可以进一步展示这个例子，并展示如何制作一个更有趣的问候语应用程序，这一次是一个名字。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/:name\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello $name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在这里，我们看到占位符值被合并到存储中。然后，我们可以使用它们来呈现更个性化的响应。如果您在浏览器中启动服务器并请求/ Joel，您应该会看到一个问候我的应用程序，或者您可以使用您的名字进行操作。\u003c/p\u003e\n\u003cp\u003e如果您尝试请求/但是，您将获得404，未找到。如果没有占位符的值，路由器不希望处理此请求，因此它假定您需要一些其他路由来处理它。虽然我们可以像之前那样为/定义另一个，但我们可以通过恢复默认值来同时执行这两个操作。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/:name\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;🌍 world!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;hello $name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e现在路由器知道名称的默认值应该是什么，它现在可以处理/以及/ santa！\u003c/p\u003e\n\u003ch2 id=\"在模板中隐藏值\"\u003e在模板中隐藏值\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"http://mojolicious.org/perldoc/Mojolicious/Guides/Rendering#Embedded-Perl\"\u003e模板\u003c/a\u003e中也提供了简单的隐藏值，即只有一个单词（没有标点符号）的隐藏值。以下是使用“内联模板”的上一个示例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/:name\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;🌍 world!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;hello \u0026lt;%= $name %\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e或者如果你让我使用一个概念而不完全介绍它，这里是你脚本数据部分的模板。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/:name\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;🌍 world!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;hello\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"bp\"\u003e__DATA__\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e@@\u003c/span\u003e \u003cspan class=\"nv\"\u003ehello\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehtml\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eep\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ehello\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nv\"\u003e%\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u003c/span\u003e \u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"nv\"\u003ename\u003c/span\u003e \u003cspan class=\"nv\"\u003e%\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在后者中，您将看到仅使用一个参数调用render的第一个示例。当使用奇数个参数调用它时，第一个是模板的标识符（名称）。这与stashing template =\u0026gt;\u0026lsquo;hello\u0026rsquo;相同，您甚至可以在路由默认值中执行此操作。\u003c/p\u003e\n\u003ch2 id=\"特殊保留的隐藏键\"\u003e特殊/保留的隐藏键\u003c/h2\u003e\n\u003cp\u003e所以可能有一些人问“所以文本藏匿值控制渲染的一部分，名称藏匿值是否可以做任何事情？”不，只有少数隐藏值具有特殊含义，它们记录在\u003ca href=\"http://mojolicious.org/perldoc/Mojolicious/Controller#stash\"\u003estash方法\u003c/a\u003e本身上。那些键是\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eaction\u003c/li\u003e\n\u003cli\u003eapp\u003c/li\u003e\n\u003cli\u003ecb\u003c/li\u003e\n\u003cli\u003econtroller\u003c/li\u003e\n\u003cli\u003edata\u003c/li\u003e\n\u003cli\u003eextends\u003c/li\u003e\n\u003cli\u003eformat\u003c/li\u003e\n\u003cli\u003ehandler\u003c/li\u003e\n\u003cli\u003einline\u003c/li\u003e\n\u003cli\u003ejson\u003c/li\u003e\n\u003cli\u003elayout\u003c/li\u003e\n\u003cli\u003enamespace\u003c/li\u003e\n\u003cli\u003epath\u003c/li\u003e\n\u003cli\u003estatus\u003c/li\u003e\n\u003cli\u003etemplate\u003c/li\u003e\n\u003cli\u003etext\u003c/li\u003e\n\u003cli\u003evariant\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e此外，所有键如 \u003ccode\u003emojo.*\u003c/code\u003e 都保留供内部使用。这些值中的大多数在路由，模板或渲染中都很有用。\u003c/p\u003e\n\u003cp\u003e您已经看过 \u003ccode\u003etext\u003c/code\u003e，它通过 utf8 编码来呈现字符串。要以二进制格式（或仅使用 utf8 编码的文本）呈现数据，请使用 \u003ccode\u003edata\u003c/code\u003e 键。这两个以及模板都将使用content-type \u003ccode\u003etext/html\u003c/code\u003e 进行渲染。要使用不同的东西，可以使用 \u003ccode\u003eformat\u003c/code\u003e 键指定它。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;hello 🌍 world!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003eformat\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;txt\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"http://mojolicious.org/perldoc/Mojolicious/Types#DESCRIPTION\"\u003e这里\u003c/a\u003e列出了理解的格式（可以\u003ca href=\"http://mojolicious.org/perldoc/Mojolicious/Types#DESCRIPTION\"\u003e添加更多\u003c/a\u003e）。\u003c/p\u003e\n\u003cp\u003e其他人都有意义，其中一些你可以自己解决，但这篇文章已经持续了很长时间。那些人将不得不等待另一天。\u003c/p\u003e\n","text":"\n在 Mojolicious 中，当处理请求并准备响应时，最重要的概念之一是“藏匿”。由于它是一个非阻塞框架，因此您的代码在处理期间不能使用全局变量来存储任何状态。如果您运行了一些其他代码，那么很容易在请求之间进行串扰。\n存储是您在处理信息时可以存储信息的地方。它只是一个简单的哈希引用，它附加到处理请求的控制器对象上。它与这一笔交易一起生存和死亡。\n虽然你可以而且应该将它用作暂存器，但实际上还是要多得多。存储控制几乎控制了您生成的响应的每个方面。让我们仔细看看它是如何工作的\n使用 Stash 渲染文本 在上一篇文章中，我们讨论了最简单的“Hello world”应用程序。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; {text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;}; app-\u0026gt;start; 虽然这是一个非常简单的工作案例，但更常见的例子就是这样\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;render(text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;); }; app-\u0026gt;start; 在此示例中，GET /请求由“动作回调”处理。回调是函数引用，打算将来调用;在这种情况下，当客户端请求进入与该类型的请求匹配时，将调用回调。\n使用一个参数调用操作，称为控制器。控制器是一个对象，表示我们的应用程序与当前事务的交互。它包含一个表示事务的对象，该对象又保存请求和响应的对象。它有一些方法可用于生成响应，其中一个是渲染，您可以在上面看到。在这里，您会看到我们将呈现一些文本。\n事实上，渲染的大多数参数实际上只是合并到了藏匿处。实际上，上面的例子是相同的\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;stash(text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;); $c-\u0026gt;render; }; app-\u0026gt;start; 你现在看到的是，Mojolicious 看着藏匿处看看如何呈现回应。事实上，如果你不调用 render，但它有足够的信息来在 stash 中呈现响应，它就会这样做。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;stash(text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;); }; app-\u0026gt;start; Stash Defaults 在上面的示例中，我们了解了如何在控制响应的请求期间设置存储值。请记住，只有在请求进入时才会调用动作回调。但是，我们需要等待理解如何响应它的请求没有什么特别之处。\n在 Mojolicious 中，在建立路由时，我们还可以指定一些默认值以添加到每个请求的存储中（除非它们被更改）。这些默认值作为路径构造函数 get 的哈希引用传递。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; {text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;} =\u0026gt; sub { my $c = shift; }; app-\u0026gt;start; 但是现在我们的行动没有做任何事情，所以我们根本不需要它，我们回到原来的例子。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; {text =\u0026gt; \u0026#39;hello 🌍 world!\u0026#39;}; app-\u0026gt;start; 使用占位符 我们可以进一步展示这个例子，并展示如何制作一个更有趣的问候语应用程序，这一次是一个名字。\nuse Mojolicious::Lite; get \u0026#39;/:name\u0026#39; =\u0026gt; sub { my $c = shift; my $name = $c-\u0026gt;stash(\u0026#39;name\u0026#39;); $c-\u0026gt;stash(text =\u0026gt; \u0026#34;Hello $name\u0026#34;); }; app-\u0026gt;start; 在这里，我们看到占位符值被合并到存储中。然后，我们可以使用它们来呈现更个性化的响应。如果您在浏览器中启动服务器并请求/ Joel，您应该会看到一个问候我的应用程序，或者您可以使用您的名字进行操作。\n如果您尝试请求/但是，您将获得404，未找到。如果没有占位符的值，路由器不希望处理此请求，因此它假定您需要一些其他路由来处理它。虽然我们可以像之前那样为/定义另一个，但我们可以通过恢复默认值来同时执行这两个操作。\nuse Mojolicious::Lite; get \u0026#39;/:name\u0026#39; =\u0026gt; {name =\u0026gt; \u0026#39;🌍 world!\u0026#39;} =\u0026gt; sub { my $c = shift; my $name = $c-\u0026gt;stash(\u0026#39;name\u0026#39;); $c-\u0026gt;stash(text =\u0026gt; \u0026#34;hello $name\u0026#34;); }; app-\u0026gt;start; 现在路由器知道名称的默认值应该是什么，它现在可以处理/以及/ santa！\n在模板中隐藏值 模板中也提供了简单的隐藏值，即只有一个单词（没有标点符号）的隐藏值。以下是使用“内联模板”的上一个示例。\nuse Mojolicious::Lite; get \u0026#39;/:name\u0026#39; =\u0026gt; {name =\u0026gt; \u0026#39;🌍 world!\u0026#39;} =\u0026gt; sub { my $c = shift; $c-\u0026gt;stash(inline =\u0026gt; \u0026#39;hello \u0026lt;%= $name %\u0026gt;\u0026#39;); }; app-\u0026gt;start; 或者如果你让我使用一个概念而不完全介绍它，这里是你脚本数据部分的模板。\nuse Mojolicious::Lite; get \u0026#39;/:name\u0026#39; =\u0026gt; {name =\u0026gt; \u0026#39;🌍 world!\u0026#39;} =\u0026gt; sub { my $c = shift; $c-\u0026gt;render(\u0026#39;hello\u0026#39;); }; app-\u0026gt;start; __DATA__ @@ hello.html.ep hello \u0026lt;%= $name %\u0026gt; 在后者中，您将看到仅使用一个参数调用render的第一个示例。当使用奇数个参数调用它时，第一个是模板的标识符（名称）。这与stashing template =\u0026gt;\u0026lsquo;hello\u0026rsquo;相同，您甚至可以在路由默认值中执行此操作。\n特殊/保留的隐藏键 所以可能有一些人问“所以文本藏匿值控制渲染的一部分，名称藏匿值是否可以做任何事情？”不，只有少数隐藏值具有特殊含义，它们记录在stash方法本身上。那些键是\naction app cb controller data extends format handler inline json layout namespace path status template text variant 此外，所有键如 mojo.* 都保留供内部使用。这些值中的大多数在路由，模板或渲染中都很有用。\n您已经看过 text，它通过 utf8 编码来呈现字符串。要以二进制格式（或仅使用 utf8 编码的文本）呈现数据，请使用 data 键。这两个以及模板都将使用content-type text/html 进行渲染。要使用不同的东西，可以使用 format 键指定它。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; {text =\u0026gt; \u0026#39;hello 🌍 world!\u0026#39;, format =\u0026gt; \u0026#39;txt\u0026#39;}; app-\u0026gt;start; 这里列出了理解的格式（可以添加更多）。\n其他人都有意义，其中一些你可以自己解决，但这篇文章已经持续了很长时间。那些人将不得不等待另一天。\n"},"name":"第二天 - The Stash","published":"2017-12-02T18:21:30Z","summary":"在 Mojolicious 中，当处理请求并准备响应时，最重要的概念之一是“藏匿”。由于它是一个非阻塞框架，因此您的代码在处理期间不能使用全局变量来存储任何状态。如果您运行了一些其他代码，那么很容易在请求之间进行串扰。\n存储是您在处理信息时可以存储信息的地方。它只是一个简单的哈希引用，它附加到处理请求的控制器对象上。它与这一笔交易一起生存和死亡。\n虽然你可以而且应该将它用作暂存器，但实际上还是要多得多。存储控制几乎控制了您生成的响应的每个方面。让我们仔细看看它是如何工作的\n使用 Stash 渲染文本 在上一篇文章中，我们讨论了最简单的“Hello world”应用程序。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; {text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;}; app-\u0026gt;start; 虽然这是一个非常简单的工作案例，但更常见的例子就是这样\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;render(text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;); }; app-\u0026gt;start; 在此示例中，GET /请求由“动作回调”处理。回调是函数引用，打算将来调用;在这种情况下，当客户端请求进入与该类型的请求匹配时，将调用回调。\n使用一个参数调用操作，称为控制器。控制器是一个对象，表示我们的应用程序与当前事务的交互。它包含一个表示事务的对象，该对象又保存请求和响应的对象。它有一些方法可用于生成响应，其中一个是渲染，您可以在上面看到。在这里，您会看到我们将呈现一些文本。\n事实上，渲染的大多数参数实际上只是合并到了藏匿处。实际上，上面的例子是相同的\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;stash(text =\u0026gt; \u0026#39;Hello 🌍 World!\u0026#39;); $c-\u0026gt;render; }; app-\u0026gt;start; 你现在看到的是，Mojolicious 看着藏匿处看看如何呈现回应。事实上，如果你不调用 render，但它有足够的信息来在 stash 中呈现响应，它就会这样做。\nuse Mojolicious::Lite; get \u0026#39;/\u0026#39; =\u0026gt; sub { my $c = shift; $c-\u0026gt;stash(text =\u0026gt; \u0026#39;Hello 🌍 World!","type":"entry","url":"https://ohmycloud.github.io/notes/the-stash/"}