{"author":{"name":null,"type":"card","url":"https://ohmycloud.github.io/"},"content":{"html":"\u003cp\u003e现在我有一个 \u003ca href=\"https://mojolicious.org/perldoc/Minion\"\u003eMinion 工作队列\u003c/a\u003e，我需要妥善处理它。工人是否在工作（他们是否抓住了生产资料）？工作是否顺利完成？有什么错误吗？这些是什么？\u003c/p\u003e\n\u003ch2 id=\"minion-jobs-command\"\u003eMinion Jobs Command\u003c/h2\u003e\n\u003cp\u003eMinion 带有一个 \u003ca href=\"https://mojolicious.org/perldoc/Minion/Command/minion/job\"\u003e\u003ccode\u003ejob\u003c/code\u003e\u003c/a\u003e 命令，列出了作业及其状态。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ perl myapp.pl minion job\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e  inactive  default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e  active    default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e  failed    default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e  failed    default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e  finished  default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e  finished  default  check_url\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e我可以通过传递工作的ID来查看单个工作的信息。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ perl minion.pl minion job \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;args\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;http://mojolicious.org\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;attempts\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; 1,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;children\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"o\"\u003e[]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;created\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;2018-11-23T19:15:47Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;delayed\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;2018-11-23T19:15:47Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;finished\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;2018-11-23T19:15:48Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; 1,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;notes\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"o\"\u003e{}\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;parents\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"o\"\u003e[]\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;priority\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; 0,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;queue\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;result\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;0.0716841220855713\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;retried\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; undef,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;retries\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; 0,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;started\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;2018-11-23T19:15:47Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;state\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;finished\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;task\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"s2\"\u003e\u0026#34;check_url\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s2\"\u003e\u0026#34;worker\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是，如果我不必打开终端，打开SSH连接，并运行命令来查看我的Minion的状态，那就更好了。\u003c/p\u003e\n\u003ch2 id=\"minion-admin-ui\"\u003eMinion Admin UI\u003c/h2\u003e\n\u003cp\u003e我说我没有网络应用程序，但我没有。但是，如果我想要一个简单的Web应用程序来检查 Minion worker 的状态并阅读作业结果，那么 Minion 会附带一个 \u003ca href=\"https://mojolicious.org/perldoc/Mojolicious/Plugin/Minion/Admin\"\u003eAdmin UI 插件\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e我可以像添加 Minion 插件一样添加 \u003ca href=\"https://mojolicious.org/perldoc/Mojolicious/Plugin/Minion/Admin\"\u003eMinion::Admin 插件\u003c/a\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nn\"\u003eMojolicious::Lite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eplugin\u003c/span\u003e \u003cspan class=\"n\"\u003eMinion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eSQLite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;sqlite:\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nn\"\u003ehome\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003echild\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;minion.db\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eplugin\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Minion::Admin\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Host Admin UI at /\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eroute\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nn\"\u003eroutes\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eany\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nn\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e一旦我添加插件，我现在有一个Web应用程序，我可以使用 \u003ca href=\"https://mojolicious.org/perldoc/Mojolicious/Command/daemon\"\u003eMojolicious daemon\u003c/a\u003e 命令运行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ perl myapp.pl daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServer available at http://127.0.0.1:3000\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e现在我可以访问 Minion UI：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://mojolicious.io/blog/2018/12/11/who-watches-the-minions/01-main.png\" alt=\"img\"\u003e\u003c/p\u003e\n\u003cp\u003e主页面显示当前状态。顶部的链接显示给定状态下的作业列表，存在的任何锁定以及工作者。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://mojolicious.io/blog/2018/12/11/who-watches-the-minions/02-job-list.png\" alt=\"img\"\u003e\u003c/p\u003e\n\u003cp\u003e查看作业列表时，我可以单击左上角的按钮来管理作业队列，或单击每个作业行右侧的插入符号以查看该作业的详细信息（与作业命令显示的相同） 。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://mojolicious.io/blog/2018/12/11/who-watches-the-minions/03-job-details.png\" alt=\"img\"\u003e\u003c/p\u003e\n\u003cp\u003eMinion Admin UI 是一款出色的工具！查看 Minion 应用程序的完整\u003ca href=\"https://mojolicious.io/blog/2018/12/11/who-watches-the-minions/minion.pl\"\u003e源代码\u003c/a\u003e。\u003c/p\u003e\n","text":"现在我有一个 Minion 工作队列，我需要妥善处理它。工人是否在工作（他们是否抓住了生产资料）？工作是否顺利完成？有什么错误吗？这些是什么？\nMinion Jobs Command Minion 带有一个 job 命令，列出了作业及其状态。\n$ perl myapp.pl minion job 6 inactive default check_url 5 active default check_url 4 failed default check_url 3 failed default check_url 2 finished default check_url 1 finished default check_url 我可以通过传递工作的ID来查看单个工作的信息。\n$ perl minion.pl minion job 1 { \u0026#34;args\u0026#34; =\u0026gt; [ \u0026#34;http://mojolicious.org\u0026#34; ], \u0026#34;attempts\u0026#34; =\u0026gt; 1, \u0026#34;children\u0026#34; =\u0026gt; [], \u0026#34;created\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:47Z\u0026#34;, \u0026#34;delayed\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:47Z\u0026#34;, \u0026#34;finished\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:48Z\u0026#34;, \u0026#34;id\u0026#34; =\u0026gt; 1, \u0026#34;notes\u0026#34; =\u0026gt; {}, \u0026#34;parents\u0026#34; =\u0026gt; [], \u0026#34;priority\u0026#34; =\u0026gt; 0, \u0026#34;queue\u0026#34; =\u0026gt; \u0026#34;default\u0026#34;, \u0026#34;result\u0026#34; =\u0026gt; \u0026#34;0.0716841220855713\u0026#34;, \u0026#34;retried\u0026#34; =\u0026gt; undef, \u0026#34;retries\u0026#34; =\u0026gt; 0, \u0026#34;started\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:47Z\u0026#34;, \u0026#34;state\u0026#34; =\u0026gt; \u0026#34;finished\u0026#34;, \u0026#34;task\u0026#34; =\u0026gt; \u0026#34;check_url\u0026#34;, \u0026#34;worker\u0026#34; =\u0026gt; 1 } 但是，如果我不必打开终端，打开SSH连接，并运行命令来查看我的Minion的状态，那就更好了。\nMinion Admin UI 我说我没有网络应用程序，但我没有。但是，如果我想要一个简单的Web应用程序来检查 Minion worker 的状态并阅读作业结果，那么 Minion 会附带一个 Admin UI 插件。\n我可以像添加 Minion 插件一样添加 Minion::Admin 插件：\nuse Mojolicious::Lite; plugin Minion =\u0026gt; { SQLite =\u0026gt; \u0026#39;sqlite:\u0026#39; . app-\u0026gt;home-\u0026gt;child(\u0026#39;minion.db\u0026#39;), }; plugin \u0026#39;Minion::Admin\u0026#39;, { # Host Admin UI at / route =\u0026gt; app-\u0026gt;routes-\u0026gt;any(\u0026#39;/\u0026#39;), }; app-\u0026gt;start; 一旦我添加插件，我现在有一个Web应用程序，我可以使用 Mojolicious daemon 命令运行\n$ perl myapp.pl daemon Server available at http://127.0.0.1:3000 现在我可以访问 Minion UI：\n主页面显示当前状态。顶部的链接显示给定状态下的作业列表，存在的任何锁定以及工作者。\n查看作业列表时，我可以单击左上角的按钮来管理作业队列，或单击每个作业行右侧的插入符号以查看该作业的详细信息（与作业命令显示的相同） 。\nMinion Admin UI 是一款出色的工具！查看 Minion 应用程序的完整源代码。\n"},"name":"第十一天 - 谁在看着 Minions","published":"2018-12-11T23:02:01Z","summary":"现在我有一个 Minion 工作队列，我需要妥善处理它。工人是否在工作（他们是否抓住了生产资料）？工作是否顺利完成？有什么错误吗？这些是什么？\nMinion Jobs Command Minion 带有一个 job 命令，列出了作业及其状态。\n$ perl myapp.pl minion job 6 inactive default check_url 5 active default check_url 4 failed default check_url 3 failed default check_url 2 finished default check_url 1 finished default check_url 我可以通过传递工作的ID来查看单个工作的信息。\n$ perl minion.pl minion job 1 { \u0026#34;args\u0026#34; =\u0026gt; [ \u0026#34;http://mojolicious.org\u0026#34; ], \u0026#34;attempts\u0026#34; =\u0026gt; 1, \u0026#34;children\u0026#34; =\u0026gt; [], \u0026#34;created\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:47Z\u0026#34;, \u0026#34;delayed\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:47Z\u0026#34;, \u0026#34;finished\u0026#34; =\u0026gt; \u0026#34;2018-11-23T19:15:48Z\u0026#34;, \u0026#34;id\u0026#34; =\u0026gt; 1, \u0026#34;notes\u0026#34; =\u0026gt; {}, \u0026#34;parents\u0026#34; =\u0026gt; [], \u0026#34;priority\u0026#34; =\u0026gt; 0, \u0026#34;queue\u0026#34; =\u0026gt; \u0026#34;default\u0026#34;, \u0026#34;result\u0026#34; =\u0026gt; \u0026#34;0.","type":"entry","url":"https://ohmycloud.github.io/notes/who-watches-the-minions/"}