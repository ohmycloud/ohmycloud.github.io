<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">

    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    
    
    

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

    
    <meta name="referrer" content="no-referrer">

    <title>
        
            Using Raku ❚ 焉知非鱼
        
    </title>

    
    


    
    
    
    

    
    
    
    

    
    
    

    
    
    
    <style>
     
     
     :root {
         --theme-color: #ac4142;
         --theme-color-light: rgba(172, 65, 66, 0.2);
     }
     
     html {
         line-height: 1.5;
     }
    </style>

    
    

    
    
    
    
    <link rel="stylesheet" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css">
    
    <link rel="preload" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css" as="style">

    



    
        <style>
         
         /* Background */ .chroma { background-color: #ffffff }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
/* LineHighlight */ .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* LineNumbers */ .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

         
         /* Overrides on top of the theme and Chroma CSS */
/* Chroma-based lines highlighting in code blocks */
.chroma .hl {
    background-color: #e8e8e8;
    /* Extend highlight up to 100 characters (assuming that the code blocks never have more than 100 characters in a line) */
    min-width: 100ch;
}
/* GenericHeading */ .chroma .gh { color: #999999; font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa; font-weight: bold }

         
        </style>
    

    

    
    
    

    
    <script src="/js/responsive-nav-orig.min.bd7287557074084b7eba924cf5291f3c285cf8e8324c500f4389ff9fb1a92169.js"></script>
    
    <link rel="preload" href="/js/responsive-nav-orig.min.bd7287557074084b7eba924cf5291f3c285cf8e8324c500f4389ff9fb1a92169.js" as="script">

    
    
    <script defer src="/js/libs/fa/fontawesome-all.min.3ca622508ac5fb18aee4bc98a61b16f99348c918b1c684528246d1a95d82fd34.js"></script>
    
    <link rel="preload" href="/js/libs/fa/fontawesome-all.min.3ca622508ac5fb18aee4bc98a61b16f99348c918b1c684528246d1a95d82fd34.js" as="script">

    

    

    
    
    

    
    
<!-- rel="me" links for IndieAuth -->







    
 
<meta property="og:title" content="Using Raku" />
<meta property="og:description"
      content="Using Raku" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohmyweekly.github.io/notes/2015-03-14-using-raku/" />


    
        <meta property="article:published_time" content="2021-07-07T00:00:00&#43;08:00"/>
    
    
        <meta property="article:modified_time" content="2021-07-07T00:00:00&#43;08:00"/>
    









    




     <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Raku"/>
<meta name="twitter:description" content="Using Raku"/>


    
    
    <link rel="alternate" type="application/jf2post+json" href="https://ohmyweekly.github.io/notes/2015-03-14-using-raku/jf2post.json" title="Jf2post for 焉知非鱼" />
    
     



    
    
    
        
    


     
        
        <meta name="DC.Creator" content="焉知非鱼"/>
    



    
    
    
    <meta name="hugo-build-date" content="2021-07-05T10:46:28Z"/>
    <meta name="hugo-commit-hash" content="724d5db5"/>
    <meta name="generator" content="Hugo 0.85.0" />
</head>


    
        <body lang="en">
    

        
        <div class="border" id="home"></div>

        <div class="wrapper">   
            
<nav id="nav" class="nav-collapse opened" aria-hidden="false">
    <ul class="navbar">
        <li><a class="" href="/">Home</a></li>
        
            
                <li><a class="" href="https://ohmyweekly.github.io/posts/">Posts</a></li>
            
        
            
                <li><a class="" href="https://ohmyweekly.github.io/notes/">Notes</a></li>
            
        
        
            <li><a class="" href="https://ohmyweekly.github.io/search/">Search</a></li>
        
    </ul>
</nav>

            <div class="container">
                <header class="masthead">
                    <div class="masthead-title no-text-decoration">
                        <a href="/">焉知非鱼</a> <span class="blinking-cursor">❚</span>
                    </div>
                    <div class="masthead-tagline">
                        rakulang, dartlang, nimlang, golang, rustlang, lang lang no see
                    </div>
                </header>

                








<article class="post h-entry notes">
    <header>
        <div class="center">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 81 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 13 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>

        <h1 class="post-title p-name">Using Raku</h1>

        
        <data class="u-url" value="https://ohmyweekly.github.io/notes/2015-03-14-using-raku/"></data>

        <div class="date-syndication">
            


    
    
    <div class="post-date">
        
        <time datetime="2021-07-07T00:00:00+0800" class="dt-published">Wed Jul 7, 2021</time>
        
        
    </div>


            




        </div>
         



    
    
    
        
    


    
        
        <span class="hide">
            &mdash; <a href="https://ohmyweekly.github.io" class="u-author">焉知非鱼</a>
        </span>
    


    </header>

    <div class="content">
        
    <div class="description p-summary">
        
        
        
        
        
            
            
        
        <p>Using Raku</p>
    </div>



        





                       


        <div class="e-content">
            




<h2 id="第一章-概要">第一章 概要&nbsp;<a class="headline-hash no-text-decoration" href="#第一章-概要">#</a> </h2>
<p>略</p>
<h2 id="第二章-基础">第二章 基础&nbsp;<a class="headline-hash no-text-decoration" href="#第二章-基础">#</a> </h2>
<p>假设有一场乒乓球比赛, 比赛结果以这种格式记录：</p>
<pre><code>Player1 Player2 | 3:2
</code></pre><p>这意味着选手1与选手2的比分为 3:2, 你需要一个脚本算出每位选手赢了几场比赛并且胜了几局。输入数据(存储在一个叫做 scores 的文件中)像下面这样：</p>
<pre><code>Beth Ana Charlie Dave
Ana Dave        | 3:0
Charlie Beth    | 3:1
Ana Beth        | 2:3
Dave Charlie    | 3:0
Ana Charlie     | 3:1
Beth Dave       | 0:3
</code></pre><p>第一行是选手清单。随后每一行记录着比赛结果。</p>
<p>这里使用 Raku 给出一种解决方案：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="ch">#!/usr/bin/env raku</span>

<span class="k">my</span> <span class="nv">$file</span> <span class="o">=</span> <span class="nb">open</span> <span class="p">&#39;</span><span class="s1">scores</span><span class="p">&#39;;</span>
<span class="k">my</span> <span class="nv">@names</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">get</span><span class="o">.</span><span class="nb">words</span> <span class="p">;</span>  <span class="c1"># get 方法读入一行, 每调用一次 get, 读取一行</span>
<span class="k">my</span> <span class="nv">%matches</span><span class="p">;</span>                   <span class="c1"># 赢得比赛次数</span>
<span class="k">my</span> <span class="nv">%sets</span><span class="p">;</span>                      <span class="c1"># 赢得比赛局数</span>

<span class="k">for</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">lines</span> <span class="k">-&gt;</span> <span class="nv">$line</span> <span class="p">{</span>                       <span class="c1"># .lines 是惰性的</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$pairing</span><span class="o">,</span> <span class="nv">$result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> | </span><span class="p">&#39;);</span> <span class="c1"># 对剩下的每一行调用 split 操作</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$p1</span><span class="o">,</span> <span class="nv">$p2</span><span class="p">)</span>          <span class="o">=</span> <span class="nv">$pairing</span><span class="o">.</span><span class="nb">words</span><span class="p">;</span>     <span class="c1"># 提取选手1和选手2的名字</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$r1</span><span class="o">,</span> <span class="nv">$r2</span><span class="p">)</span>          <span class="o">=</span> <span class="nv">$result</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1">:</span><span class="p">&#39;);</span> <span class="c1"># 提取比赛比分</span>

    <span class="nv">%sets</span><span class="p">{</span><span class="nv">$p1</span><span class="p">}</span> <span class="o">+=</span> <span class="nv">$r1</span><span class="p">;</span>  <span class="c1"># 选手1赢得的比赛局数</span>
    <span class="nv">%sets</span><span class="p">{</span><span class="nv">$p2</span><span class="p">}</span> <span class="o">+=</span> <span class="nv">$r2</span><span class="p">;</span>  <span class="c1"># 选手2赢得的比赛局数</span>

    <span class="k">if</span> <span class="nv">$r1</span> <span class="o">&gt;</span> <span class="nv">$r2</span> <span class="p">{</span> <span class="c1"># 如果每场比赛中, 选手1赢的局数多于选手2, 则选手1赢得的比赛数+1, 反之选手2的+1</span>
        <span class="nv">%matches</span><span class="p">{</span><span class="nv">$p1</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">%matches</span><span class="p">{</span><span class="nv">$p2</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">@sorted</span> <span class="o">=</span> <span class="nv">@names</span><span class="o">.</span><span class="nb">sort</span><span class="p">(</span> <span class="p">{</span> <span class="nv">%sets</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">}</span> <span class="p">)</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%matches</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">}</span> <span class="p">)</span><span class="o">.</span><span class="nb">reverse</span><span class="p">;</span>

<span class="k">for</span> <span class="nv">@sorted</span> <span class="k">-&gt;</span> <span class="nv">$n</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$n</span><span class="s2"> has won </span><span class="nv">%matches</span><span class="p">{</span><span class="nv">$n</span><span class="p">}</span><span class="s2"> matches and </span><span class="nv">%sets</span><span class="p">{</span><span class="nv">$n</span><span class="p">}</span><span class="s2"> sets</span><span class="p">&#34;;</span>
<span class="p">}</span>
</code></pre></div><p>输出如下：</p>
<pre><code>Ana has won 2 matches and 8 sets
Dave has won 2 matches and 6 sets
Charlie has won 1 matches and 4 sets
Beth has won 1 matches and 4 sets
</code></pre><p>每个 Raku 程序应该以 <code>#!/usr/bin/env raku</code> 作为开始。</p>
<p>在 Raku 中, 变量名以一个魔符打头, 这个魔符是一个非字母数字符号, 诸如 <code>$</code>, <code>@</code>, <code>%</code> 或者 <code>&amp;</code>, 还有更少见的双冒号 <code>::</code>。
内置函数 <a href="https://docs.raku.org/routine/open">open</a> 打开了一个名叫 scores 的文件, 并返回一个文件句柄, 即一个代表该文件的对象。赋值符号 <code>=</code> 将句柄赋值给左边的变量, 这意味着 <code>$file</code> 现在存储着该文件句柄。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@names</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">get</span><span class="o">.</span><span class="nb">words</span><span class="p">;</span>
</code></pre></div><p>上边这句的右侧对存储在 <code>$file</code> 中的文件句柄调用了 <a href="https://docs.raku.org/routine/get">get</a> 方法, <code>get</code> 方法从文件中读取并返回一行, 并去掉行的末尾。<a href="https://docs.raku.org/routine/words">.words</a> 也是一个方法, 用于从 get 方法返回的字符串上。<code>.words</code> 方法将它的组件 - 它操作的字符串, 分解成一组单词, 这里即意味着不含空格的字符串。它把单个字符串 &lsquo;Beth Ana Charlie Dave&rsquo; 转换成一组字符串 &lsquo;Beth&rsquo;, &lsquo;Ana&rsquo;, &lsquo;Charlie&rsquo;, &lsquo;Dave&rsquo;。最后, 这组字符串存储在数组 <code>@names</code> 中。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">%matches</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%sets</span><span class="p">;</span>
</code></pre></div><p>在比分计数程序中, <code>%matches</code> 存储每位选手赢得的比赛数, <code>%sets</code> 存储每位选手赢得的比赛局数。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">for</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">lines</span> <span class="k">-&gt;</span> <span class="nv">$line</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre></div><p>for 循环中 $file.lines 产生一组从文件 scores 读取的行, 从上次 $file.lines 离开的地方开始, 一直到文件末尾结束。
在第一次循环中, $line 会包含字符串 <code>Ana Dave | 3:0;</code> 在第二次循环中, $line 会包含 <code>Charlie Beth | 3:1</code>,以此类推。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="p">(</span><span class="nv">$pairing</span><span class="o">,</span> <span class="nv">$result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> | </span><span class="p">&#39;);</span>
</code></pre></div><p>split此处是一个方法, 字符串 &lsquo;|&rsquo; 是它的参数。</p>
<p>第一次循环结束：</p>
<pre><code>Variable       Contents
$line           'Ana Dave | 3:0'
$pairing        'Ana Dave'
$result         '3:0'
$p1             'Ana'
$p2             'Dave'
$r1              '3'
$r2              '0'
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@sorted</span> <span class="o">=</span> <span class="nv">@names</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%sets</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%matches</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">reverse</span><span class="p">;</span>
</code></pre></div><p>这一句是排序, 先按比赛局数多少排序, 再按赢得的比赛数排序, 然后反转。打印选手名字的时候以胜负次序排序, 代码必须使用选手的分数, 而非他们的名字来进行排序。sort 方法的参数是一个代码块, 用于将数组元素（选手的名字）转换成用于排序的数据。数组的元素通过变量 <code>$_</code> 传递到代码块中。</p>
<p>最简单的使用分数排序选手的方法应该是:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@names</span><span class="o">.</span><span class="nb">sort</span><span class="p">(</span> <span class="p">{</span> <span class="nv">%matches</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></div><p>这是通过使用赢得比赛的次数来进行排序。然而, Ana 和 Dave都赢了两场比赛。还需要比较谁赢的的比赛局数多, 才能决定比赛的排名。</p>
<p>在双引号括起的字符串中, 标量和花括号中的变量能进行变量插值。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">$names</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">things</span><span class="p">&#39;;</span>
<span class="nb">say</span> <span class="p">&#39;</span><span class="s1">Do not call me $names</span><span class="p">&#39;;</span> <span class="c1"># Do not call me $names</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Do not call me </span><span class="nv">$names</span><span class="p">&#34;;</span> <span class="c1"># Do not call me things</span>
</code></pre></div><p>花括号中的数组进行插值后会变成用空格分隔的条目。花括号中的散列插值后每个散列键值对单独成为一行, 每行包含一个健, 随后是一个 tab 制表符, 然后是键值, 最后是一个新行符。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Math: </span><span class="p">{</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">}&#34;</span>     <span class="c1"># Math: 3</span>
<span class="k">my</span> <span class="nv">@people</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">Luke Matthew Mark</span><span class="p">&gt;;</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">The synoptics are: </span><span class="p">{</span><span class="nv">@people</span><span class="p">}&#34;</span> <span class="c1"># The synoptics are: Luke Matthew Mark</span>

<span class="nb">say</span> <span class="p">&#34;{</span><span class="nv">%sets</span><span class="p">}&#34;;</span> <span class="c1"># From the table tennis tournament</span>

<span class="c1"># Charlie 4</span>
<span class="c1"># Dave 6</span>
<span class="c1"># Ana 8</span>
<span class="c1"># Beth 4</span>
</code></pre></div><p>当数组和散列变量直接出现在双引号字符串中(并且不在花括号 <code>{}</code> 里), 它们只在它们的名字后跟着一个 postcircumfix - 一对括号, 后面跟着语句时才会进行插值。在变量名和后置环缀之间进行方法调用也是可以的(例如 <code>@flavours.sort()</code>)</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@flavours</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">vanilla peach</span><span class="p">&gt;;</span>

<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">we have </span><span class="nv">@flavours</span><span class="p">&#34;;</span>    <span class="c1"># we have @flavours, 这里没进行插值</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">we have </span><span class="nv">@flavours</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">&#34;;</span> <span class="c1"># we have vanilla, 后置环缀, 变量名字后面跟着一对儿括号</span>
<span class="c1"># so-called &#34;Zen slice&#34;</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">we have </span><span class="nv">@flavours</span><span class="o">[]</span><span class="p">&#34;;</span>  <span class="c1"># we have vanilla peach</span>

<span class="c1"># 以后置环缀结尾的方法调用</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">we have </span><span class="nv">@flavours</span><span class="o">.</span><span class="nf">sort</span><span class="p">()&#34;;</span> <span class="c1"># we have peach vanilla</span>

<span class="c1"># 链式方法调用:</span>
<span class="nb">say</span> <span class="p">&#34;</span><span class="s2">we have </span><span class="nv">@flavours</span><span class="o">.</span><span class="nf">sort.join</span><span class="p">(&#39;</span><span class="s1">, </span><span class="p">&#39;)&#34;;</span>
<span class="c1"># we have peach, vanilla</span>
</code></pre></div><h3 id="练习">练习&nbsp;<a class="headline-hash no-text-decoration" href="#练习">#</a> </h3>
<p>例子中的第一行选手的名字是多余的, 你可以在参加比赛的选手中找出所有选手的名字！如果例子中的第一行被省略了, 你如何更改程序？提示：<code>%hash.keys</code> 返回散列 <code>%hash</code> 中的所有键。</p>
<p>答案: 移除此行：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@names</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">get</span><span class="o">.</span><span class="nb">words</span><span class="p">;</span>
</code></pre></div><p>并且将</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@sorted</span> <span class="o">=</span> <span class="nv">@names</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%sets</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%matches</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">reverse</span><span class="p">;</span>
</code></pre></div><p>变成:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@sorted</span> <span class="o">=</span> <span class="nv">%sets</span><span class="o">.</span><span class="nb">keys</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%sets</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">sort</span><span class="p">({</span> <span class="nv">%matches</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">})</span><span class="o">.</span><span class="nb">reverse</span><span class="p">;</span>
</code></pre></div><p>除了移除冗余, 你也可以用它来提醒我们, 如果一个选手没有在第一行的名字清单中被提到, 例如因为输入错误, 你该怎样修改你的程序？</p>
<p>答案: 引入另外一个散列, 合法选手的名字作为键, 当读取选手名字的时候查找该散列：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@names</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">get</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> </span><span class="p">&#39;);</span>
<span class="k">my</span> <span class="nv">%legitimate-players</span><span class="p">;</span>

<span class="k">for</span> <span class="nv">@names</span> <span class="k">-&gt;</span> <span class="nv">$n</span> <span class="p">{</span> <span class="c1">#  -&gt; 两侧要有空格</span>
    <span class="nv">%legitimate-players</span><span class="p">{</span><span class="nv">$n</span><span class="p">}</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">for</span> <span class="nv">$file</span><span class="o">.</span><span class="nb">lines</span> <span class="k">-&gt;</span> <span class="nv">$line</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$pairing</span><span class="o">,</span> <span class="nv">$result</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> | </span><span class="p">&#39;);</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$p1</span><span class="o">,</span> <span class="nv">$p2</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$pairing</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> </span><span class="p">&#39;);</span>
    
    <span class="k">for</span> <span class="nv">$p1</span><span class="o">,</span> <span class="nv">$p2</span> <span class="k">-&gt;</span> <span class="nv">$p</span> <span class="p">{</span>
        <span class="k">if</span> <span class="o">!</span><span class="nv">%legitimate-players</span><span class="p">{</span><span class="nv">$p</span><span class="p">}</span> <span class="p">{</span>
            <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Warning: &#39;</span><span class="nv">$p&#39;</span><span class="s2"> is not on our list!</span><span class="p">&#34;;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre></div><h2 id="第三章-操作符">第三章 操作符&nbsp;<a class="headline-hash no-text-decoration" href="#第三章-操作符">#</a> </h2>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Ana</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">8</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Dave</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Charlie</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Beth</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$screen-width</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$label-area-width</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="o">[</span><span class="nb">max</span><span class="o">]</span> <span class="nv">@scores</span><span class="o">».</span><span class="nb">key</span><span class="o">».</span><span class="nb">chars</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$max-score</span> <span class="o">=</span> <span class="o">[</span><span class="nb">max</span><span class="o">]</span> <span class="nv">@scores</span><span class="o">».</span><span class="nb">value</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$unit</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$screen-width</span> <span class="o">-</span> <span class="nv">$label-area-width</span><span class="p">)</span> <span class="o">/</span> <span class="nv">$max-score</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$format</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">%- </span><span class="p">&#39;</span> <span class="o">~</span> <span class="nv">$label-area-width</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2">s</span><span class="nv">%s</span><span class="s2">\n</span><span class="p">&#34;;</span>

<span class="k">for</span> <span class="nv">@scores</span> <span class="p">{</span>
    <span class="nb">printf</span> <span class="nv">$format</span><span class="o">,</span> <span class="o">.</span><span class="nb">key</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">X</span><span class="p">&#39;</span> <span class="nb">x</span> <span class="p">(</span><span class="nv">$unit</span> <span class="o">*</span> <span class="o">.</span><span class="nb">value</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>在这个例子中, 我们计算一下每位选手在竞标赛中赢得比赛的局数。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Ana</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">8</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Dave</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Charlie</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Beth</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>  
</code></pre></div><p>这一句局包含了三个不同的操作符 <code>=</code> 和 <code>=&gt;</code> 和 <code>,</code>。以字符串连接操作符 <code>~</code> 为例, <code>$string ~= &quot;text&quot;</code> 等价于 <code>$string = $string ~ &quot;text&quot;</code>。</p>
<p><code>=&gt;</code> 操作符(大键号)创建了一个键值对对象, 一个键值对存储着键和值；键在 <code>=&gt;</code> 操作符的左侧, 值在右侧。这个操作符有一个特殊的特性：编译器会把 <code>=&gt;</code> 操作符左侧的任何裸标识符解释为一个字符串。你也可以这样写：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="s">Ana</span> <span class="o">=&gt;</span> <span class="mi">8</span>, <span class="s">Dave</span> <span class="o">=&gt;</span> <span class="mi">6</span>, <span class="s">Charlie</span> <span class="o">=&gt;</span> <span class="mi">4</span>, <span class="s">Beth</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>
</code></pre></div><p>最后逗号操作符 <code>,</code> 构建了一个对象序列, 在该情况下, 所谓的对象就是键值对。</p>
<p>这三个操作符都是中缀操作符, 这意味着它在两个条目之间。</p>
<p>一个项前面可以有0个或多个前缀操作符, 所以你可以写比如 <code>4 + -5</code>。<code>+</code> 号（一个中缀操作符）的后面, 编译器期望一个项, 为了将 <code>-</code> 号解释为项 5 的一个前缀。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">$label-area-width</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="o">[</span><span class="nb">max</span><span class="o">]</span> <span class="nv">@scores</span><span class="o">».</span><span class="nb">key</span><span class="o">».</span><span class="nb">chars</span><span class="p">;</span>
</code></pre></div><p><code>»</code> 是一个特殊的符号, 打印不出来可以用两个大于号 <code>&gt;&gt;</code> 代替。中缀操作符 <code>max</code> 返回两个值中的较大者, 所以 <code>2 max 3</code> 返回 3。方括号包裹着一个中缀操作符让 Raku 将该中缀操作符应用到列表中的元素之间。<code>[max] 1,5,3,7</code> 和 <code>1 max 5 max 3 max 7</code> 一样, 结果都为 7。</p>
<p>同样地, <code>[+]</code> 用来计算列表元素的和, <code>[*]</code> 用来计算列表元素的积, <code>[&lt;=]</code> 用来检查一个列表的值是否按递增排序。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">».</span><span class="nb">key</span><span class="o">».</span><span class="nb">chars</span>
<span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="s">Ana</span> <span class="o">=&gt;</span> <span class="mi">8</span>, <span class="s">Dave</span> <span class="o">=&gt;</span> <span class="mi">6</span>, <span class="s">Charlie</span> <span class="o">=&gt;</span> <span class="mi">4</span>, <span class="s">Beth</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="n">Ana</span>     <span class="mi">8</span> <span class="n">Dave</span>  <span class="mi">6</span> <span class="n">Charlie</span>       <span class="mi">4</span> <span class="n">Beth</span>  <span class="mi">4</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">.</span><span class="nb">key</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">Method &#39;key&#39; not found for invocant of class &#39;Array&#39;
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">&gt;&gt;.</span><span class="nb">key</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">Ana Dave Charlie Beth
</code></pre></div><p>就像 <code>@variable.method</code> 在 <code>@variable</code> 上调用一个方法一样, <code>@array».method</code> 对 <code>@array</code> 中的每一项调用 <code>method</code> 方法, 并且返回一个返回值的列表。即 <code>@scores&gt;&gt;.key</code> 返回一个列表。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">&gt;&gt;.</span><span class="nb">key</span><span class="o">&gt;&gt;.</span><span class="nb">chars</span>  <span class="c1"># 每个名字含有几个字符</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">4 7 4
</code></pre></div><p>表达式 <code>[max] @scores».key».chars</code> 给出 (3,4,7,4) 中的最大值。它与下面的表达式相同：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="nb">key</span><span class="o">.</span><span class="nb">chars</span>
<span class="nb">max</span> <span class="nv">@scores</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="nb">key</span><span class="o">.</span><span class="nb">chars</span>
<span class="nb">max</span> <span class="nv">@scores</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="nb">key</span><span class="o">.</span><span class="nb">chars</span>
<span class="nb">max</span> <span class="o">...</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="p">&#34;</span><span class="s2">Ana</span><span class="p">&#34;</span> <span class="o">=&gt;</span> <span class="mi">8</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nv">@scores</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="nb">key</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">Ana
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">$format</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">%- </span><span class="p">&#39;</span> <span class="o">~</span> <span class="nv">$label-area-width</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2">s</span><span class="nv">%s</span><span class="s2">\n</span><span class="p">&#34;;</span>

<span class="k">for</span> <span class="nv">@scores</span> <span class="p">{</span>
    <span class="nb">printf</span> <span class="nv">$format</span><span class="o">,</span> <span class="o">.</span><span class="nb">key</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">X</span><span class="p">&#39;</span> <span class="nb">x</span> <span class="p">(</span><span class="nv">$unit</span> <span class="o">*</span> <span class="o">.</span><span class="nb">value</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>定义一个格式, <code>%-</code> 表示左对齐, <code>~</code> 是字符串连接操作符 <code>.for</code> 循环中, <code>@scores</code> 中的每一项被绑定给特殊变量 <code>$_</code>, <code>.key</code> 是每项的键, 即名字, <code>.value</code> 是每项的键值, 即得分。小 x 是字符串重复操作符。</p>
<h3 id="关于优先级的的一句话">关于优先级的的一句话&nbsp;<a class="headline-hash no-text-decoration" href="#关于优先级的的一句话">#</a> </h3>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Ana</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">8</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Dave</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Charlie</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Beth</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>
</code></pre></div><p>等号右侧产生一个列表（因为逗号, 操作符）, 这个列表由对儿组成(因为 <code>=&gt;</code>), 并且结果赋值给数组变量。
在 Perl5 中会这样解释:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="p">(</span><span class="k">my</span> <span class="nv">@scores</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Ana</span><span class="p">&#39;)</span> <span class="o">=&gt;</span> <span class="mi">8</span>, <span class="p">&#39;</span><span class="s1">Dave</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Charlie</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Beth</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">;</span>
</code></pre></div><p>以至于数组 <code>@scores</code> 中只有一个项, 表达式的其余部分被计算后丢弃。</p>
<p>优先级规则控制着编译器如何解释这一行。Raku 的优先级规则申明 中缀操作符 <code>=&gt;</code> 比 <code>,</code> 中缀操作符对于参数的绑定更紧, 而逗号操作符比等号赋值操作符绑定的更紧。</p>
<p>实际上有两种不同优先级的赋值操作符。当赋值操作符右侧是一个标量时, 使用较紧优先级的项赋值操作符, 否则使用较松优先级的列表赋值操作符。(如同螺丝的松紧)
比较 <code>$a = 1, $b = 2</code> 和 <code>@a = 1, 2,</code> 前者是在一个列表中赋值给两个变量, 后者是将含有两个项的一个列表赋值给一个变量。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">7</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>   <span class="c1"># 5 - 3.5 = 1.5</span>
<span class="nb">say</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="c1"># (-2) / 2 = -1</span>
</code></pre></div><p>Raku 中的优先级可以用圆括号改变, 但是如果圆括号直接跟在标识符的后面而不加空格的话, 则会被解释为参数列表。例如：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="c1"># -2</span>
</code></pre></div><p>只打印出了 <code>5-7</code> 的值。</p>
<p>优先级表</p>
<table>
<thead>
<tr>
<th style="text-align:left">expression</th>
<th style="text-align:left">名称</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">(), 42.5</td>
<td style="text-align:left">(tightest precedence)</td>
</tr>
<tr>
<td style="text-align:left">42.rand</td>
<td style="text-align:left">term</td>
</tr>
<tr>
<td style="text-align:left">$x++</td>
<td style="text-align:left">method calls and postcircumfixes</td>
</tr>
<tr>
<td style="text-align:left">$x**2</td>
<td style="text-align:left">autoincrement and autodecrement</td>
</tr>
<tr>
<td style="text-align:left">?$x, !$x</td>
<td style="text-align:left">exponentiation operator</td>
</tr>
<tr>
<td style="text-align:left">+$x, ~$x</td>
<td style="text-align:left">boolean prefix</td>
</tr>
<tr>
<td style="text-align:left">2*3, 7/5</td>
<td style="text-align:left">prefix context operators</td>
</tr>
<tr>
<td style="text-align:left">1+2, 7-5</td>
<td style="text-align:left">multiplicative infix operators</td>
</tr>
<tr>
<td style="text-align:left">$a x 3</td>
<td style="text-align:left">additive infix operators</td>
</tr>
<tr>
<td style="text-align:left">$x ~&quot;.nn&quot;</td>
<td style="text-align:left">replication operators</td>
</tr>
<tr>
<td style="text-align:left">1&amp;2</td>
<td style="text-align:left">string concatenation</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">abs $x</td>
<td style="text-align:left">junctive OR</td>
</tr>
<tr>
<td style="text-align:left">$x cmp 3</td>
<td style="text-align:left">named unary prefix</td>
</tr>
<tr>
<td style="text-align:left">$x == 3</td>
<td style="text-align:left">non-chaining binary operators</td>
</tr>
<tr>
<td style="text-align:left">$x &amp;&amp; $y</td>
<td style="text-align:left">chaining binary operators</td>
</tr>
<tr>
<td style="text-align:left">$x</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">$x &gt; 0 ?? 1 !! -1</td>
<td style="text-align:left">tight OR infix</td>
</tr>
<tr>
<td style="text-align:left">$x = 1</td>
<td style="text-align:left">conditional operator</td>
</tr>
<tr>
<td style="text-align:left">not $x</td>
<td style="text-align:left">item assignment</td>
</tr>
<tr>
<td style="text-align:left">1, 2</td>
<td style="text-align:left">loose unary prefix</td>
</tr>
<tr>
<td style="text-align:left">1, 2 Z @a</td>
<td style="text-align:left">comma</td>
</tr>
<tr>
<td style="text-align:left">@a = 1, 2</td>
<td style="text-align:left">list infix</td>
</tr>
<tr>
<td style="text-align:left">$x and say &ldquo;Yes&rdquo;</td>
<td style="text-align:left">list prefix, list assignment</td>
</tr>
<tr>
<td style="text-align:left">$x or die &ldquo;No&rdquo;</td>
<td style="text-align:left">loose AND infix</td>
</tr>
<tr>
<td style="text-align:left">;</td>
<td style="text-align:left">loose OR infix</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">statement terminator</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">(loosest precedence)</td>
</tr>
</tbody>
</table>
<h3 id="比较和智能匹配">比较和智能匹配&nbsp;<a class="headline-hash no-text-decoration" href="#比较和智能匹配">#</a> </h3>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@a</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="p">;</span>

<span class="nb">say</span> <span class="nv">@a</span> <span class="o">===</span> <span class="nv">@a</span><span class="p">;</span> <span class="c1"># Bool::True</span>
<span class="nb">say</span> <span class="nv">@a</span> <span class="o">===</span> <span class="nv">@b</span><span class="p">;</span> <span class="c1"># Bool::False</span>

<span class="c1"># these use identity for value</span>
<span class="nb">say</span> <span class="mi">3</span> <span class="o">===</span> <span class="mi">3</span> <span class="c1"># Bool::True</span>
<span class="nb">say</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;</span> <span class="o">===</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;;</span> <span class="c1"># Bool::True</span>

<span class="k">my</span> <span class="nv">$a</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;;</span>
<span class="nb">say</span> <span class="nv">$a</span> <span class="o">===</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;;</span> <span class="c1"># Bool::True</span>

<span class="nv">@b</span><span class="o">===</span><span class="nv">@a</span><span class="p">;</span>   <span class="c1"># False</span>
<span class="nv">@a</span> <span class="ow">eqv</span> <span class="nv">@b</span><span class="p">;</span> <span class="c1"># True</span>
<span class="p">&#39;</span><span class="s1">2</span><span class="p">&#39;</span> <span class="ow">eqv</span> <span class="mi">2</span><span class="p">;</span> <span class="c1"># False</span>
</code></pre></div><p>只有当两个对象有相同的类型和相同的结构时, eqv 操作符才返回 True。在前面定义的例子中, @a  eqv  @b 结果为 True, 因为 @a 和 @b 各自包含相同的值, 另一方面, &lsquo;2&rsquo; eqv 2 返回 &lsquo;False&rsquo; ,因为一个参数是字符串, 另一个是整数, 类型不相同。</p>
<h4 id="数字比较">数字比较&nbsp;<a class="headline-hash no-text-decoration" href="#数字比较">#</a> </h4>
<p>使用 == 中缀操作符查看两个对象是否有相同的数字值。如果某个对象不是数字, Perl 会在比较之前尽力使其数字化。如果没有更好的方式将对象转换为数字, Perl 会使用默认的数字 0 。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span> <span class="mi">1</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">;</span>  <span class="c1"># Bool::True</span>
<span class="nb">say</span> <span class="mi">1</span> <span class="o">==</span> <span class="p">&#39;</span><span class="s1">1</span><span class="p">&#39;;</span>  <span class="c1"># Bool::True</span>
<span class="nb">say</span> <span class="mi">1</span> <span class="o">==</span> <span class="p">&#39;</span><span class="s1">2</span><span class="p">&#39;;</span>  <span class="c1"># Bool::False</span>
<span class="nb">say</span> <span class="mi">3</span> <span class="o">==</span> <span class="p">&#39;</span><span class="s1">3b</span><span class="p">&#39;;</span> <span class="c1"># fails</span>
</code></pre></div><p>跟数字比较相关的还有 <code>&lt;</code>,<code>&lt;=</code>,<code>&gt;</code>,<code>&gt;=</code>。如果两个对象的数字值不同, 使用 <code>!=</code> 会返回 True 。</p>
<p>如果你将数组或列表作为数字, 它会计算列表中项的个数。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@colors</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">red blue green</span><span class="p">&gt;;</span>

<span class="k">if</span> <span class="nv">@colors</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">It&#39;s true, </span><span class="nv">@colors</span><span class="s2"> contains 3 items</span><span class="p">&#34;;</span>
<span class="p">}</span>
</code></pre></div><h4 id="字符串比较">字符串比较&nbsp;<a class="headline-hash no-text-decoration" href="#字符串比较">#</a> </h4>
<p>Raku 中使用 eq 比较字符串, 必要时会将其参数转换为字符串。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">if</span> <span class="nv">$greeting</span> <span class="ow">eq</span> <span class="p">&#39;</span><span class="s1">hello</span><span class="p">&#39;</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">welcome</span><span class="p">&#39;;</span>
<span class="p">}</span>
</code></pre></div><p>Table 3.2: Operators and Comparisons</p>
<table>
<thead>
<tr>
<th style="text-align:left">数字比较</th>
<th style="text-align:left">字符串比较</th>
<th style="text-align:left">意思</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">==</td>
<td style="text-align:left">eq</td>
<td style="text-align:left">等于</td>
</tr>
<tr>
<td style="text-align:left">!=</td>
<td style="text-align:left">ne</td>
<td style="text-align:left">不等于</td>
</tr>
<tr>
<td style="text-align:left">!==</td>
<td style="text-align:left">!eq</td>
<td style="text-align:left">不等于</td>
</tr>
<tr>
<td style="text-align:left">&lt;</td>
<td style="text-align:left">lt</td>
<td style="text-align:left">小于</td>
</tr>
<tr>
<td style="text-align:left">&lt;=</td>
<td style="text-align:left">le</td>
<td style="text-align:left">小于或等于</td>
</tr>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">gt</td>
<td style="text-align:left">大于</td>
</tr>
<tr>
<td style="text-align:left">&gt;=</td>
<td style="text-align:left">ge</td>
<td style="text-align:left">大于或等于</td>
</tr>
</tbody>
</table>
<p>例如, <code>'a' lt 'b'</code> 为 true, <code>'a' lt 'aa'</code> 也为 true。 != 是 <code>!==</code> 的便捷形式, 它实际是 <code>!</code> 元操作符加在 中缀操作符 <code>==</code> 之前。同样地, <code>ne</code> 和 <code>!eq</code>s 是一样的。</p>
<p>三路操作符</p>
<p>三路操作符有两个操作数, 如果左侧较小, 返回 Order::Increase , 两侧相等则返回 Order::Same, 如果右侧较小则返回 Order::Decrease。对于数字使用三路操作符 <code>&lt;=&gt;</code>,对于字符串, 使用三路操作符 <code>leg</code> （取自 lesser, equal, greater）。中缀操作符 cmp 是一个对类型敏感的三路操作符, 它像 <code>&lt;=&gt;</code> 一样比较数字, 像 leg 一样比较字符串, 并且比较键值对儿时, 先比较键, 如果键相同再比较键值：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span> <span class="mi">10</span> <span class="o">&lt;=&gt;</span> <span class="mi">5</span><span class="p">;</span>     <span class="c1"># +1</span>
<span class="nb">say</span> <span class="mi">10</span> <span class="ow">leg</span> <span class="mi">5</span><span class="p">;</span>     <span class="c1"># because &#39;1&#39; lt &#39;5&#39;</span>
<span class="nb">say</span> <span class="p">&#39;</span><span class="s1">ab</span><span class="p">&#39;</span> <span class="ow">leg</span> <span class="p">&#39;</span><span class="s1">a</span><span class="p">&#39;;</span> <span class="c1"># +1, lexicographic comparison</span>
</code></pre></div><p>三路操作符的典型用处就是用在排序中。列表中的 <code>.sort</code> 方法能使用一个含有两个值的块或一个函数, 比较它们, 并返回一个小于, 等于或大于 0 的值。 sort 方法根据该返回值进行排序：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nb">say</span> <span class="o">~&lt;</span><span class="n">abstract</span> <span class="n">Concrete</span><span class="o">&gt;.</span><span class="nb">sort</span><span class="p">;</span>
<span class="c1"># output: Concrete abstract</span>

<span class="nb">say</span> <span class="o">~&lt;</span><span class="n">abstract</span> <span class="n">Concrete</span><span class="o">&gt;.</span><span class="nb">sort</span><span class="o">:</span> <span class="k">-&gt;</span> <span class="nv">$a</span><span class="o">,</span> <span class="nv">$b</span> <span class="p">{</span> <span class="nb">uc</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span> <span class="ow">leg</span> <span class="nb">uc</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span> <span class="p">};</span>
<span class="c1"># output: abstract Concrete</span>
</code></pre></div><p>默认的, 比较是大小写敏感的, 通过比较它们的大写变形, 而不是比较它们的值, 这个例子使用了大小写敏感排序。</p>
<h4 id="智能匹配">智能匹配&nbsp;<a class="headline-hash no-text-decoration" href="#智能匹配">#</a> </h4>
<p>使用 <code>~~</code> 做正确的事情。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">if</span> <span class="nv">$pints-drunk</span> <span class="o">~~</span> <span class="mi">8</span> <span class="p">{</span>
   <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Go home, you&#39;ve had enough!</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="nv">$country</span> <span class="o">~~</span> <span class="p">&#39;</span><span class="s1">Sweden</span><span class="p">&#39;</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Meatballs with lingonberries and potato moose, please.</span><span class="p">&#34;</span>
<span class="p">}</span>

<span class="k">unless</span> <span class="nv">$group-size</span> <span class="o">~~</span> <span class="mi">2</span><span class="o">..</span><span class="mi">4</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">You must have between 2 and 4 people to book this tour.</span><span class="p">&#34;;</span>
<span class="p">}</span>
</code></pre></div><p>智能匹配总是根据 <code>~~</code> 右侧值的类型来决定使用哪种比较。上个例子中, 比较的是数字、字符串和范围。
智能匹配的工作方式 <code>$answer ~~ 42</code> 等价于 <code>42.ACCPETS( $answer )</code>。对 <code>~~</code> 操作符右侧的操作数调用 ACCEPTS 方法, 并将左操作数作为参数传入。</p>
<h2 id="第四章-子例程和签名">第四章 子例程和签名&nbsp;<a class="headline-hash no-text-decoration" href="#第四章-子例程和签名">#</a> </h2>
<p>一个子例程就是一段执行特殊任务的代码片段。它可以对提供的数据(<code>实参</code>)操作, 并产生结果（返回值）。子例程的签名是它<code>所含的参数</code>和它产生的<code>返回值</code>的描述。从某一意义上来说, 第三章描述的操作符也是 Raku 用特殊方式解释的子例程。</p>
<h3 id="申明子例程">申明子例程&nbsp;<a class="headline-hash no-text-decoration" href="#申明子例程">#</a> </h3>
<p>子例程申明由几部分组成。首先, <code>sub</code> 表明你在申明一个子例程, 然后是可选的子例程的名称和可选的签名。子例程的主体是一个用花括号扩起来的代码块。
默认的, 子例程是本地作用域的, 就像任何使用 <code>my</code> 申明的变量一样。这意味着, 一个子例程只能在它被申明的作用域内被调用。使用 <code>our</code> 来申明子例程可以使其在当前包中可见。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="p">{</span>
    <span class="k">our</span> <span class="k">sub</span> <span class="nf">eat</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">om nom nom</span><span class="p">&#34;;</span>
    <span class="p">}</span>

    <span class="k">sub</span> <span class="nf">drink</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">glug glug</span><span class="p">&#34;;</span>
    <span class="p">}</span>
 <span class="p">}</span>

<span class="k">our</span> <span class="nv">&amp;eat</span><span class="p">;</span> <span class="c1"># makes the package-scoped sub eat available in this lexical scope</span>

<span class="nf">eat</span><span class="p">();</span>   <span class="c1"># om nom nom</span>
<span class="nf">drink</span><span class="p">();</span> <span class="c1"># 失败, can&#39;t drink outside of the block</span>
</code></pre></div><p>our 也能让子例程从包或模块的外部是可见的：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">module</span> <span class="nn">EatAndDrink</span> <span class="p">{</span>
    <span class="k">our</span> <span class="k">sub</span> <span class="nf">eat</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">om nom nom</span><span class="p">&#34;;</span>
    <span class="p">}</span>

    <span class="k">sub</span> <span class="nf">drink</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">glug glug</span><span class="p">&#34;;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">EatAndDrink::eat</span><span class="p">();</span> <span class="c1"># om nom nom</span>
<span class="nf">EatAndDrink::drink</span><span class="p">();</span> <span class="c1"># fails, not declared with &#34;our&#34;</span>
</code></pre></div><p>你也可以<code>导出</code>一个子例程, 让它在另外的作用域内可见。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="c1"># in file Math/Trivial.pm</span>
<span class="k">module</span> <span class="nn">Math::Trivial</span> <span class="p">{</span>
    <span class="k">sub</span> <span class="nf">double</span><span class="p">(</span><span class="nv">$x</span><span class="p">)</span> <span class="k">is</span> <span class="k">export</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nv">$x</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>然后在其它程序或模块中你可以这样写:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">use</span> <span class="nn">Math::Trivial</span><span class="p">;</span> <span class="c1"># imports sub double</span>
<span class="nb">say</span> <span class="nf">double</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span>    <span class="c1"># 21 is only half the truth</span>
</code></pre></div><p>Raku 的子例程都是对象。你可以将它们随意传递并存储在数据结构中。编程语言设计者常常将它们称之为 first-class 子例程；它们就像数组和散列一样作为语言的基础。</p>
<p>First-class 子例程能帮助你解决复杂的问题。例如, 为了做出一个微型的ASCII艺术舞蹈图, 你可能要建立一个散列, 键是舞蹈动作的名称, 键值是匿名散列。假使使用者能键入一系列舞蹈动作（可能是站在舞蹈平台上或其它外部输入设备）。 你怎么保持一个变量清单中都是合法的行为, 允许使用者输入, 并限制输入是一系列安全的行为呢？</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">%moves</span> <span class="o">=</span>
<span class="s">hands-over-head</span>       <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">/o\ </span><span class="p">&#39;</span>  <span class="p">}</span>,
<span class="s">bird-arms</span>             <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">|/o\| </span><span class="p">&#39;}</span>,
<span class="s">left</span>                  <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">&gt;o </span><span class="p">&#39;</span>   <span class="p">}</span>,
<span class="s">right</span>                 <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">o&lt; </span><span class="p">&#39;</span>   <span class="p">}</span>,
<span class="s">arms-up</span>               <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">\o/ </span><span class="p">&#39;</span>  <span class="p">};</span>

<span class="k">my</span> <span class="nv">@awesome-dance</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">arms-up bird-arms right hands-over-head</span><span class="p">&gt;;</span>

<span class="k">for</span> <span class="nv">@awesome-dance</span> <span class="k">-&gt;</span> <span class="nv">$move</span> <span class="p">{</span>
    <span class="nv">%moves</span><span class="p">{</span><span class="nv">$move</span><span class="p">}</span><span class="o">.</span><span class="p">();</span>  <span class="c1"># 在散列上调用方法</span>
<span class="p">}</span>
</code></pre></div><pre><code>outputs:
 \o/
|/o\|
  o&lt;
 /o\.
</code></pre>
<h3 id="adding-signatures">Adding Signatures&nbsp;<a class="headline-hash no-text-decoration" href="#adding-signatures">#</a> </h3>
<p>子例程的签名执行两个任务。首先, 它申明哪个调用者可能或必须将参数传递给子例程。第二, 它申明子例程中的变量被绑定到哪些参数上。这些变量叫做参数。Raku 的签名更深入, 它们允许你限制参数的类型, 值和参数的定义, 并准确匹配复杂数据结构的某一部分。此外, 它们也允许你显式地指定子例程返回值的类型。</p>
<h4 id="基础">基础&nbsp;<a class="headline-hash no-text-decoration" href="#基础">#</a> </h4>
<p>签名最简单的形式是, 绑定到输入参数上的用逗号分隔的一列变量的名字。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-beer</span><span class="p">(</span><span class="nv">$type</span><span class="o">,</span> <span class="nv">$pints</span><span class="p">)</span> <span class="p">{</span>
   <span class="nb">say</span> <span class="p">(</span><span class="nv">$pints</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">??</span> <span class="p">&#39;</span><span class="s1">A pint</span><span class="p">&#39;</span> <span class="o">!!</span> <span class="p">&#34;</span><span class="nv">$pints</span><span class="s2"> pints</span><span class="p">&#34;)</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2"> of </span><span class="nv">$type</span><span class="s2">, please.</span><span class="p">&#34;</span>
<span class="p">}</span>

<span class="nf">order-beer</span><span class="p">(&#39;</span><span class="s1">Hobgoblin</span><span class="p">&#39;</span><span class="o">,</span> <span class="mi">1</span><span class="p">);</span>    <span class="c1"># A pint of Hobgoblin, please.</span>
<span class="nf">order-beer</span><span class="p">(&#39;</span><span class="s1">Zlatý Bažant</span><span class="p">&#39;</span><span class="o">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1"># 3 pints of Zlatý Bažant, please.</span>
</code></pre></div><p>这里使用的关系绑定而非赋值就是签名。默认地, 在 Raku 中, 子例程中引用到传入参数的签名的变量是只读的。这意味着你不能从子例程内部修改它们。
如果只读绑定太受限制了, 你可以将 <code>is rw</code> (rw 是 read/write 的缩写) 特性应用到参数上以降低这种限制。这个特性说明参数是可读可写的, 这允许你从子例程内部修改参数。使用的时候必须小心, 因为它会修改传入的原始对象。如果你试图传入一个字面值, 一个常量, 或其它类型的不可变对象到一个有 <code>is rw</code> 特性的参数中, 绑定会在调用时失败并抛出异常:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">make-it-more-so</span><span class="p">(</span><span class="nv">$it</span> <span class="k">is</span> <span class="k">rw</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$it</span> <span class="o">~=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$it</span><span class="o">,</span> <span class="nv">$it</span><span class="o">.</span><span class="nb">chars</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="nb">x</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">$happy</span> <span class="o">=</span> <span class="p">&#34;</span><span class="s2">yay!</span><span class="p">&#34;;</span>
<span class="nf">make-it-more-so</span><span class="p">(</span><span class="nv">$happy</span><span class="p">);</span>
<span class="nb">say</span> <span class="nv">$happy</span><span class="p">;</span> <span class="c1"># yay!!!!!!   # 原始传入对象被修改了</span>
<span class="nf">make-it-more-so</span><span class="p">(&#34;</span><span class="s2">uh-oh</span><span class="p">&#34;);</span> <span class="c1"># 失败, 不能修改一个常量</span>
</code></pre></div><p>如果你想将参数的本地副本用在子例程内部而不改变调用者的变量, 使用 <code>is copy</code> 特性：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">say-it-one-higher</span><span class="p">(</span><span class="nv">$it</span> <span class="k">is</span> <span class="nb">copy</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$it</span><span class="o">++</span><span class="p">;</span>
    <span class="nb">say</span> <span class="nv">$it</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">$unanswer</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span>
<span class="nf">say-it-one-higher</span><span class="p">(</span><span class="nv">$unanswer</span><span class="p">);</span> <span class="c1"># 42</span>
<span class="nf">say-it-one-higher</span><span class="p">(</span><span class="mi">41</span><span class="p">);</span>        <span class="c1"># 42</span>
<span class="nb">say</span> <span class="nv">$unanswer</span><span class="p">;</span>                <span class="c1"># 41</span>
</code></pre></div><p>在诸如 <code>C/C++</code> 和 Scheme 等其它类型的编程语言中,这种广为人知的求值策略就是按值传递。当使用 <code>is copy</code> 特性时, 只有本地副本被赋值。其它任何传递给子例程的参数在调用者的作用域内保持不变。（一个不可变对象是当这个对象被创建后, 它的状态不会改变, 作为比较, 一个可变对象的状态在创建后是会被改变的）</p>
<h4 id="传递数组散列和代码">传递数组、散列和代码&nbsp;<a class="headline-hash no-text-decoration" href="#传递数组散列和代码">#</a> </h4>
<p>一个变量的魔符表明它的本意用途。在签名中, 变量的魔符也起着限制传入的参数类型的作用。例如, <code>@</code> 符号检查传入的对象行使位置角色（一个角色包含像数组和列表的类型）。如果传递的东西不能匹配这样的限制, 会引起调用失败：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">shout-them</span><span class="p">(</span><span class="nv">@words</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nv">@words</span> <span class="k">-&gt;</span> <span class="nv">$w</span> <span class="p">{</span>
        <span class="nb">print</span> <span class="nb">uc</span><span class="p">(&#34;</span><span class="nv">$w</span><span class="s2"> </span><span class="p">&#34;);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">@last_words</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">do not want</span><span class="p">&gt;;</span>

<span class="nf">shout-them</span><span class="p">(</span><span class="nv">@last_words</span><span class="p">);</span> <span class="c1"># DO NOT WANT</span>
<span class="nf">shout-them</span><span class="p">(&#39;</span><span class="s1">help</span><span class="p">&#39;);</span>      <span class="c1"># 失败了, 字符串不是位置参数</span>
</code></pre></div><p>类似地, <code>%</code> 符号表明调用者必须传递一个行使关系角色的对象；即允许通过 <code>&lt;...&gt;</code> 或 <code>{...}</code> 进行索引的东西。 <code>&amp;</code> 符号要求调用者传递一个诸如匿名散列之类的行使能调用的角色的对象。在那种情况下, 你也可以不用 <code>&amp;</code> 符号调用可调用的参数：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">do-it-lots</span><span class="p">(</span><span class="nv">&amp;it</span><span class="o">,</span> <span class="nv">$how-many-times</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="mi">1</span><span class="o">..</span><span class="nv">$how-many-times</span> <span class="p">{</span>
        <span class="nf">it</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">do-it-lots</span><span class="p">(</span><span class="k">sub</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Eating a stroopwafel</span><span class="p">&#34;</span> <span class="p">}</span><span class="o">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1"># 此处是一个匿名子例程</span>
</code></pre></div><p>标量使用 <code>$</code> 符号, 并表明没有限制。什么都可以绑定在它上面, 即使它使用另外的符号绑定到一个对象上。</p>
<h4 id="插值数组和散列">插值、数组和散列&nbsp;<a class="headline-hash no-text-decoration" href="#插值数组和散列">#</a> </h4>
<p>有时你想从数组中填充占位参数。你可以通过在数组前添加一个垂直竖条或管道字符 ( <code>|</code> ): <code>eat(|@food)</code>, 而不是写作 <code>eat(@food[0], @food[1], @food[2], ...)</code> 等将它们吸进参数列表( <code>|</code> 像不像一个吸管, ^_^)。</p>
<p>同样地, 你可以将散列插值进具名参数:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-shrimps</span><span class="p">(</span><span class="nv">$count</span><span class="o">,</span> <span class="o">:</span><span class="nv">$from</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I&#39;d like </span><span class="nv">$count</span><span class="s2"> pieces of shrimp from the </span><span class="nv">$from</span><span class="s2">, please</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">%user-preferences</span> <span class="o">=</span> <span class="s">from</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Northern Sea</span><span class="p">&#39;;</span>

<span class="nf">order-shrimps</span><span class="p">(</span><span class="mi">3</span><span class="o">,</span> <span class="o">|</span><span class="nv">%user-preferences</span><span class="p">);</span>
<span class="c1"># I&#39;d like 3 pieces of shrimp from the Northern Sea, please</span>
</code></pre></div><h4 id="可选参数">可选参数&nbsp;<a class="headline-hash no-text-decoration" href="#可选参数">#</a> </h4>
<p>为使参数可选, 要么给签名的参数赋值为默认值：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-steak</span><span class="p">(</span><span class="nv">$how</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">medium</span><span class="p">&#39;)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I&#39;d like a steak, </span><span class="nv">$how</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="nf">order-steak</span><span class="p">();</span>
<span class="nf">order-steak</span><span class="p">(&#39;</span><span class="s1">well done</span><span class="p">&#39;);</span>
</code></pre></div><p>或者在参数名字的后面添加一个问号(?):</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-burger</span><span class="p">(</span><span class="nv">$type</span><span class="o">,</span> <span class="nv">$side</span><span class="o">?</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I&#39;d like a </span><span class="nv">$type</span><span class="s2"> burger</span><span class="p">&#34;</span> <span class="o">~</span>
    <span class="p">(</span> <span class="nb">defined</span><span class="p">(</span><span class="nv">$side</span><span class="p">)</span> <span class="o">??</span> <span class="p">&#34;</span><span class="s2"> with a side of </span><span class="nv">$side</span><span class="p">&#34;</span> <span class="o">!!</span> <span class="p">&#34;&#34;</span> <span class="p">);</span>
<span class="p">}</span>

<span class="nf">order-burger</span><span class="p">(&#34;</span><span class="s2">triple bacon</span><span class="p">&#34;</span><span class="o">,</span> <span class="p">&#34;</span><span class="s2">deep fried onion rings</span><span class="p">&#34;);</span>
</code></pre></div><p>如果没有参数被传递, 参数会被绑定成一个未定义的值。<code>defined(...)</code> 函数用来检查是否有值。</p>
<h4 id="强制参数">强制参数&nbsp;<a class="headline-hash no-text-decoration" href="#强制参数">#</a> </h4>
<p>默认地, 位置参数是必不可少的。然而, 你可以通过在参数后面追加一个感叹号来显式地指定该参数是必须的：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-drink</span><span class="p">(</span><span class="nv">$size</span><span class="o">,</span> <span class="nv">$flavor</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$size</span><span class="s2"> </span><span class="nv">$flavor</span><span class="s2">, coming right up!</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="nf">order-drink</span><span class="p">(&#39;</span><span class="s1">Large</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Mountain Dew</span><span class="p">&#39;);</span> <span class="c1"># OK</span>
<span class="nf">order-drink</span><span class="p">(&#39;</span><span class="s1">Small</span><span class="p">&#39;);</span>                 <span class="c1"># Error</span>
</code></pre></div><h4 id="具名实参和形参">具名实参和形参&nbsp;<a class="headline-hash no-text-decoration" href="#具名实参和形参">#</a> </h4>
<ul>
<li>arguments  实参</li>
<li>parameters 形参</li>
</ul>
<p>当一个子例程有很多参数时, 调用者很难记清传递参数的顺序。这种情况下, 通过名字传递参数往往更容易。这样, 参数出现的顺序就无关紧要了:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-beer</span><span class="p">(</span><span class="nv">$type</span><span class="o">,</span> <span class="nv">$pints</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">(</span><span class="nv">$pints</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">??</span> <span class="p">&#39;</span><span class="s1">A pint</span><span class="p">&#39;</span> <span class="o">!!</span> <span class="p">&#34;</span><span class="nv">$pints</span><span class="s2"> pints</span><span class="p">&#34;)</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2"> of </span><span class="nv">$type</span><span class="s2">, please.</span><span class="p">&#34;</span>
<span class="p">}</span>

<span class="nf">order-beer</span><span class="p">(</span><span class="s">type</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Hobgoblin</span><span class="p">&#39;</span>, <span class="s">pints</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1"># A pint of Hobgoblin, please.</span>

<span class="nf">order-beer</span><span class="p">(</span><span class="s">pints</span> <span class="o">=&gt;</span> <span class="mi">3</span>, <span class="s">type</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Zlatý Bažant</span><span class="p">&#39;);</span>
<span class="c1"># 3 pints of Zlatý Bažant, please.</span>
</code></pre></div><p>你也可以指定参数只能按名字被传递（这意味着它不允许按位置传递）。这样的话, 在参数名字前加一个冒号：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">order-shrimps</span><span class="p">(</span><span class="nv">$count</span><span class="o">,</span> <span class="o">:</span><span class="nv">$from</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Northern Sea</span><span class="p">&#39;)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I&#39;d like </span><span class="nv">$count</span><span class="s2"> pieces of shrimp from the </span><span class="nv">$from</span><span class="s2">, please</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="nf">order-shrimps</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="c1"># takes &#39;Northern Sea&#39;</span>
<span class="nf">order-shrimps</span><span class="p">(</span><span class="mi">4</span><span class="o">,</span> <span class="s">from</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Atlantic Ocean</span><span class="p">&#39;);</span>
<span class="nf">order-shrimps</span><span class="p">(</span><span class="mi">22</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Mediterranean Sea</span><span class="p">&#39;);</span>   <span class="c1"># 不允许, :$from is named only</span>
</code></pre></div><p>不像位置参数, 命名参数默认是可选的。在命名参数后面追加一个 <code>!</code> 号使命名参数强制性存在。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">design-ice-cream-mixture</span><span class="p">(</span><span class="nv">$base</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Vanilla</span><span class="p">&#39;</span><span class="o">,</span> <span class="o">:</span><span class="nv">$name</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Creating a new recipe named </span><span class="nv">$name</span><span class="s2">!</span><span class="p">&#34;</span>
<span class="p">}</span>

<span class="nf">design-ice-cream-mixture</span><span class="p">(</span><span class="s">name</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Plain</span><span class="p">&#39;);</span>
<span class="nf">design-ice-cream-mixture</span><span class="p">(</span><span class="s">base</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Strawberry chip</span><span class="p">&#39;);</span> <span class="c1"># 错误</span>,<span class="n">没有指定</span> <span class="nv">$name</span>
</code></pre></div><p><strong>重命名参数</strong></p>
<p>因为按名字传递实参给形参是合理的, 形参的名字应该应该作为子例程公共 API 的一部分被考虑在内. 小心地挑选它们吧! 有时候, 使用一个名字暴露形参而使用另外一个名字绑定到变量会很方便:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">announce-time</span><span class="p">(:</span><span class="s">dinner</span><span class="p">(</span><span class="nv">$supper</span><span class="p">)</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">8pm</span><span class="p">&#39;)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">We eat dinner at </span><span class="nv">$supper</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="nf">announce-time</span><span class="p">(</span><span class="s">dinner</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">9pm</span><span class="p">&#39;);</span> <span class="c1"># We eat dinner at 9pm</span>
</code></pre></div><p>参数可以有多个名字, 如果你的用户有些是英国人, 有些是美国人, 你可能这样写：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">paint-rectangle</span><span class="p">(</span>
    <span class="o">:</span><span class="nv">$x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">:</span><span class="nv">$y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">:</span><span class="nv">$width</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span>
    <span class="o">:</span><span class="nv">$height</span> <span class="o">=</span> <span class="mi">50</span><span class="o">,</span>
    <span class="p">:</span><span class="s">color</span><span class="p">(:</span><span class="s">colour</span><span class="p">(</span><span class="nv">$c</span><span class="p">)))</span> <span class="p">{</span>

    <span class="c1"># print a piece of SVG that represents a rectangle</span>
    <span class="nb">say</span> <span class="k">qq</span><span class="p">[</span><span class="s2">&lt;rect x=&#34;</span><span class="nv">$x</span><span class="s2">&#34; y=&#34;</span><span class="nv">$y</span><span class="s2">&#34; width=&#34;</span><span class="nv">$width</span><span class="s2">&#34; height=&#34;</span><span class="nv">$height</span><span class="s2">&#34; &gt;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># both calls work the same</span>
<span class="n">paint-rectangle</span> <span class="p">:</span><span class="s">color</span><span class="p">&lt;</span><span class="s">Blue</span><span class="p">&gt;;</span>
<span class="n">paint-rectangle</span> <span class="p">:</span><span class="s">colour</span><span class="p">&lt;</span><span class="s">Blue</span><span class="p">&gt;;</span>

<span class="c1"># of course you can still fill the other options</span>
<span class="n">paint-rectangle</span> <span class="p">:</span><span class="s">width</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">,</span> <span class="p">:</span><span class="s">height</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">,</span> <span class="p">:</span><span class="s">colour</span><span class="p">&lt;</span><span class="s">Blue</span><span class="p">&gt;;</span>
</code></pre></div><p><strong>可选的命名参数语法</strong></p>
<p>命名变量通常是成对的（键值对）。写一个 <code>Pairs</code> 有多种方式。各种方法的不同之处就是清晰性, 因为每种选择提供不同的引述机制。下面的三种调用是一样的意思：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nf">announce-time</span><span class="p">(</span><span class="s">dinner</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">9pm</span><span class="p">&#39;);</span>
<span class="nf">announce-time</span><span class="p">(:</span><span class="s">dinner</span><span class="p">(&#39;</span><span class="s1">9pm</span><span class="p">&#39;));</span>
<span class="nf">announce-time</span><span class="p">(:</span><span class="s">dinner</span><span class="p">&lt;</span><span class="s">9pm</span><span class="p">&gt;);</span>
</code></pre></div><p>如果传递的是布尔值, 你可以省略键值对的键值：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="nf">toggle-blender</span><span class="p">(</span> <span class="p">:</span><span class="s">enabled</span><span class="p">);</span> <span class="c1"># enables the blender 开启果汁机</span>
<span class="nf">toggle-blender</span><span class="p">(:!</span><span class="s">enabled</span><span class="p">);</span> <span class="c1"># disables the blender 关闭果汁机</span>
</code></pre></div><p>形如 <code>:name</code> 但不带值的命名参数有一个隐式的布尔真值 <code>Bool::True</code>。它的对立形式是 <code>:!name</code> , 其值是隐式的布尔假值 <code>Bool::false</code>。如果你使用变量创建了一个 <code>Pair</code>, 你可以将变量名作为 <code>Pair</code> 的键复用.</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">$dinner</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">9pm</span><span class="p">&#39;;</span>
<span class="n">announce-dinner</span> <span class="o">:</span><span class="nv">$dinner</span><span class="p">;</span> <span class="c1"># same as dinner =&gt; $dinner;</span>
</code></pre></div><pre><code>                        Pair forms and their meanings.

    Shorthand      Long form                          Description
:allowed           allowed =&gt; Bool::True               Boolean flag
:!allowed          allowed =&gt; Bool::False              Boolean flag
:bev&lt;tea coffee&gt;   bev =&gt; ('tea', 'coffee')            List
:times[1, 3]       times =&gt; [1, 3]                     Array
:opts{ a =&gt; 2 }    opts =&gt; { a =&gt; 2 }                  Hash
:$var              var =&gt; $var Scalar                  variable
:@var              var =&gt; @var Array                   variable
:%var              var =&gt; %var Hash                    variable
:&amp;var              vaf =&gt; &amp;var Callable/ Subroutine    variable
</code></pre>
<p>你可以使用在任何可以使用 Pair 对象的上下文使用表中的任意一种形式. 例如, 生成散列:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="c1"># TODO: better example</span>
<span class="k">my</span> <span class="nv">$black</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%color-popularities</span> <span class="o">=</span> <span class="o">:</span><span class="nv">$black</span><span class="o">,</span> <span class="p">:</span><span class="s">blue</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">,</span> <span class="s">red</span> <span class="o">=&gt;</span> <span class="mi">18</span>, <span class="p">:</span><span class="s">white</span><span class="p">&lt;</span><span class="s">0</span><span class="p">&gt;;</span>

<span class="c1"># 与此相同：</span>
<span class="c1"># my %color-popularities =</span>
<span class="c1"># black =&gt; 12,</span>
<span class="c1"># blue =&gt; 8,</span>
<span class="c1"># red =&gt; 18,</span>
<span class="c1"># white =&gt; 0;</span>
</code></pre></div><p>最后, 通过位置而非名字传递一个已存在的 Pair 对象到子例程中, 要么把它放在圆括号中 ( 就像 (<code>:$thing</code>) ), 或者使用 <code>=&gt;</code> 操作符引起左侧的字符串: <code>&quot;thing&quot; =&gt; $thing</code>。</p>
<p><strong>参数的顺序</strong></p>
<p>当位置参数和命名参数都出现在签名中时, 所有的位置参数都要出现在命名参数之前：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nb">mix</span><span class="p">(</span><span class="nv">@ingredients</span><span class="o">,</span> <span class="o">:</span><span class="nv">$name</span><span class="p">)</span>    <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="c1"># OK</span>
<span class="k">sub</span> <span class="nf">notmix</span><span class="p">(</span><span class="o">:</span><span class="nv">$name</span><span class="o">,</span> <span class="nv">@ingredients</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="c1"># Error</span>
</code></pre></div><p>必须的位置参数要在可选的位置参数之前。然而, 命名参数没有这种限制。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">copy-machine</span><span class="p">(</span><span class="nv">$amount</span><span class="o">,</span> <span class="nv">$size</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">A4</span><span class="p">&#39;</span><span class="o">,</span> <span class="o">:</span><span class="nv">$color</span><span class="o">!,</span> <span class="o">:</span><span class="nv">$quality</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="c1"># OK</span>
<span class="k">sub</span> <span class="nf">fax-machine</span><span class="p">(</span><span class="nv">$amount</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="nv">$number</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="c1"># Error</span>
</code></pre></div><h4 id="slurpy-参数">Slurpy 参数&nbsp;<a class="headline-hash no-text-decoration" href="#slurpy-参数">#</a> </h4>
<p>有时候, 你会希望让子例程接受任何数量的参数, 并且将所有这些参数收集到一个数组中。为了达到这个目的, 给签名添加一个数组参数, 就是在数组前添加一个 <code>*</code> 号前缀：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">shout-them</span><span class="p">(</span><span class="o">*</span><span class="nv">@words</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nv">@words</span> <span class="k">-&gt;</span> <span class="nv">$w</span> <span class="p">{</span>
        <span class="nb">print</span> <span class="nb">uc</span><span class="p">(&#34;</span><span class="nv">$w</span><span class="s2"> </span><span class="p">&#34;);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># 现在你可以传递项</span>
<span class="nf">shout-them</span><span class="p">(&#39;</span><span class="s1">go</span><span class="p">&#39;);</span>         <span class="c1"># GO</span>
<span class="nf">shout-them</span><span class="p">(&#39;</span><span class="s1">go</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">home</span><span class="p">&#39;);</span> <span class="c1"># GO HOME</span>
</code></pre></div><p>除了集合所有的值之外, slurpy 参数会展平任何它接收到的数组, 最后你只会得到一个展平的列表, 因此：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">@words</span> <span class="o">=</span> <span class="p">(&#39;</span><span class="s1">go</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">home</span><span class="p">&#39;);</span>
<span class="nf">shout-them</span><span class="p">(</span><span class="nv">@words</span><span class="p">);</span>
</code></pre></div><p>会导致 <code>*@words</code> 参数有两个字符串元素, 而非只有单个数组元素。</p>
<p>你可以选择将某些参数捕获到位置参数中, 并让其它参数被吸进数组参数里。这种情况下, <code>slupy</code> 应该放到最后。相似地, <code>*%hash</code> slurps 所有剩下的未绑定的命名参数到散列 <code>%hash</code> 中。<code>Slurpy</code> 数组和散列允许你传递所有的位置参数和命名参数到另一个子例程中。</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku">
<span class="k">sub</span> <span class="nf">debug-wrapper</span><span class="p">(</span><span class="nv">&amp;code</span><span class="o">,</span> <span class="o">*</span><span class="nv">@positional</span><span class="o">,</span> <span class="o">*</span><span class="nv">%named</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">warn</span> <span class="p">&#34;</span><span class="s2">Calling &#39;</span><span class="nv">&amp;code</span><span class="o">.</span><span class="nf">name</span><span class="p">()</span><span class="s2">&#39; with arguments </span><span class="p">&#34;</span>
    <span class="o">~</span> <span class="p">&#34;</span><span class="nv">@positional</span><span class="o">.</span><span class="nf">perl</span><span class="p">()</span><span class="s2">, </span><span class="nv">%named</span><span class="o">.</span><span class="nf">perl</span><span class="p">()</span><span class="s2">\n</span><span class="p">&#34;;</span>
    <span class="nb">code</span><span class="p">(</span><span class="o">|</span><span class="nv">@positional</span><span class="o">,</span> <span class="o">|</span><span class="nv">%named</span><span class="p">);</span>
    <span class="nb">warn</span> <span class="p">&#34;</span><span class="s2">... back from &#39;</span><span class="nv">&amp;code</span><span class="o">.</span><span class="nf">name</span><span class="p">()</span><span class="s2">&#39;\n</span><span class="p">&#34;;</span>
<span class="p">}</span>

<span class="nf">debug-wrapper</span><span class="p">(</span><span class="nv">&amp;order-shrimps</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="s">from</span> <span class="o">=&gt;</span> <span class="p">&#39;</span><span class="s1">Atlantic Ocean</span><span class="p">&#39;);</span>
</code></pre></div><h3 id="返回值">返回值&nbsp;<a class="headline-hash no-text-decoration" href="#返回值">#</a> </h3>
<p>子例程也能返回值。之前本章中的 ASCII 艺术舞蹈例子会更简单当每个子例程返回一个新字符串：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">%moves</span> <span class="o">=</span> <span class="s">hands-over-head</span> <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="k">return</span> <span class="p">&#39;</span><span class="s1">/o\ </span><span class="p">&#39;</span>   <span class="p">}</span>,
            <span class="s">bird-arms</span>       <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="k">return</span> <span class="p">&#39;</span><span class="s1">|/o\| </span><span class="p">&#39;</span> <span class="p">}</span>,
            <span class="s">left</span>            <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="k">return</span> <span class="p">&#39;</span><span class="s1">&gt;o </span><span class="p">&#39;</span>    <span class="p">}</span>,
            <span class="s">right</span>           <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="k">return</span> <span class="p">&#39;</span><span class="s1">o&lt; </span><span class="p">&#39;</span>    <span class="p">}</span>,
            <span class="s">arms-up</span>         <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span> <span class="k">return</span> <span class="p">&#39;</span><span class="s1">\o/ </span><span class="p">&#39;</span>   <span class="p">};</span>

<span class="k">my</span> <span class="nv">@awesome-dance</span> <span class="o">=</span> <span class="p">&lt;</span><span class="s">arms-up bird-arms right hands-over-head</span><span class="p">&gt;;</span>

<span class="k">for</span> <span class="nv">@awesome-dance</span> <span class="k">-&gt;</span> <span class="nv">$move</span> <span class="p">{</span>
    <span class="nb">print</span> <span class="nv">%moves</span><span class="p">{</span><span class="nv">$move</span><span class="p">}</span><span class="o">.</span><span class="p">();</span>
<span class="p">}</span>

<span class="nb">print</span> <span class="p">&#34;</span><span class="s2">\n</span><span class="p">&#34;;</span>
</code></pre></div><p>子例程也能返回多个值（译者注：那不就是返回一个列表嘛）：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">menu</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(&#39;</span><span class="s1">fish</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">white wine</span><span class="p">&#39;)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(&#39;</span><span class="s1">steak</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">red wine</span><span class="p">&#39;);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">my</span> <span class="p">(</span><span class="nv">$food</span><span class="o">,</span> <span class="nv">$beverage</span><span class="p">)</span> <span class="o">=</span> <span class="nf">menu</span><span class="p">();</span>
</code></pre></div><p>如果你把 return 语句排除在外, 则在子例程内部运行的最后一个语句产生的值被返回。这意味着前一个例子可以简化为：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">menu</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">{</span>
        <span class="p">&#39;</span><span class="s1">fish</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">white wine</span><span class="p">&#39;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="p">&#39;</span><span class="s1">steak</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">red wine</span><span class="p">&#39;;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">my</span> <span class="p">(</span><span class="nv">$food</span><span class="o">,</span> <span class="nv">$beverage</span><span class="p">)</span> <span class="o">=</span> <span class="nf">menu</span><span class="p">();</span>
</code></pre></div><p>记得：当子例程中的控制流极其复杂时, 添加一个显式的 return 会让代码更清晰, 所以 return 还是加上的好。
return 另外的副作用就是执行后立即退出子例程：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">create-world</span><span class="p">(</span><span class="o">*</span><span class="nv">%characteristics</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$world</span> <span class="o">=</span> <span class="n">World</span><span class="o">.</span><span class="nb">new</span><span class="p">(</span><span class="nv">%characteristics</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$world</span> <span class="k">if</span> <span class="nv">%characteristics</span><span class="p">&lt;</span><span class="s">temporary</span><span class="p">&gt;;</span>

    <span class="nf">save-world</span><span class="p">(</span><span class="nv">$world</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>&hellip;并且你最好别放错你的新单词 <code>$word</code> 如果它是临时的。因为这是你要获取的仅有的一个。</p>
<h3 id="返回值的类型">返回值的类型&nbsp;<a class="headline-hash no-text-decoration" href="#返回值的类型">#</a> </h3>
<p>像其它现代语言一样, Raku 允许你显式地指定子例程返回值的类型。这允许你限制从子例程中返回的值的类型。使用 <code>returns</code> 特性可以做到这样：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">double-up</span><span class="p">(</span><span class="nv">$i</span><span class="p">)</span> <span class="k">returns</span> <span class="nb">Int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nb">Int</span> <span class="nv">$ultimate-answer</span> <span class="o">=</span> <span class="nf">double-up</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span>  <span class="c1"># 42</span>
</code></pre></div><p>当然, 使用这个 <code>returns</code> 特性是可选的</p>
<h3 id="working-with-types">Working With Types&nbsp;<a class="headline-hash no-text-decoration" href="#working-with-types">#</a> </h3>
<p>很多子例程不能完整意义上使用任意参数工作, 但是要求参数支持确定的方法或有其它属性。这种情况下, 限制参数类型就有意义了, 诸如传递不正确值作为参数, 当调用子例程时, 这会引起 Raku 发出错误, 或者甚至在编译时, 如果编译器足够聪明来捕捉错误。</p>
<h4 id="基本类型">基本类型&nbsp;<a class="headline-hash no-text-decoration" href="#基本类型">#</a> </h4>
<p>最简单的限制子例程接收可能的值的方法是在参数前写上类型名。例如, 一个子例程对其参数执行数值计算, 这要求它的参数类型是 Numeric：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">mean</span><span class="p">(</span><span class="nb">Numeric</span> <span class="nv">$a</span><span class="o">,</span> <span class="nb">Numeric</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">say</span> <span class="n">mean</span> <span class="mf">2.5</span><span class="o">,</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="nb">say</span> <span class="n">mean</span> <span class="p">&#39;</span><span class="s1">some</span><span class="p">&#39;</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">strings</span><span class="p">&#39;;</span>
</code></pre></div><p>产生输出：</p>
<div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">Nominal type check failed for parameter &#39;$a&#39;;
expected Numeric but got Str instead
</code></pre></div><p>nominal 类型是一个人实际类型的名字, 这里是 Numeric。
如果多个参数有类型限制, 每个参数必须填充它绑定的参数限制的类型</p>
<h4 id="添加限制">添加限制&nbsp;<a class="headline-hash no-text-decoration" href="#添加限制">#</a> </h4>
<p>有时, 类型的名字不足以描述参数的要求。这种情况下, 你可能使用 <code>where</code> 代码块添加一个额外的限制：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">circle-radius-from-area</span><span class="p">(</span><span class="nb">Real</span> <span class="nv">$area</span> <span class="k">where</span> <span class="p">{</span> <span class="nv">$area</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">})</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">$area</span> <span class="o">/</span> <span class="no">pi</span><span class="p">)</span><span class="o">.</span><span class="nb">sqrt</span>
<span class="p">}</span>

<span class="nb">say</span> <span class="nf">circle-radius-from-area</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>  <span class="c1"># OK</span>
<span class="nb">say</span> <span class="nf">circle-radius-from-area</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span> <span class="c1"># Error</span>
</code></pre></div><p>因为这种计算只对非负面积值有意义, 该子例程的参数包含了一个限制, 对于非负值它会返回真。如果这个限制返回一个假的值, 类型检查会失败, 当有些东西调用该子例程时。</p>
<p>where 之后的代码块是可选的。Raku 通过通过智能匹配 where 后面的参数来执行检查。
例如, 它可能接受在某一确定范围中的参数：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">set-volume</span><span class="p">(</span><span class="nb">Numeric</span> <span class="nv">$volume</span> <span class="k">where</span> <span class="mi">0</span><span class="o">..</span><span class="mi">11</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Turning it up to </span><span class="nv">$volume</span><span class="p">&#34;;</span>
<span class="p">}</span>
</code></pre></div><p>或者你可以将参数限制为散列的键：</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">my</span> <span class="nv">%in-stock</span> <span class="o">=</span> <span class="p">&#39;</span><span class="s1">Staropramen</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">8</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">Mori</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="o">,</span> <span class="p">&#39;</span><span class="s1">La Trappe</span><span class="p">&#39;</span> <span class="o">=&gt;</span> <span class="mi">9</span><span class="p">;</span>

<span class="k">sub</span> <span class="nf">order-beer</span><span class="p">(</span><span class="nb">Str</span> <span class="nv">$name</span> <span class="k">where</span> <span class="nv">%in-stock</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Here&#39;s your </span><span class="nv">$name</span><span class="p">&#34;;</span>
    <span class="nv">%in-stock</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span><span class="o">--</span><span class="p">;</span>
    <span class="k">if</span> <span class="nv">%in-stock</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">OH NO! That was the last </span><span class="nv">$name</span><span class="s2">, folks! :&#39;(</span><span class="p">&#34;;</span>
        <span class="nv">%in-stock</span><span class="o">.</span><span class="nb">delete</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id="抽象参数和具体参数">抽象参数和具体参数&nbsp;<a class="headline-hash no-text-decoration" href="#抽象参数和具体参数">#</a> </h3>
<p>下面检测变量是否定义。在 Raku 中这样写:</p>
<div class="highlight"><pre class="chroma"><code class="language-perl" data-lang="perl"> <span class="k">sub</span> <span class="nf">foo</span><span class="p">(Int:D $arg) {</span>
     <span class="c1"># Do something</span>
 <span class="p">}</span>
</code></pre></div><p>留意附加在参数类型后面的 <code>:D</code> 笑脸。这个动词表明给定的参数必须被绑定到一个具体的对象上。如果不是的话, 会抛出一个运行时异常。这就是为什么它那么高兴！作为对比, 动词 <code>:U</code> 用于表明该参数需要一个未定义的或抽象的对象。此外, 动词 <code>:_</code> 允许定义或未定义的值。实际上, 使用 <code>:_</code> 有点多余。</p>
<p>最后, 动词 <code>:T</code> 能用于表明参数只能是类型对象, 例如</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">say-foobar</span><span class="p">(</span><span class="nb">Int</span><span class="p">:</span><span class="s">T</span> <span class="nv">$arg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">FOOBAR!</span><span class="p">&#39;;</span>
<span class="p">}</span>

<span class="nf">say-foobar</span><span class="p">(</span><span class="nb">Int</span><span class="p">);</span>
<span class="c1"># FOOBAR!</span>
</code></pre></div>

        </div>
    </div>
</article>



                <footer>
                    




<div class="no-text-decoration">
    <div class="jump top"><a href="#" title="Top of this page">⮉</a></div>
    <div class="jump bottom"><a href="#bottom" title="Bottom of this page">⮋</a></div>
</div>


 
    
        <div class="hugotoc no-text-decoration">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#第一章-概要">第一章 概要</a></li>
    <li><a href="#第二章-基础">第二章 基础</a>
      <ul>
        <li><a href="#练习">练习</a></li>
      </ul>
    </li>
    <li><a href="#第三章-操作符">第三章 操作符</a>
      <ul>
        <li><a href="#关于优先级的的一句话">关于优先级的的一句话</a></li>
        <li><a href="#比较和智能匹配">比较和智能匹配</a></li>
      </ul>
    </li>
    <li><a href="#第四章-子例程和签名">第四章 子例程和签名</a>
      <ul>
        <li><a href="#申明子例程">申明子例程</a></li>
        <li><a href="#adding-signatures">Adding Signatures</a></li>
        <li><a href="#返回值">返回值</a></li>
        <li><a href="#返回值的类型">返回值的类型</a></li>
        <li><a href="#working-with-types">Working With Types</a></li>
        <li><a href="#抽象参数和具体参数">抽象参数和具体参数</a></li>
      </ul>
    </li>
  </ul>
</nav>
            <a href="#" class="back-to-top">Back to top</a>
        </div>
    
    
<script src="/js/libs/jquery/3.3.1/jquery.slim.min.min.0ba8e190674d48a904a724830c26f36870743a24700151e5e415dbeb9bff8db3.js"></script>

<link rel="preload" href="/js/libs/jquery/3.3.1/jquery.slim.min.min.0ba8e190674d48a904a724830c26f36870743a24700151e5e415dbeb9bff8db3.js" as="script">

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6, .h-feed h2');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>








<div class="backtotop center no-text-decoration">
    <a href="#">back to <span class="top">top</span></a>
</div>


<div class="right">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 81 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 13 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>
<div class="clear-float"></div>



<div class="prev-next-navigator clear-float">
    
        <span class="prev-post left no-text-decoration">
            <a href="https://ohmyweekly.github.io/notes/2014-12-19-raku-calendar/" class="nobr">« Raku 圣诞月历 - 2014</a>
        </span>
    
    
        <span class="next-post right no-text-decoration">
            <a href="https://ohmyweekly.github.io/notes/2021-06-22-roles-or-when-one-is-many/" class="nobr">Roles or When One Is Many »</a>
        </span>
    
</div>


<a id="bottom"></a>









                       







                    <ul class="no-bullets feed right inline">
    
        
        
    
</ul>
<div class="clear-float"></div>

                </footer>
                <hr />
            </div>               

            <footer> 
                

<ul class="social no-text-decoration">
    
</ul>










 
    
    



<p class="generated no-text-decoration">
    Generated using  <a href="https://gitlab.com/kaushalmodi/hugo-theme-refined"><code class="nobr">hugo-theme-refined</code></a> + <span class="nobr">Hugo <a href="https://github.com/gohugoio/hugo/commit/724d5db5">0.85.0</a></span>
</p>

<p>
    
</p>




<div class="badges no-text-decoration">
    
    

    
</div>




<script type="application/javascript">var nav=responsiveNav("#nav");</script>




<script defer src="/js/libs/fragmentions/wrapper.min.bb9cba24742e67e37fba39db0232882a4017cc42418c890851b702c95d7b558c.js"></script>









            </footer>
        </div> 
    </body>
</html>
