{"author":{"name":null,"type":"card","url":"https://ohmyweekly.github.io/"},"content":{"html":"\u003cp\u003e欢迎来到 \u003cstrong\u003eRaku One-Liner Advent Calendar\u003c/strong\u003e 的第\u003ca href=\"https://raku.online/2018/12/03/generating-random-integers-in-perl-6/\"\u003e3\u003c/a\u003e天！ 今天，我们将生成随机数。\u003c/p\u003e\n\u003cp\u003e您可能会问，与它有什么关系，调用一种 \u003ccode\u003erand\u003c/code\u003e 函数不是常规任务吗？ 好吧，从某种意义上说，是的，但在Raku中，您可能更喜欢调用方法。\u003c/p\u003e\n\u003cp\u003e我们来看看\u003ca href=\"https://deeptext.media/calendar2019\"\u003eRaku日历\u003c/a\u003e中8月的代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mi\"\u003e2019\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esay\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这就是整个程序！ 它只使用方法调用，方法一个接一个地链接在一起。 如果您以前从未见过Raku，那么你首先注意到的是在一个数字上调用的方法。 在Raku中，这一点也不特别。\u003c/p\u003e\n\u003cp\u003e在数字上调用 \u003ccode\u003erand\u003c/code\u003e 方法可能是对 \u003ca href=\"https://github.com/rakudo/rakudo/blob/master/src/core/Cool.pm6\"\u003eCool类\u003c/a\u003e 中定义的方法的调用，该类立即代理给数字的数字表示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNum\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003erand\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e稍后在 \u003ca href=\"https://github.com/rakudo/rakudo/blob/master/src/core/Num.pm6\"\u003eNum类\u003c/a\u003e 中，会发生对底层 NQP 引擎的调用：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-raku\" data-lang=\"raku\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003emethod\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eNum\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s\"\u003eD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nf\"\u003enqp::p6box_n\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003enqp::rand_n\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003enqp::unbox_n\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在我们的示例中，对象 \u003ccode\u003e2019\u003c/code\u003e 是 \u003ccode\u003eInt\u003c/code\u003e，因此 \u003ccode\u003erand\u003c/code\u003e 被直接分派给 \u003ccode\u003eNum\u003c/code\u003e 类的方法。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003erand\u003c/code\u003e 方法返回一个浮点数，因此在其上调用 \u003ccode\u003eInt\u003c/code\u003e 来获取整数。\u003c/p\u003e\n\u003cp\u003e运行代码几次以确认它生成随机数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;2019.rand.Int.say\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e543\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;2019.rand.Int.say\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e1366\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;2019.rand.Int.say\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e1870\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果您想了解随机数生成器的质量，请深入挖掘 NQP 和 MoarVM，然后再深入了解虚拟机的后端引擎。 要使结果可重复（例如，对于测试），通过调用 \u003ccode\u003esrand\u003c/code\u003e 函数来设置种子：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;srand(10); 2019.rand.Int.say\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e296\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;srand(10); 2019.rand.Int.say\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e296\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e请注意，\u003ccode\u003esrand\u003c/code\u003e 例程是子例程，而不是方法。 它也在同一个 \u003ccode\u003eNum\u003c/code\u003e 类中定义：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-raku\" data-lang=\"raku\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eproto\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"nb\"\u003esrand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nv\"\u003e%\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003emulti\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"nb\"\u003esrand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eInt:D\u003c/span\u003e \u003cspan class=\"nv\"\u003e$seed\u003c/span\u003e \u003cspan class=\"k\"\u003e--\u0026gt;\u003c/span\u003e \u003cspan class=\"kt\"\u003eInt:D\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nf\"\u003enqp::p6box_i\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003enqp::srand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$seed\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果你有机会看到\u003ca href=\"https://github.com/rakudo/rakudo/blob/master/src/core/Num.pm6\"\u003e源文件\u003c/a\u003e，你很可能会注意到 \u003ccode\u003erand\u003c/code\u003e 还有一个独立的子例程：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-raku\" data-lang=\"raku\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eproto\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nv\"\u003e%\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003emulti\u003c/span\u003e \u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003e--\u0026gt;\u003c/span\u003e \u003cspan class=\"kt\"\u003eNum:D\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nf\"\u003enqp::p6box_n\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003enqp::rand_n\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e1e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e你只能在没有参数的情况下调用它，在这种情况下Raku会生成一个介于0和1之间的随机数。如果你传递参数，你会得到一个错误，说明方法调用更可取：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ raku -e\u003cspan class=\"s1\"\u003e\u0026#39;rand(20)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===\u003c/span\u003eSORRY!\u003cspan class=\"o\"\u003e===\u003c/span\u003e Error \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e compiling -e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUnsupported use of rand\u003cspan class=\"o\"\u003e(\u003c/span\u003eN\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e in Raku please use N.rand \u003cspan class=\"k\"\u003efor\u003c/span\u003e Num or \u003cspan class=\"o\"\u003e(\u003c/span\u003e^N\u003cspan class=\"o\"\u003e)\u003c/span\u003e.pick \u003cspan class=\"k\"\u003efor\u003c/span\u003e Int result\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eat -e:1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e------\u0026gt; rand⏏\u003cspan class=\"o\"\u003e(\u003c/span\u003e20\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e好吧，我们从最初的单行开始深度挖掘，所以让我们明天看与另一段令人敬畏的Raku代码！\u003c/p\u003e\n\u003cp\u003e原文： \u003ca href=\"https://raku.online/2018/12/03/generating-random-integers-in-perl-6/\"\u003ehttps://raku.online/2018/12/03/generating-random-integers-in-perl-6/\u003c/a\u003e\u003c/p\u003e\n","text":"欢迎来到 Raku One-Liner Advent Calendar 的第3天！ 今天，我们将生成随机数。\n您可能会问，与它有什么关系，调用一种 rand 函数不是常规任务吗？ 好吧，从某种意义上说，是的，但在Raku中，您可能更喜欢调用方法。\n我们来看看Raku日历中8月的代码：\n2019.rand.Int.say 这就是整个程序！ 它只使用方法调用，方法一个接一个地链接在一起。 如果您以前从未见过Raku，那么你首先注意到的是在一个数字上调用的方法。 在Raku中，这一点也不特别。\n在数字上调用 rand 方法可能是对 Cool类 中定义的方法的调用，该类立即代理给数字的数字表示：\nmethod rand() { self.Num.rand } 稍后在 Num类 中，会发生对底层 NQP 引擎的调用：\nmethod rand(Num:D: ) { nqp::p6box_n(nqp::rand_n(nqp::unbox_n(self))); } 在我们的示例中，对象 2019 是 Int，因此 rand 被直接分派给 Num 类的方法。\nrand 方法返回一个浮点数，因此在其上调用 Int 来获取整数。\n运行代码几次以确认它生成随机数：\n$ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 543 $ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 1366 $ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 1870 如果您想了解随机数生成器的质量，请深入挖掘 NQP 和 MoarVM，然后再深入了解虚拟机的后端引擎。 要使结果可重复（例如，对于测试），通过调用 srand 函数来设置种子：\n$ raku -e\u0026#39;srand(10); 2019.rand.Int.say\u0026#39; 296 $ raku -e\u0026#39;srand(10); 2019.rand.Int.say\u0026#39; 296 请注意，srand 例程是子例程，而不是方法。 它也在同一个 Num 类中定义：\nproto sub srand($, *%) {*} multi sub srand(Int:D $seed --\u0026gt; Int:D) { nqp::p6box_i(nqp::srand($seed)) } 如果你有机会看到源文件，你很可能会注意到 rand 还有一个独立的子例程：\nproto sub rand(*%) {*} multi sub rand(--\u0026gt; Num:D) { nqp::p6box_n(nqp::rand_n(1e0)) } 你只能在没有参数的情况下调用它，在这种情况下Raku会生成一个介于0和1之间的随机数。如果你传递参数，你会得到一个错误，说明方法调用更可取：\n$ raku -e\u0026#39;rand(20)\u0026#39; ===SORRY!=== Error while compiling -e Unsupported use of rand(N); in Raku please use N.rand for Num or (^N).pick for Int result at -e:1 ------\u0026gt; rand⏏(20) 好吧，我们从最初的单行开始深度挖掘，所以让我们明天看与另一段令人敬畏的Raku代码！\n原文： https://raku.online/2018/12/03/generating-random-integers-in-perl-6/\n"},"name":"🎄 3/25. 在 Raku 中生成随机整数","published":"2018-12-03T10:06:05Z","summary":"欢迎来到 Raku One-Liner Advent Calendar 的第3天！ 今天，我们将生成随机数。\n您可能会问，与它有什么关系，调用一种 rand 函数不是常规任务吗？ 好吧，从某种意义上说，是的，但在Raku中，您可能更喜欢调用方法。\n我们来看看Raku日历中8月的代码：\n2019.rand.Int.say 这就是整个程序！ 它只使用方法调用，方法一个接一个地链接在一起。 如果您以前从未见过Raku，那么你首先注意到的是在一个数字上调用的方法。 在Raku中，这一点也不特别。\n在数字上调用 rand 方法可能是对 Cool类 中定义的方法的调用，该类立即代理给数字的数字表示：\nmethod rand() { self.Num.rand } 稍后在 Num类 中，会发生对底层 NQP 引擎的调用：\nmethod rand(Num:D: ) { nqp::p6box_n(nqp::rand_n(nqp::unbox_n(self))); } 在我们的示例中，对象 2019 是 Int，因此 rand 被直接分派给 Num 类的方法。\nrand 方法返回一个浮点数，因此在其上调用 Int 来获取整数。\n运行代码几次以确认它生成随机数：\n$ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 543 $ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 1366 $ raku -e\u0026#39;2019.rand.Int.say\u0026#39; 1870 如果您想了解随机数生成器的质量，请深入挖掘 NQP 和 MoarVM，然后再深入了解虚拟机的后端引擎。 要使结果可重复（例如，对于测试），通过调用 srand 函数来设置种子：","type":"entry","url":"https://ohmyweekly.github.io/notes/generating-random-integers-in-raku/"}