<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">

    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    
    
    

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

    
    <meta name="referrer" content="no-referrer">

    <title>
        
            Guess Who ❚ 焉知非鱼
        
    </title>

    
    


    
    
    
    

    
    
    
    

    
    
    

    
    
    
    <style>
     
     
     :root {
         --theme-color: #ac4142;
         --theme-color-light: rgba(172, 65, 66, 0.2);
     }
     
     html {
         line-height: 1.5;
     }
    </style>

    
    

    
    
    
    
    <link rel="stylesheet" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css">
    
    <link rel="preload" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css" as="style">

    



    
        <style>
         
         /* Background */ .chroma { background-color: #ffffff }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
/* LineHighlight */ .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* LineNumbers */ .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

         
         /* Overrides on top of the theme and Chroma CSS */
/* Chroma-based lines highlighting in code blocks */
.chroma .hl {
    background-color: #e8e8e8;
    /* Extend highlight up to 100 characters (assuming that the code blocks never have more than 100 characters in a line) */
    min-width: 100ch;
}
/* GenericHeading */ .chroma .gh { color: #999999; font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa; font-weight: bold }

         
        </style>
    

    

    
    
    

    
    <script src="/js/responsive-nav-orig.min.bd7287557074084b7eba924cf5291f3c285cf8e8324c500f4389ff9fb1a92169.js"></script>
    
    <link rel="preload" href="/js/responsive-nav-orig.min.bd7287557074084b7eba924cf5291f3c285cf8e8324c500f4389ff9fb1a92169.js" as="script">

    
    
    <script defer src="/js/libs/fa/fontawesome-all.min.3ca622508ac5fb18aee4bc98a61b16f99348c918b1c684528246d1a95d82fd34.js"></script>
    
    <link rel="preload" href="/js/libs/fa/fontawesome-all.min.3ca622508ac5fb18aee4bc98a61b16f99348c918b1c684528246d1a95d82fd34.js" as="script">

    

    

    
    
    

    
    
<!-- rel="me" links for IndieAuth -->







    
 
<meta property="og:title" content="Guess Who" />
<meta property="og:description"
      content="Guess Who" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohmyweekly.github.io/notes/2015-11-20-guess-who/" />


    
        <meta property="article:published_time" content="2021-07-11T00:00:00&#43;08:00"/>
    
    
        <meta property="article:modified_time" content="2021-07-11T00:00:00&#43;08:00"/>
    









    




     <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Guess Who"/>
<meta name="twitter:description" content="Guess Who"/>


    
    
    <link rel="alternate" type="application/jf2post+json" href="https://ohmyweekly.github.io/notes/2015-11-20-guess-who/jf2post.json" title="Jf2post for 焉知非鱼" />
    
     



    
    
    
        
    


     
        
        <meta name="DC.Creator" content="焉知非鱼"/>
    



    
    
    
    <meta name="hugo-build-date" content="2021-07-05T10:46:28Z"/>
    <meta name="hugo-commit-hash" content="724d5db5"/>
    <meta name="generator" content="Hugo 0.85.0" />
</head>


    
        <body lang="en">
    

        
        <div class="border" id="home"></div>

        <div class="wrapper">   
            
<nav id="nav" class="nav-collapse opened" aria-hidden="false">
    <ul class="navbar">
        <li><a class="" href="/">Home</a></li>
        
            
                <li><a class="" href="https://ohmyweekly.github.io/posts/">Posts</a></li>
            
        
            
                <li><a class="" href="https://ohmyweekly.github.io/notes/">Notes</a></li>
            
        
        
            <li><a class="" href="https://ohmyweekly.github.io/search/">Search</a></li>
        
    </ul>
</nav>

            <div class="container">
                <header class="masthead">
                    <div class="masthead-title no-text-decoration">
                        <a href="/">焉知非鱼</a> <span class="blinking-cursor">❚</span>
                    </div>
                    <div class="masthead-tagline">
                        rakulang, dartlang, nimlang, golang, rustlang, lang lang no see
                    </div>
                </header>

                








<article class="post h-entry notes">
    <header>
        <div class="center">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 68 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 13 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>

        <h1 class="post-title p-name">Guess Who</h1>

        
        <data class="u-url" value="https://ohmyweekly.github.io/notes/2015-11-20-guess-who/"></data>

        <div class="date-syndication">
            


    
    
    <div class="post-date">
        
        <time datetime="2021-07-11T00:00:00+0800" class="dt-published">Sun Jul 11, 2021</time>
        
        
    </div>


            




        </div>
         



    
    
    
        
    


    
        
        <span class="hide">
            &mdash; <a href="https://ohmyweekly.github.io" class="u-author">焉知非鱼</a>
        </span>
    


    </header>

    <div class="content">
        
    <div class="description p-summary">
        
        
        
        
        
            
            
        
        <p>Guess Who</p>
    </div>



        





                       


        <div class="e-content">
            




<p>你是一个刚成立的小公司里的一名软件工程师, 有天晚上你收到了一封来自 CEO 的电子邮件:</p>
<blockquote>
<p>亲爱的工程师,</p>
<p>​    好新闻！看起来我们的网站越来越受欢迎。我们要变的有钱了! 每秒钟有成千上万的人在同时访问我们的网站, 而且还在快速增长。</p>
<p>我们必须立即识别出谁的通信量最大。幸运的是我的朋友给我发送了一份巨大的 IP 地址和名字的列表。很酷不是吗？你能写一段程序接收我们大量的访问者, 把它和地址/名字列表相比, 并创建一些统计吗？我的意思是, 生成一个国家的名字列表。</p>
<p>做好了的话我给你们开个披萨聚会。</p>
</blockquote>
<blockquote>
<p>邮件的附件文件包含了一个 IP 地址和名字的列表。写一个程序来统计下有多少 IP 访问了你的网站。</p>
</blockquote>
<h2 id="输入描述">输入描述&nbsp;<a class="headline-hash no-text-decoration" href="#输入描述">#</a> </h2>
<p>输入来自两部分。第一个是一个文本文件, 包含 IP 地址范围。每行一项,使用两个空格分割 IP 和名字。</p>
<p>第二个文件是一个 IP 地址的列表, 每行一个, 它们是必须被查询的IP。</p>
<h2 id="ip-输入样本">IP 输入样本&nbsp;<a class="headline-hash no-text-decoration" href="#ip-输入样本">#</a> </h2>
<p>输入是有包含两个 IP 地址和一个跟 IP 范围关联的名字的大量行组成。</p>
<pre><code>123.45.17.8 123.45.123.45 University of Vestige
123.50.1.1 123.50.10.1 National Center for Pointlessness
188.0.0.3 200.0.0.250 Mayo Tarkington
200.0.0.251 200.0.0.255 Daubs Haywire Committee
200.0.1.1 200.255.255.255 Geopolitical Encyclopedia
222.222.222.222 233.233.233.233 SAP Rostov
250.1.2.3 250.4.5.6 Shavian Refillable Committee
123.45.100.0 123.60.32.1 United Adverbs
190.0.0.1 201.1.1.1 Shavian Refillable Committee
238.0.0.1 254.1.2.3 National Center for Pointlessness
</code></pre><p>注意: 这些 IP 范围不能保证是 IPv4 &ldquo;子网&rdquo;。这意味着它们可能不能精确地由基于前缀的 CIDR 块来表示。</p>
<p>范围可以重叠。可能多余2层深。</p>
<p>可可有多个范围关联同一个名字。</p>
<h2 id="查询输入样本">查询输入样本&nbsp;<a class="headline-hash no-text-decoration" href="#查询输入样本">#</a> </h2>
<pre><code>250.1.3.4
123.50.1.20
189.133.73.57
123.50.1.21
250.1.2.4
123.50.1.21
250.1.3.100
250.1.3.5
188.0.0.5
123.50.1.100
123.50.2.34
123.50.1.100
123.51.100.52
127.0.0.1
123.50.1.22
123.50.1.21
188.0.0.5
123.45.101.100
123.45.31.52
230.230.230.230
</code></pre><h2 id="输出格式化">输出格式化&nbsp;<a class="headline-hash no-text-decoration" href="#输出格式化">#</a> </h2>
<p>倒序输出访问次数。</p>
<pre><code>8 - National Center for Pointlessness
4 - Shavian Refillable Committee
3 - Mayo Tarkington
2 - University of Vestige
1 - SAP Rostov
1 - United Adverbs
1 - &lt;unknown&gt;
</code></pre><h2 id="解释">解释&nbsp;<a class="headline-hash no-text-decoration" href="#解释">#</a> </h2>
<p>这儿是一个输入 IP 和它的名字的映射:</p>
<pre><code>National Center for Pointlessness
123.50.1.20
123.50.1.21
123.50.1.22
123.50.1.21
123.50.1.21
123.50.1.100
123.50.1.100
123.50.2.34

Shavian Refillable Committee
250.1.2.4
250.1.3.4
250.1.3.5
250.1.3.100

Mayo Tarkington
188.0.0.5
188.0.0.5
189.133.73.57

University of Vestige
123.45.101.100
123.45.31.52

SAP Rostov
230.230.230.230

United Adverbs
123.51.100.52

&lt;unknown&gt;
127.0.0.1
</code></pre><p>smls 的解决方法:</p>
<div class="highlight"><pre class="chroma"><code class="language-raku" data-lang="raku"><span class="k">sub</span> <span class="nf">ip-to-number</span> <span class="p">(</span><span class="nv">$ip</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">do</span> <span class="k">given</span> <span class="nv">$ip</span><span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1">.</span><span class="p">&#39;)</span> <span class="p">{</span>
        <span class="o">.[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+&lt;</span> <span class="mi">24</span> <span class="o">+</span>
        <span class="o">.[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+&lt;</span> <span class="mi">16</span> <span class="o">+</span>
        <span class="o">.[</span><span class="mi">2</span><span class="o">]</span> <span class="o">+&lt;</span>  <span class="mi">8</span> <span class="o">+</span>
        <span class="o">.[</span><span class="mi">3</span><span class="o">]</span> <span class="o">+&lt;</span>  <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">IntervalTree</span> <span class="p">{</span>
    <span class="k">has</span> <span class="nv">$.min</span><span class="p">;</span>
    <span class="k">has</span> <span class="nv">$.max</span><span class="p">;</span>
    <span class="k">has</span> <span class="nv">$!center</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$!min</span> <span class="o">+</span> <span class="nv">$!max</span><span class="p">)</span> <span class="ow">div</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">has</span> <span class="nv">@!intervals</span><span class="p">;</span>
    <span class="k">has</span> <span class="n">IntervalTree</span> <span class="nv">$!left</span><span class="p">;</span>
    <span class="k">has</span> <span class="n">IntervalTree</span> <span class="nv">$!right</span><span class="p">;</span>

    <span class="k">method</span> <span class="nb">new</span> <span class="p">(</span><span class="nv">$min</span><span class="o">,</span> <span class="nv">$max</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="nb">bless</span><span class="p">(</span><span class="o">:</span><span class="nv">$min</span><span class="o">,</span> <span class="o">:</span><span class="nv">$max</span><span class="p">)</span> <span class="p">}</span>

    <span class="k">method</span> <span class="nf">insert</span> <span class="p">(</span><span class="o">|</span><span class="n">c</span> <span class="p">(</span><span class="nv">$start</span><span class="o">,</span> <span class="nv">$end</span><span class="o">,</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nv">$end</span> <span class="o">&lt;</span> <span class="nv">$!center</span> <span class="ow">and</span> <span class="nv">$!min</span> <span class="o">&lt;</span> <span class="nv">$!center</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">{</span>
            <span class="p">(</span><span class="nv">$!left</span> <span class="o">//=</span> <span class="nb">self</span><span class="o">.</span><span class="nb">new</span><span class="p">(</span><span class="nv">$!min</span><span class="o">,</span> <span class="nv">$!center</span><span class="p">))</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="o">|</span><span class="n">c</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">elsif</span> <span class="nv">$start</span> <span class="o">&gt;</span> <span class="nv">$!center</span> <span class="ow">and</span> <span class="nv">$!max</span> <span class="o">&gt;</span> <span class="nv">$!center</span> <span class="p">{</span>
            <span class="p">(</span><span class="nv">$!right</span> <span class="o">//=</span> <span class="nb">self</span><span class="o">.</span><span class="nb">new</span><span class="p">(</span><span class="nv">$!center</span><span class="o">,</span> <span class="nv">$!max</span><span class="p">))</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="o">|</span><span class="n">c</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nv">@!intervals</span><span class="o">.</span><span class="nb">push</span><span class="o">:</span> <span class="o">[</span><span class="nv">$start</span><span class="o">,</span> <span class="nv">$end</span><span class="o">,</span> <span class="nv">$name</span><span class="o">,</span> <span class="nv">$end-$start</span><span class="o">]</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">method</span> <span class="nf">prepare</span> <span class="p">{</span>
        <span class="nv">@!intervals</span><span class="o">.=</span><span class="nb">sort</span><span class="p">(</span><span class="o">*[</span><span class="mi">3</span><span class="o">]</span><span class="p">);</span>
        <span class="nv">$!left</span> <span class="o">.</span><span class="nf">prepare</span> <span class="k">if</span> <span class="nv">$!left</span><span class="p">;</span>
        <span class="nv">$!right</span><span class="o">.</span><span class="nf">prepare</span> <span class="k">if</span> <span class="nv">$!right</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">method</span> <span class="nb">lookup</span> <span class="p">(</span><span class="nv">$n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">my</span> <span class="nv">$best</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">&lt;</span> <span class="nv">$!center</span> <span class="o">??</span> <span class="p">(</span><span class="nv">$!left</span> <span class="o">.</span><span class="nb">lookup</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$!left</span><span class="p">)</span>
                                  <span class="o">!!</span> <span class="p">(</span><span class="nv">$!right</span><span class="o">.</span><span class="nb">lookup</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$!right</span><span class="p">));</span>
        <span class="nv">$best</span> <span class="o">??</span> <span class="nv">@!intervals</span><span class="o">.</span><span class="nb">first</span><span class="p">({</span> <span class="k">return</span> <span class="nv">$best</span> <span class="k">if</span> <span class="o">.[</span><span class="mi">3</span><span class="o">]</span> <span class="o">&gt;</span> <span class="nv">$best</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
                                     <span class="o">.[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="nv">$n</span> <span class="o">&lt;=</span> <span class="o">.[</span><span class="mi">1</span><span class="o">]</span> <span class="p">})</span> <span class="o">//</span> <span class="nv">$best</span>
              <span class="o">!!</span> <span class="nv">@!intervals</span><span class="o">.</span><span class="nb">first</span><span class="p">({</span> <span class="o">.[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="nv">$n</span> <span class="o">&lt;=</span> <span class="o">.[</span><span class="mi">1</span><span class="o">]</span> <span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">sub</span> <span class="nb">MAIN</span> <span class="p">(</span><span class="nv">$ip-file</span><span class="o">,</span> <span class="nv">$query-file</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$index</span> <span class="o">=</span> <span class="n">IntervalTree</span><span class="o">.</span><span class="nb">new</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">ip-to-number</span> <span class="p">&#39;</span><span class="s1">255.255.255.255</span><span class="p">&#39;);</span>

    <span class="k">for</span> <span class="nv">$ip-file</span><span class="o">.</span><span class="nb">IO</span><span class="o">.</span><span class="nb">lines</span> <span class="p">{</span>
        <span class="k">my</span> <span class="p">(</span><span class="nv">$start</span><span class="o">,</span> <span class="nv">$end</span><span class="o">,</span> <span class="nv">$name</span><span class="p">)</span> <span class="o">=</span> <span class="o">.</span><span class="nb">split</span><span class="p">(&#39;</span><span class="s1"> </span><span class="p">&#39;</span><span class="o">,</span> <span class="mi">3</span><span class="p">);</span>
        <span class="nv">$index</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="nf">ip-to-number</span><span class="p">(</span><span class="nv">$start</span><span class="p">)</span><span class="o">,</span> <span class="nf">ip-to-number</span><span class="p">(</span><span class="nv">$end</span><span class="p">)</span><span class="o">,</span> <span class="nv">$name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nv">$index</span><span class="o">.</span><span class="nf">prepare</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="nv">$query-file</span><span class="o">.</span><span class="nb">IO</span><span class="o">.</span><span class="nb">lines</span> <span class="k">-&gt;</span> <span class="nv">$ip</span> <span class="p">{</span>
        <span class="k">my</span> <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$index</span><span class="o">.</span><span class="nb">lookup</span><span class="p">(</span><span class="n">ip-to-number</span> <span class="nv">$ip</span><span class="p">)</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
        <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$ip</span><span class="s2"> </span><span class="p">{</span><span class="nv">$name</span> <span class="o">//</span> <span class="p">&#39;</span><span class="s1">&lt;unknown&gt;</span><span class="p">&#39;}&#34;;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

        </div>
    </div>
</article>



                <footer>
                    




<div class="no-text-decoration">
    <div class="jump top"><a href="#" title="Top of this page">⮉</a></div>
    <div class="jump bottom"><a href="#bottom" title="Bottom of this page">⮋</a></div>
</div>


 
    
        <div class="hugotoc no-text-decoration">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#输入描述">输入描述</a></li>
    <li><a href="#ip-输入样本">IP 输入样本</a></li>
    <li><a href="#查询输入样本">查询输入样本</a></li>
    <li><a href="#输出格式化">输出格式化</a></li>
    <li><a href="#解释">解释</a></li>
  </ul>
</nav>
            <a href="#" class="back-to-top">Back to top</a>
        </div>
    
    
<script src="/js/libs/jquery/3.3.1/jquery.slim.min.min.0ba8e190674d48a904a724830c26f36870743a24700151e5e415dbeb9bff8db3.js"></script>

<link rel="preload" href="/js/libs/jquery/3.3.1/jquery.slim.min.min.0ba8e190674d48a904a724830c26f36870743a24700151e5e415dbeb9bff8db3.js" as="script">

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6, .h-feed h2');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>








<div class="backtotop center no-text-decoration">
    <a href="#">back to <span class="top">top</span></a>
</div>


<div class="right">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 68 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 13 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>
<div class="clear-float"></div>



<div class="prev-next-navigator clear-float">
    
        <span class="prev-post left no-text-decoration">
            <a href="https://ohmyweekly.github.io/notes/2016-02-03-comb-in-raku/" class="nobr">« comb - 操作字符串的利器</a>
        </span>
    
    
        <span class="next-post right no-text-decoration">
            <a href="https://ohmyweekly.github.io/notes/2015-06-10-list-in-raku/" class="nobr">List in Raku »</a>
        </span>
    
</div>


<a id="bottom"></a>









                       







                    <ul class="no-bullets feed right inline">
    
        
        
    
</ul>
<div class="clear-float"></div>

                </footer>
                <hr />
            </div>               

            <footer> 
                

<ul class="social no-text-decoration">
    
</ul>










 
    
    



<p class="generated no-text-decoration">
    Generated using  <a href="https://gitlab.com/kaushalmodi/hugo-theme-refined"><code class="nobr">hugo-theme-refined</code></a> + <span class="nobr">Hugo <a href="https://github.com/gohugoio/hugo/commit/724d5db5">0.85.0</a></span>
</p>

<p>
    
</p>




<div class="badges no-text-decoration">
    
    

    
</div>




<script type="application/javascript">var nav=responsiveNav("#nav");</script>




<script defer src="/js/libs/fragmentions/wrapper.min.bb9cba24742e67e37fba39db0232882a4017cc42418c890851b702c95d7b558c.js"></script>









            </footer>
        </div> 
    </body>
</html>
