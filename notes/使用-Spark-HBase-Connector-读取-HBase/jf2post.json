{"author":{"name":null,"type":"card","url":"https://ohmycloud.github.io/"},"content":{"html":"\u003cp\u003epom 依赖：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/com.hortonworks/shc-core --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ecom.hortonworks\u003cspan class=\"nt\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003eshc-core\u003cspan class=\"nt\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e1.1.1-2.1-s_2.11\u003cspan class=\"nt\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e部分代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"nn\"\u003exxxx.xxxx\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.log4j.\u003c/span\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"nc\"\u003eLevel\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eLogger\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.execution.datasources.hbase._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.functions._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.\u003c/span\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eSparkSession\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  * 提交方式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  * spark2-submit  --name HBASE-CONNECTOR --files /etc/hbase/conf/hbase-site.xml --class xxx.xxxx  --master yarn    --deploy-mode cluster  --driver-memory 2g    --driver-cores 2    --executor-memory 2g    --executor-cores 1    --num-executors 2 wmanxiety-1.0-SNAPSHOT.jar --day 20180810 --repartition 500 --interval 7\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eobject\u003c/span\u003e \u003cspan class=\"nc\"\u003eMileageAnxiety\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003ecat\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003es\u0026#34;\u0026#34;\u0026#34;{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;table\u0026#34;:{\u0026#34;namespace\u0026#34;:\u0026#34;default\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;trip_signal\u0026#34;, \u0026#34;tableCoder\u0026#34;:\u0026#34;PrimitiveType\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;rowkey\u0026#34;:\u0026#34;key\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;columns\u0026#34;:{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;rowkey\u0026#34;       :{\u0026#34;cf\u0026#34;:\u0026#34;rowkey\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;key\u0026#34;,            \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;vin\u0026#34;          :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;vin\u0026#34;,            \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;tripStatus\u0026#34;   :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;tripStatus\u0026#34;,     \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;tripStartTime\u0026#34;:{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;tripStartTime\u0026#34;,  \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;tripEndTime\u0026#34;  :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;tripEndTime\u0026#34;,    \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;tripDistance\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;tripDistance\u0026#34;,   \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;startSoc\u0026#34;     :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;startSoc\u0026#34;,       \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;endSoc\u0026#34;       :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;endSoc\u0026#34;,         \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;maxSpeed\u0026#34;     :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;maxSpeed\u0026#34;,       \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;startMileage\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;startMileage\u0026#34;,   \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;},\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |\u0026#34;coordinate\u0026#34;   :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;,   \u0026#34;col\u0026#34;:\u0026#34;coordinate\u0026#34;,     \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e               |}\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estripMargin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eArray\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e])\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eUnit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nc\"\u003eLogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetLogger\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;org\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003esetLevel\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eLevel\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eWARN\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eSparkSession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetClass\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetName\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emaster\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;local[2]\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetOrCreate\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003esc\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esparkContext\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esqlContext.implicits._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003ewithCatalog\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecat\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eDataFrame\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eHBaseTableCatalog\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etableCatalog\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ecat\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;org.apache.spark.sql.execution.datasources.hbase\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewithCatalog\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecat\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estop\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","text":"pom 依赖：\n\u0026lt;!-- https://mvnrepository.com/artifact/com.hortonworks/shc-core --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.hortonworks\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shc-core\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.1.1-2.1-s_2.11\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; 部分代码：\npackage xxxx.xxxx import org.apache.log4j.{Level, Logger} import org.apache.spark.sql.execution.datasources.hbase._ import org.apache.spark.sql.functions._ import org.apache.spark.sql.{DataFrame, SparkSession} /** * 提交方式 * spark2-submit --name HBASE-CONNECTOR --files /etc/hbase/conf/hbase-site.xml --class xxx.xxxx --master yarn --deploy-mode cluster --driver-memory 2g --driver-cores 2 --executor-memory 2g --executor-cores 1 --num-executors 2 wmanxiety-1.0-SNAPSHOT.jar --day 20180810 --repartition 500 --interval 7 */ object MileageAnxiety { def cat = s\u0026#34;\u0026#34;\u0026#34;{ |\u0026#34;table\u0026#34;:{\u0026#34;namespace\u0026#34;:\u0026#34;default\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;trip_signal\u0026#34;, \u0026#34;tableCoder\u0026#34;:\u0026#34;PrimitiveType\u0026#34;}, |\u0026#34;rowkey\u0026#34;:\u0026#34;key\u0026#34;, |\u0026#34;columns\u0026#34;:{ |\u0026#34;rowkey\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;rowkey\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;key\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;vin\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;vin\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripStatus\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripStatus\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripStartTime\u0026#34;:{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripStartTime\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripEndTime\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripEndTime\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripDistance\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripDistance\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;startSoc\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;startSoc\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;endSoc\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;endSoc\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;maxSpeed\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;maxSpeed\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;startMileage\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;startMileage\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;coordinate\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;coordinate\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;} |} |}\u0026#34;\u0026#34;\u0026#34;.stripMargin def main(args: Array[String]): Unit = { Logger.getLogger(\u0026#34;org\u0026#34;).setLevel(Level.WARN) val spark = SparkSession.builder() .appName(this.getClass.getName) .master(\u0026#34;local[2]\u0026#34;) .getOrCreate() val sc = spark.sparkContext val sqlContext = spark.sqlContext import sqlContext.implicits._ def withCatalog(cat: String): DataFrame = { sqlContext .read .options(Map(HBaseTableCatalog.tableCatalog -\u0026gt; cat)) .format(\u0026#34;org.apache.spark.sql.execution.datasources.hbase\u0026#34;) .load() } val df = withCatalog(cat) df.show() spark.stop() } } "},"name":"使用 Spark HBase Connector 读取 HBase","published":"2018-12-13T16:16:21Z","summary":"pom 依赖：\n\u0026lt;!-- https://mvnrepository.com/artifact/com.hortonworks/shc-core --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.hortonworks\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shc-core\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.1.1-2.1-s_2.11\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; 部分代码：\npackage xxxx.xxxx import org.apache.log4j.{Level, Logger} import org.apache.spark.sql.execution.datasources.hbase._ import org.apache.spark.sql.functions._ import org.apache.spark.sql.{DataFrame, SparkSession} /** * 提交方式 * spark2-submit --name HBASE-CONNECTOR --files /etc/hbase/conf/hbase-site.xml --class xxx.xxxx --master yarn --deploy-mode cluster --driver-memory 2g --driver-cores 2 --executor-memory 2g --executor-cores 1 --num-executors 2 wmanxiety-1.0-SNAPSHOT.jar --day 20180810 --repartition 500 --interval 7 */ object MileageAnxiety { def cat = s\u0026#34;\u0026#34;\u0026#34;{ |\u0026#34;table\u0026#34;:{\u0026#34;namespace\u0026#34;:\u0026#34;default\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;trip_signal\u0026#34;, \u0026#34;tableCoder\u0026#34;:\u0026#34;PrimitiveType\u0026#34;}, |\u0026#34;rowkey\u0026#34;:\u0026#34;key\u0026#34;, |\u0026#34;columns\u0026#34;:{ |\u0026#34;rowkey\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;rowkey\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;key\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;vin\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;vin\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripStatus\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripStatus\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripStartTime\u0026#34;:{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripStartTime\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripEndTime\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripEndTime\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;tripDistance\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;tripDistance\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;startSoc\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;startSoc\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;endSoc\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;endSoc\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;maxSpeed\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;maxSpeed\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;startMileage\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;startMileage\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;}, |\u0026#34;coordinate\u0026#34; :{\u0026#34;cf\u0026#34;:\u0026#34;info\u0026#34;, \u0026#34;col\u0026#34;:\u0026#34;coordinate\u0026#34;, \u0026#34;type\u0026#34;:\u0026#34;string\u0026#34;} |} |}\u0026#34;\u0026#34;\u0026#34;.","type":"entry","url":"https://ohmycloud.github.io/notes/%E4%BD%BF%E7%94%A8-spark-hbase-connector-%E8%AF%BB%E5%8F%96-hbase/"}