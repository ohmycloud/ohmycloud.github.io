{"author":{"name":null,"type":"card","url":"http://localhost:1313/"},"content":{"html":"\u003ch2 id=\"利用imagemagick给图片加水印\"\u003e利用ImageMagick给图片加水印\u003c/h2\u003e\n\u003cp\u003e水印可能是文字，也可能是网站的logo等。图片水印比较简单，就是把自己水印图标合成到原始图片上；文字水印中如果字符包含中文，处理就稍微麻烦一些。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e图片水印处理\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e假设把名为logo.gif的水印图标添加在原始图片（src.jpg）右下角，且水印的下边缘距原始图片10像素、右边缘距原始图片5像素。使用如下命令即可：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003econvert src.jpg logo.gif -gravity southeast -geometry +5+10 -composite dest.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003e文字水印处理\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果不含中文字符，可以直接通过convert draw text的方式将文字添加到图片，否则就需要使用其它的办法。命令行中不能包括中文字符，但是能通过读取文件的方式来操作，即先把中文信息保存到文本文件中。注意：文本文件的编码最好用UTF-8，同时也需要选取一个支持中文的字体。直接把文本文本中的信息输出到图片上使用命令mogrify，不过也可以使用convert命令把文本文件中的信息生成一个图片，然后再把图片合成到原始图片中。下面分别介绍这几种方法。\u003c/p\u003e\n\u003cp\u003e不含中文字符：例如把www.netingcn.com作为水印加上图片上，命令如下\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003econvert src.jpg -gravity southeast -fill black -pointsize 16 -draw \u0026#34;text 5,5 \u0026#39;http://www.netingcn.com\u0026#39;\u0026#34; dest-c.jpg\n\nmogrify -pointsize 16 -fill black -weight bolder -gravity southeast -annotate +5+5 \u0026#34;http://www.netingcn.com\u0026#34; src.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e说明：上述两条命令达到同样的结果，但是第一次命令可以保留原始图片，第二条是直接在原始图片上打上水印。\u003c/p\u003e\n\u003cp\u003e存在中文的情况：假设存有信息的文件叫t.txt，字体文件是msyh.ttf。\u003c/p\u003e\n\u003cp\u003e方法1：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e//把文件t.txt中的信息生成图片txt.png, -transparent white让图片的背景透明，-size x30设置图片的高度\nconvert -transparent white -font msyh.ttf -fill black -pointsize 24 label:@t.txt txt.png\n\n//把txt.png合成到src.jpg上\nconvert src.jpg txt.png -gravity southeast -geometry +10+5 -composite dest.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e方法2：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003econvert src.jpg -transparent white -font msyh.ttf -fill black -pointsize 24 -size x30 label:@t.txt -gravity southeast -geometry +10+5 -composite dest.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e方法3：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emogrify -font msyh.ttf -pointsize 24 -fill black -weight bolder -gravity southeast -annotate +20+20 @\u0026#34;t.txt\u0026#34; src.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e说明：上述第一、二种方法都有瑕疵，第二种背景不能变成透明，第一种虽然生成的图片可以透明，但是合成到原始图上效果不是很理想，第三种是完全透明的，所以推进用第三种方式来操作\u003c/p\u003e\n","text":"利用ImageMagick给图片加水印 水印可能是文字，也可能是网站的logo等。图片水印比较简单，就是把自己水印图标合成到原始图片上；文字水印中如果字符包含中文，处理就稍微麻烦一些。\n图片水印处理 假设把名为logo.gif的水印图标添加在原始图片（src.jpg）右下角，且水印的下边缘距原始图片10像素、右边缘距原始图片5像素。使用如下命令即可：\nconvert src.jpg logo.gif -gravity southeast -geometry +5+10 -composite dest.jpg 文字水印处理 如果不含中文字符，可以直接通过convert draw text的方式将文字添加到图片，否则就需要使用其它的办法。命令行中不能包括中文字符，但是能通过读取文件的方式来操作，即先把中文信息保存到文本文件中。注意：文本文件的编码最好用UTF-8，同时也需要选取一个支持中文的字体。直接把文本文本中的信息输出到图片上使用命令mogrify，不过也可以使用convert命令把文本文件中的信息生成一个图片，然后再把图片合成到原始图片中。下面分别介绍这几种方法。\n不含中文字符：例如把www.netingcn.com作为水印加上图片上，命令如下\nconvert src.jpg -gravity southeast -fill black -pointsize 16 -draw \u0026#34;text 5,5 \u0026#39;http://www.netingcn.com\u0026#39;\u0026#34; dest-c.jpg mogrify -pointsize 16 -fill black -weight bolder -gravity southeast -annotate +5+5 \u0026#34;http://www.netingcn.com\u0026#34; src.jpg 说明：上述两条命令达到同样的结果，但是第一次命令可以保留原始图片，第二条是直接在原始图片上打上水印。\n存在中文的情况：假设存有信息的文件叫t.txt，字体文件是msyh.ttf。\n方法1：\n//把文件t.txt中的信息生成图片txt.png, -transparent white让图片的背景透明，-size x30设置图片的高度 convert -transparent white -font msyh.ttf -fill black -pointsize 24 label:@t.txt txt.png //把txt.png合成到src.jpg上 convert src.jpg txt.png -gravity southeast -geometry +10+5 -composite dest.jpg 方法2：\nconvert src.jpg -transparent white -font msyh.ttf -fill black -pointsize 24 -size x30 label:@t.txt -gravity southeast -geometry +10+5 -composite dest.jpg 方法3：\nmogrify -font msyh.ttf -pointsize 24 -fill black -weight bolder -gravity southeast -annotate +20+20 @\u0026#34;t.txt\u0026#34; src.jpg 说明：上述第一、二种方法都有瑕疵，第二种背景不能变成透明，第一种虽然生成的图片可以透明，但是合成到原始图上效果不是很理想，第三种是完全透明的，所以推进用第三种方式来操作\n"},"name":"ImageMagick - 给图片加水印","published":"2011-06-22T16:16:21Z","summary":"ImageMagick","type":"entry","url":"http://localhost:1313/notes/%E5%88%A9%E7%94%A8imagemagick%E7%BB%99%E5%9B%BE%E7%89%87%E5%8A%A0%E6%B0%B4%E5%8D%B0/"}