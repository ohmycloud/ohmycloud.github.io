{"author":{"name":null,"type":"card","url":"http://localhost:1313/"},"content":{"html":"\u003ch2 id=\"producer\"\u003eProducer\u003c/h2\u003e\n\u003cp\u003e发送 JSON 数据到 Kafka：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efrom confluent_kafka import Producer\n\np = Producer({\u0026#39;bootstrap.servers\u0026#39;: \u0026#39;localhost:9092\u0026#39;})\n\ndef delivery_report(err, msg):\n    \u0026#34;\u0026#34;\u0026#34; Called once for each message produced to indicate delivery result.\n        Triggered by poll() or flush(). \u0026#34;\u0026#34;\u0026#34;\n    if err is not None:\n        print(\u0026#39;Message delivery failed: {}\u0026#39;.format(err))\n    else:\n        print(\u0026#39;Message delivered to {} [{}]\u0026#39;.format(msg.topic(), msg.partition()))\n\nwith open(\u0026#34;/Users/ohmycloud/bigdata/Spark/camelia.json\u0026#34;) as f:\n  data = f.read()\n  p.poll(0)\n  p.produce(\u0026#39;net-logs\u0026#39;, data.encode(\u0026#39;utf-8\u0026#39;), callback=delivery_report)\n\np.flush()\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ca href=\"https://developers.nest.com/documentation/api-reference\"\u003eJSON\u003c/a\u003e 数据内容如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e{\n    \u0026#34;metadata\u0026#34;:{\n        \u0026#34;access_token\u0026#34;:\u0026#34;c.FmDPkzyzaQe...\u0026#34;,\n        \u0026#34;client_version\u0026#34;:1\n    },\n    \u0026#34;devices\u0026#34;:{\n        \u0026#34;thermostats\u0026#34;:{\n            \u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;:{\n                \u0026#34;device_id\u0026#34;:\u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;,\n                \u0026#34;locale\u0026#34;:\u0026#34;en-US\u0026#34;,\n                \u0026#34;software_version\u0026#34;:\u0026#34;4.0\u0026#34;,\n                \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;,\n                \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;,\n                \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Thermostat (upstairs)\u0026#34;,\n                \u0026#34;last_connection\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n                \u0026#34;is_online\u0026#34;:true,\n                \u0026#34;can_cool\u0026#34;:true,\n                \u0026#34;can_heat\u0026#34;:true,\n                \u0026#34;is_using_emergency_heat\u0026#34;:true,\n                \u0026#34;has_fan\u0026#34;:true,\n                \u0026#34;fan_timer_active\u0026#34;:true,\n                \u0026#34;fan_timer_timeout\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n                \u0026#34;has_leaf\u0026#34;:true,\n                \u0026#34;temperature_scale\u0026#34;:\u0026#34;C\u0026#34;,\n                \u0026#34;target_temperature_f\u0026#34;:72,\n                \u0026#34;target_temperature_c\u0026#34;:21.5,\n                \u0026#34;target_temperature_high_f\u0026#34;:80,\n                \u0026#34;target_temperature_high_c\u0026#34;:24.5,\n                \u0026#34;target_temperature_low_f\u0026#34;:65,\n                \u0026#34;target_temperature_low_c\u0026#34;:19.5,\n                \u0026#34;eco_temperature_high_f\u0026#34;:80,\n                \u0026#34;eco_temperature_high_c\u0026#34;:24.5,\n                \u0026#34;eco_temperature_low_f\u0026#34;:65,\n                \u0026#34;eco_temperature_low_c\u0026#34;:19.5,\n                \u0026#34;away_temperature_high_f\u0026#34;:80,\n                \u0026#34;away_temperature_high_c\u0026#34;:24.5,\n                \u0026#34;away_temperature_low_f\u0026#34;:65,\n                \u0026#34;away_temperature_low_c\u0026#34;:19.5,\n                \u0026#34;hvac_mode\u0026#34;:\u0026#34;heat\u0026#34;,\n                \u0026#34;previous_hvac_mode\u0026#34;:\u0026#34;heat\u0026#34;,\n                \u0026#34;ambient_temperature_f\u0026#34;:72,\n                \u0026#34;ambient_temperature_c\u0026#34;:21.5,\n                \u0026#34;humidity\u0026#34;:40,\n                \u0026#34;hvac_state\u0026#34;:\u0026#34;heating\u0026#34;,\n                \u0026#34;where_id\u0026#34;:\u0026#34;UNCBGUnN24...\u0026#34;,\n                \u0026#34;is_locked\u0026#34;:true,\n                \u0026#34;locked_temp_min_f\u0026#34;:65,\n                \u0026#34;locked_temp_max_f\u0026#34;:80,\n                \u0026#34;locked_temp_min_c\u0026#34;:19.5,\n                \u0026#34;locked_temp_max_c\u0026#34;:24.5,\n                \u0026#34;label\u0026#34;:\u0026#34;Pat\u0026#39;s room\u0026#34;,\n                \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34;,\n                \u0026#34;sunlight_correction_enabled\u0026#34;:true,\n                \u0026#34;sunlight_correction_active\u0026#34;:true,\n                \u0026#34;fan_timer_duration\u0026#34;:\u0026#34;15\u0026#34;,\n                \u0026#34;time_to_target\u0026#34;:\u0026#34;~15\u0026#34;,\n                \u0026#34;time_to_target_training\u0026#34;:\u0026#34;training\u0026#34;\n            }\n        },\n        \u0026#34;smoke_co_alarms\u0026#34;:{\n            \u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;:{\n                \u0026#34;device_id\u0026#34;:\u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;,\n                \u0026#34;locale\u0026#34;:\u0026#34;en-US\u0026#34;,\n                \u0026#34;software_version\u0026#34;:\u0026#34;1.01\u0026#34;,\n                \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;,\n                \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;,\n                \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Protect (upstairs)\u0026#34;,\n                \u0026#34;last_connection\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n                \u0026#34;is_online\u0026#34;:true,\n                \u0026#34;battery_health\u0026#34;:\u0026#34;ok\u0026#34;,\n                \u0026#34;co_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;,\n                \u0026#34;smoke_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;,\n                \u0026#34;is_manual_test_active\u0026#34;:true,\n                \u0026#34;last_manual_test_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n                \u0026#34;ui_color_state\u0026#34;:\u0026#34;gray\u0026#34;,\n                \u0026#34;where_id\u0026#34;:\u0026#34;UNCBGUnN24...\u0026#34;,\n                \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34;\n            }\n        },\n        \u0026#34;cameras\u0026#34;:{\n            \u0026#34;awJo6rH0IldT2YlIVtYaGQ\u0026#34;:{\n                \u0026#34;device_id\u0026#34;:\u0026#34;awJo6rH...\u0026#34;,\n                \u0026#34;software_version\u0026#34;:\u0026#34;4.0\u0026#34;,\n                \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;,\n                \u0026#34;where_id\u0026#34;:\u0026#34;d6reb_OZTM...\u0026#34;,\n                \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34;,\n                \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;,\n                \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Camera (upstairs)\u0026#34;,\n                \u0026#34;is_online\u0026#34;:true,\n                \u0026#34;is_streaming\u0026#34;:true,\n                \u0026#34;is_audio_input_enabled\u0026#34;:true,\n                \u0026#34;last_is_online_change\u0026#34;:\u0026#34;2016-12-29T18:42:00.000Z\u0026#34;,\n                \u0026#34;is_video_history_enabled\u0026#34;:true,\n                \u0026#34;web_url\u0026#34;:\u0026#34;https://home.nest.com/cameras/device_id?auth=access_token\u0026#34;,\n                \u0026#34;app_url\u0026#34;:\u0026#34;nestmobile://cameras/device_id?auth=access_token\u0026#34;,\n                \u0026#34;is_public_share_enabled\u0026#34;:true,\n                \u0026#34;activity_zones\u0026#34;:[\n                    {\n                        \u0026#34;name\u0026#34;:\u0026#34;Walkway\u0026#34;,\n                        \u0026#34;id\u0026#34;:\u0026#34;244083\u0026#34;\n                    },\n                    {\n                        \u0026#34;name\u0026#34;:\u0026#34;Walkway2\u0026#34;,\n                        \u0026#34;id2\u0026#34;:\u0026#34;244084\u0026#34;\n                    }\n                ],\n                \u0026#34;public_share_url\u0026#34;:\u0026#34;https://video.nest.com/live/STRING1?STRING2\u0026#34;,\n                \u0026#34;snapshot_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;,\n                \u0026#34;last_event\u0026#34;:{\n                    \u0026#34;has_sound\u0026#34;:true,\n                    \u0026#34;has_motion\u0026#34;:true,\n                    \u0026#34;has_person\u0026#34;:true,\n                    \u0026#34;start_time\u0026#34;:\u0026#34;2016-12-29T00:00:00.000Z\u0026#34;,\n                    \u0026#34;end_time\u0026#34;:\u0026#34;2016-12-29T18:42:00.000Z\u0026#34;,\n                    \u0026#34;urls_expire_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n                    \u0026#34;web_url\u0026#34;:\u0026#34;https://home.nest.com/cameras/device_id/cuepoints/STRING?auth=access_token\u0026#34;,\n                    \u0026#34;app_url\u0026#34;:\u0026#34;nestmobile://cameras/device_id/cuepoints/STRING?auth=access_token\u0026#34;,\n                    \u0026#34;image_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;,\n                    \u0026#34;animated_image_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;,\n                    \u0026#34;activity_zone_ids\u0026#34;:[\n                        \u0026#34;244083\u0026#34;,\n                        \u0026#34;244084\u0026#34;\n                    ]\n                }\n            }\n        }\n    },\n    \u0026#34;structures\u0026#34;:{\n        \u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;:{\n            \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;,\n            \u0026#34;thermostats\u0026#34;:[\n                \u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;,\n                \u0026#34;ggfgfdgrgrgg\u0026#34;\n            ],\n            \u0026#34;smoke_co_alarms\u0026#34;:[\n                \u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;,\n                \u0026#34;ddddddddddd\u0026#34;\n            ],\n            \u0026#34;cameras\u0026#34;:[\n                \u0026#34;awJo6r...\u0026#34;,\n                \u0026#34;ddddddssssssss\u0026#34;\n            ],\n            \u0026#34;away\u0026#34;:\u0026#34;home\u0026#34;,\n            \u0026#34;name\u0026#34;:\u0026#34;Home\u0026#34;,\n            \u0026#34;country_code\u0026#34;:\u0026#34;US\u0026#34;,\n            \u0026#34;postal_code\u0026#34;:\u0026#34;94304\u0026#34;,\n            \u0026#34;peak_period_start_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n            \u0026#34;peak_period_end_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;,\n            \u0026#34;time_zone\u0026#34;:\u0026#34;America/Los_Angeles\u0026#34;,\n            \u0026#34;eta\u0026#34;:{\n                \u0026#34;trip_id\u0026#34;:\u0026#34;myTripHome1024\u0026#34;,\n                \u0026#34;estimated_arrival_window_begin\u0026#34;:\u0026#34;2016-10-31T22:42:59.000Z\u0026#34;,\n                \u0026#34;estimated_arrival_window_end\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;\n            },\n            \u0026#34;eta_begin\u0026#34;:\u0026#34;2016-08-04T13:21:37-07:00\u0026#34;,\n            \u0026#34;co_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;,\n            \u0026#34;smoke_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;,\n            \u0026#34;rhr_enrollment\u0026#34;:true,\n            \u0026#34;wwn_security_state\u0026#34;:\u0026#34;ok\u0026#34;,\n            \u0026#34;wheres\u0026#34;:{\n                \u0026#34;Fqp6wJI...\u0026#34;:{\n                    \u0026#34;where_id\u0026#34;:\u0026#34;Fqp6wJI...\u0026#34;,\n                    \u0026#34;name\u0026#34;:\u0026#34;Bedroom\u0026#34;\n                }\n            }\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"代码\"\u003e代码\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003epackage wmdevice\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.streaming.OutputMode\nimport org.apache.spark.sql.types._\n\nobject CamerasStructedStreaming {\n  def main(args: Array[String]) {\n\n    val spark = SparkSession\n      .builder\n      .appName(\u0026#34;Camelia\u0026#34;)\n      .master(\u0026#34;local[*]\u0026#34;)\n      .getOrCreate()\n\n    val schema = new StructType()\n      .add(\u0026#34;metadata\u0026#34;, new StructType()\n        .add(\u0026#34;access_token\u0026#34;, StringType)\n        .add(\u0026#34;client_version\u0026#34;, IntegerType))\n      .add(\u0026#34;devices\u0026#34;, new StructType()\n        .add(\u0026#34;thermostats\u0026#34;, MapType(StringType, new StructType()\n          .add(\u0026#34;device_id\u0026#34;, StringType)\n          .add(\u0026#34;locale\u0026#34;, StringType)\n          .add(\u0026#34;software_version\u0026#34;, StringType)\n          .add(\u0026#34;structure_id\u0026#34;, StringType)\n          .add(\u0026#34;name\u0026#34;, StringType)\n          .add(\u0026#34;name_long\u0026#34;, StringType)\n          .add(\u0026#34;last_connection\u0026#34;, TimestampType)\n          .add(\u0026#34;is_online\u0026#34;, BooleanType)\n          .add(\u0026#34;can_cool\u0026#34;, BooleanType)\n          .add(\u0026#34;can_heat\u0026#34;, BooleanType)\n          .add(\u0026#34;is_using_emergency_heat\u0026#34;, BooleanType)\n          .add(\u0026#34;has_fan\u0026#34;, BooleanType)\n          .add(\u0026#34;fan_timer_active\u0026#34;, BooleanType)\n          .add(\u0026#34;fan_timer_timeout\u0026#34;, TimestampType)\n          .add(\u0026#34;has_leaf\u0026#34;, BooleanType)\n          .add(\u0026#34;temperature_scale\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_f\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_c\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_high_f\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_high_c\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_low_f\u0026#34;, StringType)\n          .add(\u0026#34;target_temperature_low_c\u0026#34;, StringType)\n          .add(\u0026#34;eco_temperature_high_f\u0026#34;, StringType)\n          .add(\u0026#34;eco_temperature_high_c\u0026#34;, StringType)\n          .add(\u0026#34;eco_temperature_low_f\u0026#34;, StringType)\n          .add(\u0026#34;eco_temperature_low_c\u0026#34;, StringType)\n          .add(\u0026#34;away_temperature_high_f\u0026#34;, StringType)\n          .add(\u0026#34;away_temperature_high_c\u0026#34;, StringType)\n          .add(\u0026#34;away_temperature_low_f\u0026#34;, StringType)\n          .add(\u0026#34;away_temperature_low_c\u0026#34;, StringType)\n          .add(\u0026#34;hvac_mode\u0026#34;, StringType)\n          .add(\u0026#34;previous_hvac_mode\u0026#34;, StringType)\n          .add(\u0026#34;ambient_temperature_f\u0026#34;, StringType)\n          .add(\u0026#34;ambient_temperature_c\u0026#34;, StringType)\n          .add(\u0026#34;humidity\u0026#34;, StringType)\n          .add(\u0026#34;hvac_state\u0026#34;, StringType)\n          .add(\u0026#34;where_id\u0026#34;, StringType)\n          .add(\u0026#34;is_locked\u0026#34;, BooleanType)\n          .add(\u0026#34;locked_temp_min_f\u0026#34;, StringType)\n          .add(\u0026#34;locked_temp_max_f\u0026#34;, StringType)\n          .add(\u0026#34;locked_temp_min_c\u0026#34;, StringType)\n          .add(\u0026#34;locked_temp_max_c\u0026#34;, StringType)\n          .add(\u0026#34;label\u0026#34;, StringType)\n          .add(\u0026#34;where_name\u0026#34;, StringType)\n          .add(\u0026#34;sunlight_correction_enabled\u0026#34;, BooleanType)\n          .add(\u0026#34;sunlight_correction_active\u0026#34;, BooleanType)\n          .add(\u0026#34;fan_timer_duration\u0026#34;, StringType)\n          .add(\u0026#34;time_to_target\u0026#34;, StringType)\n          .add(\u0026#34;time_to_target_training\u0026#34;, StringType))\n        )\n        .add(\u0026#34;smoke_co_alarms\u0026#34;, MapType(StringType, new StructType()\n          .add(\u0026#34;device_id\u0026#34;, StringType)\n          .add(\u0026#34;locale\u0026#34;, StringType)\n          .add(\u0026#34;software_version\u0026#34;, StringType)\n          .add(\u0026#34;structure_id\u0026#34;, StringType)\n          .add(\u0026#34;name\u0026#34;, StringType)\n          .add(\u0026#34;name_long\u0026#34;, StringType)\n          .add(\u0026#34;last_connection\u0026#34;, TimestampType)\n          .add(\u0026#34;is_online\u0026#34;, BooleanType)\n          .add(\u0026#34;battery_health\u0026#34;, StringType)\n          .add(\u0026#34;co_alarm_state\u0026#34;, StringType)\n          .add(\u0026#34;smoke_alarm_state\u0026#34;, StringType)\n          .add(\u0026#34;is_manual_test_active\u0026#34;, BooleanType)\n          .add(\u0026#34;last_manual_test_time\u0026#34;, TimestampType)\n          .add(\u0026#34;ui_color_state\u0026#34;, StringType)\n          .add(\u0026#34;where_id\u0026#34;, StringType)\n          .add(\u0026#34;where_name\u0026#34;, StringType))\n        )\n        .add(\u0026#34;cameras\u0026#34;, MapType(StringType, new StructType()\n          .add(\u0026#34;device_id\u0026#34;, StringType)\n          .add(\u0026#34;software_version\u0026#34;, StringType)\n          .add(\u0026#34;structure_id\u0026#34;, StringType)\n          .add(\u0026#34;where_id\u0026#34;, StringType)\n          .add(\u0026#34;where_name\u0026#34;, StringType)\n          .add(\u0026#34;name\u0026#34;, StringType)\n          .add(\u0026#34;name_long\u0026#34;, StringType)\n          .add(\u0026#34;is_online\u0026#34;, BooleanType)\n          .add(\u0026#34;is_streaming\u0026#34;, BooleanType)\n          .add(\u0026#34;is_audio_input_enabled\u0026#34;, BooleanType)\n          .add(\u0026#34;last_is_online_change\u0026#34;, TimestampType)\n          .add(\u0026#34;is_video_history_enabled\u0026#34;, BooleanType)\n          .add(\u0026#34;web_url\u0026#34;, StringType)\n          .add(\u0026#34;app_url\u0026#34;, StringType)\n          .add(\u0026#34;is_public_share_enabled\u0026#34;, BooleanType)\n          .add(\u0026#34;activity_zones\u0026#34;, ArrayType(new StructType().add(\u0026#34;name\u0026#34;, StringType).add(\u0026#34;id\u0026#34;, StringType), true))\n          .add(\u0026#34;public_share_url\u0026#34;, StringType)\n          .add(\u0026#34;snapshot_url\u0026#34;, StringType)\n            .add(\u0026#34;last_event\u0026#34;, new StructType()\n              .add(\u0026#34;has_sound\u0026#34;, BooleanType)\n              .add(\u0026#34;has_motion\u0026#34;, BooleanType)\n              .add(\u0026#34;has_person\u0026#34;, BooleanType)\n              .add(\u0026#34;start_time\u0026#34;, TimestampType)\n              .add(\u0026#34;end_time\u0026#34;, TimestampType)\n              .add(\u0026#34;urls_expire_time\u0026#34;, TimestampType)\n              .add(\u0026#34;web_url\u0026#34;, StringType)\n              .add(\u0026#34;app_url\u0026#34;, StringType)\n              .add(\u0026#34;image_url\u0026#34;, StringType)\n              .add(\u0026#34;animated_image_url\u0026#34;, StringType)\n              .add(\u0026#34;activity_zone_ids\u0026#34;, ArrayType(StringType, true))\n            )\n        )\n        )\n        )\n      .add(\u0026#34;structures\u0026#34;, MapType(StringType, new StructType()\n        .add(\u0026#34;structure_id\u0026#34;, StringType)\n        .add(\u0026#34;thermostats\u0026#34;, ArrayType(StringType, true))\n        .add(\u0026#34;smoke_co_alarms\u0026#34;, ArrayType(StringType, true))\n        .add(\u0026#34;cameras\u0026#34;, ArrayType(StringType, true))\n        .add(\u0026#34;away\u0026#34;, StringType)\n        .add(\u0026#34;name\u0026#34;, StringType)\n        .add(\u0026#34;country_code\u0026#34;, StringType)\n        .add(\u0026#34;postal_code\u0026#34;, StringType)\n        .add(\u0026#34;peak_period_start_time\u0026#34;, TimestampType)\n        .add(\u0026#34;peak_period_end_time\u0026#34;, TimestampType)\n        .add(\u0026#34;time_zone\u0026#34;, StringType)\n        .add(\u0026#34;eta\u0026#34;, new StructType()\n            .add(\u0026#34;trip_id\u0026#34;, StringType)\n            .add(\u0026#34;estimated_arrival_window_begin\u0026#34;, TimestampType)\n            .add(\u0026#34;estimated_arrival_window_end\u0026#34;, TimestampType)\n          )\n        .add(\u0026#34;eta_begin\u0026#34;, TimestampType)\n        .add(\u0026#34;co_alarm_state\u0026#34;, StringType)\n        .add(\u0026#34;smoke_alarm_state\u0026#34;, StringType)\n        .add(\u0026#34;rhr_enrollment\u0026#34;, BooleanType)\n        .add(\u0026#34;wwn_security_state\u0026#34;, StringType)\n        .add(\u0026#34;wheres\u0026#34;, MapType(StringType, new StructType()\n          .add(\u0026#34;where_id\u0026#34;, StringType)\n          .add(\u0026#34;name\u0026#34;, StringType))\n        ))\n      )\n\n    val nestTimestampFormat = \u0026#34;yyyy-MM-dd\u0026#39;T\u0026#39;HH:mm:ss.sss\u0026#39;Z\u0026#39;\u0026#34;\n    val jsonOptions =  Map(\u0026#34;timestampFormat\u0026#34; -\u0026gt; nestTimestampFormat)\n\n    val parsed = spark.readStream\n      .format(\u0026#34;kafka\u0026#34;)\n      .option(\u0026#34;kafka.bootstrap.servers\u0026#34;, \u0026#34;localhost:9092\u0026#34;)\n      .option(\u0026#34;subscribe\u0026#34;, \u0026#34;net-logs\u0026#34;)\n      .option(\u0026#34;startingOffsets\u0026#34;, \u0026#34;earliest\u0026#34;)\n      .load()\n      .select(from_json(col(\u0026#34;value\u0026#34;).cast(\u0026#34;string\u0026#34;), schema, jsonOptions).alias(\u0026#34;parsed_value\u0026#34;))\n\n    import spark.implicits._\n    val camera = parsed\n      .select(explode($\u0026#34;parsed_value.devices.cameras\u0026#34;))\n      .select(\u0026#34;value.*\u0026#34;)\n\n    camera.printSchema()\n    val sightings = camera\n      .select(\u0026#34;device_id\u0026#34;, \u0026#34;last_event.has_person\u0026#34;, \u0026#34;last_event.start_time\u0026#34;)\n\n    val console = sightings.writeStream\n      .format(\u0026#34;console\u0026#34;)\n      .outputMode(OutputMode.Append())\n\n    val query = console.start()\n\n    query.awaitTermination()\n\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"jdbcsink\"\u003eJDBCSink\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.sql._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.\u003c/span\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"nc\"\u003eForeachWriter\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eRow\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e  \u003cspan class=\"nc\"\u003eJDBCSink\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epwd\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nc\"\u003eForeachWriter\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eRow\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;com.mysql.jdbc.Driver\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e\u003cspan class=\"kt\"\u003eConnection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003e_\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e\u003cspan class=\"kt\"\u003eStatement\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003e_\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003eopen\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epartitionId\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eLong\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eLong\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nc\"\u003eClass\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eforName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econnection\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eDriverManager\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epwd\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estatement\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreateStatement\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003eprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eRow\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eUnit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eexecuteUpdate\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;INSERT INTO carema \u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"s\"\u003e\u0026#34;VALUES (\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;)\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerrorOrNull\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eThrowable\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eUnit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"写数据库\"\u003e写数据库\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 写入数据库\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;jdbc:mysql://127.0.0.1:6606/test?useUnicode=true\u0026amp;characterEncoding=utf-8\u0026amp;autoReconnect=true\u0026amp;failOverReadOnly=false\u0026amp;useSSL=false\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;root\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003epwd\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;111608\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003ewriter\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJDBCSink\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epwd\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"n\"\u003esightings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewriteStream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eforeach\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewriter\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoutputMode\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;update\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eTrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eProcessingTime\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;25 seconds\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eawaitTermination\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"one-more-example\"\u003eone more example\u003c/h2\u003e\n\u003ch3 id=\"json\"\u003ejson\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e{\n   \u0026#34;createTime\u0026#34; : 1536571926,\n   \u0026#34;event\u0026#34; : {\n      \u0026#34;frequency\u0026#34; : -1,\n      \u0026#34;info\u0026#34; : {\n         \u0026#34;VCU_VacmPumpSta\u0026#34; : {\n            \u0026#34;diff_time\u0026#34; : [ 2, 11 ],\n            \u0026#34;value\u0026#34; : [ 1, 0 ]\n         }\n      },\n      \u0026#34;startTime\u0026#34; : -1\n   },\n   \u0026#34;iccid\u0026#34; : \u0026#34;89860117750045560712\u0026#34;,\n   \u0026#34;signal1s\u0026#34; : {\n      \u0026#34;frequency\u0026#34; : 1,\n      \u0026#34;info\u0026#34; : {\n         \u0026#34;APA_DistToparkslot\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;APA_Process_bar\u0026#34; : [ 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127 ],\n         \u0026#34;BMS_ActlExchgCurnt\u0026#34; : [\n            10016,\n            10016,\n            10021,\n            10021,\n            10021,\n            10021,\n            10012,\n            10012,\n            10012,\n            10012,\n            10012,\n            10007,\n            10007\n         ],\n         \u0026#34;BMS_BatSOC_Actl\u0026#34; : [ 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355 ],\n         \u0026#34;BMS_BatSOC_Rpt\u0026#34; : [ 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355 ],\n         \u0026#34;BMS_IsoResistance\u0026#34; : [ 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120 ],\n         \u0026#34;ESC_VehicleSpeed\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;HU_TargetSOC\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;ICU_DisplayVehicleSpeed\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;ICU_ICUTotalOdometer\u0026#34; : [\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252,\n            3252\n         ],\n         \u0026#34;LateralACC\u0026#34; : [ 201, 202, 201, 201, 201, 201, 201, 202, 201, 201, 202, 200, 201 ],\n         \u0026#34;LongitudeACC\u0026#34; : [ 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124 ],\n         \u0026#34;SAS_Angle\u0026#34; : [\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767\n         ],\n         \u0026#34;SAS_RotSpeed\u0026#34; : [\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767,\n            32767\n         ],\n         \u0026#34;VCU_AcclPedalPos\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;VCU_ActlMotorRotateSpd\u0026#34; : [\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000,\n            10000\n         ],\n         \u0026#34;VCU_Actl_MotorRotateSpd\u0026#34; : [\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384,\n            16384\n         ],\n         \u0026#34;VCU_Actl_MotorTorque\u0026#34; : [\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000\n         ],\n         \u0026#34;VCU_BrkPedalPos\u0026#34; : [ 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2 ],\n         \u0026#34;VCU_DrvRangeDistEst\u0026#34; : [ 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63 ],\n         \u0026#34;VCU_DrvReq_MotorTorq\u0026#34; : [\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000,\n            2000\n         ],\n         \u0026#34;VCU_MotorActualPower\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],\n         \u0026#34;VCU_VhclPwrCnsmpActl\u0026#34; : [ 209, 209, 209, 209, 209, 209, 210, 210, 210, 210, 210, 210, 210 ],\n         \u0026#34;YRS_YawRate\u0026#34; : [\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18000,\n            18005,\n            18000,\n            18000\n         ]\n      },\n      \u0026#34;startTime\u0026#34; : 0\n   },\n   \u0026#34;signal30s\u0026#34; : {\n      \u0026#34;frequency\u0026#34; : 0.3333333432674408,\n      \u0026#34;info\u0026#34; : {\n         \u0026#34;AC_ActTotalPower\u0026#34; : [ 5 ],\n         \u0026#34;AC_EnvirTemp\u0026#34; : [ 136 ],\n         \u0026#34;AC_HVHActlPwr_HVAC\u0026#34; : [ 0 ],\n         \u0026#34;AC_HVHDeviceInternTemp_HVAC\u0026#34; : [ 63 ],\n         \u0026#34;AC_InAirPM25Value\u0026#34; : [ 36 ],\n         \u0026#34;AC_IndoorTemp\u0026#34; : [ 126 ],\n         \u0026#34;AC_OutAirQualityLevel\u0026#34; : [ 0 ],\n         \u0026#34;AC_RefrgHiPressure\u0026#34; : [ 8 ],\n         \u0026#34;AC_SeatHeatTemp_FL_Rsrv\u0026#34; : [ 0 ],\n         \u0026#34;AC_SeatHeatTemp_FR_Rsrv\u0026#34; : [ 0 ],\n         \u0026#34;BAT_HVHActlPwr\u0026#34; : [ -1 ],\n         \u0026#34;BAT_HVHDeviceInternTemp\u0026#34; : [ -1 ],\n         \u0026#34;BAT_HighVolDCTolalPwr\u0026#34; : [ -1 ],\n         \u0026#34;BAT_PumpSpeedDutyRequest\u0026#34; : [ -1 ],\n         \u0026#34;BMS_AuxHeatReqPower_Reserved\u0026#34; : [ 0 ],\n         \u0026#34;BMS_BatCapacity\u0026#34; : [ 198 ],\n         \u0026#34;BMS_BatSOH\u0026#34; : [ 1000 ],\n         \u0026#34;BMS_BatteryDTC_Num\u0026#34; : [ 1 ],\n         \u0026#34;BMS_BatteryDTC_list\u0026#34; : [\n            [ 13698951 ]\n         ],\n         \u0026#34;BMS_BatterySubSysCod\u0026#34; : [ 1 ],\n         \u0026#34;BMS_BatterySubSysNum\u0026#34; : [ 1 ],\n         \u0026#34;BMS_BatteryType\u0026#34; : [ 6 ],\n         \u0026#34;BMS_CellVol\u0026#34; : [\n            [\n               3614,\n               3614,\n               3613,\n               3614,\n               3614,\n               3614,\n               3613,\n               3613,\n               3613,\n               3613,\n               3614,\n               3613,\n               3614,\n               3615,\n               3615,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3613,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3613,\n               3613,\n               3611,\n               3613,\n               3614,\n               3614,\n               3614,\n               3615,\n               3613,\n               3613,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3615,\n               3613,\n               3614,\n               3614,\n               3614,\n               3615,\n               3614,\n               3614,\n               3614,\n               3614,\n               3615,\n               3614,\n               3615,\n               3614,\n               3615,\n               3614,\n               3615,\n               3615,\n               3615,\n               3614,\n               3614,\n               3613,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3615,\n               3614,\n               3614,\n               3613,\n               3614,\n               3613,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614,\n               3614\n            ]\n         ],\n         \u0026#34;BMS_CellVolAve\u0026#34; : [ 3613 ],\n         \u0026#34;BMS_CellVolMax\u0026#34; : [ 3615 ],\n         \u0026#34;BMS_CellVolMin\u0026#34; : [ 3611 ],\n         \u0026#34;BMS_ContactorTempAve_DCCharger\u0026#34; : [ 70 ],\n         \u0026#34;BMS_ContactorTempAve_Negative\u0026#34; : [ 73 ],\n         \u0026#34;BMS_ContactorTempAve_Positive\u0026#34; : [ 72 ],\n         \u0026#34;BMS_DCS_ActlChrgCurrent\u0026#34; : [ 0 ],\n         \u0026#34;BMS_DCS_ActlChrgPower\u0026#34; : [ 0 ],\n         \u0026#34;BMS_DCS_ActlChrgVoltage\u0026#34; : [ 0 ],\n         \u0026#34;BMS_DC_AC_RemChrgTime\u0026#34; : [ 600 ],\n         \u0026#34;BMS_ESS_InletColantActtemp\u0026#34; : [ 69 ],\n         \u0026#34;BMS_ESS_InletColanttargettemp\u0026#34; : [ 70 ],\n         \u0026#34;BMS_ESS_outletColantActtemp\u0026#34; : [ 70 ],\n         \u0026#34;BMS_HVBatActlVoltage\u0026#34; : [ 3252 ],\n         \u0026#34;BMS_HVBatCellTempAve\u0026#34; : [ 68 ],\n         \u0026#34;BMS_HVBatCellTempMax\u0026#34; : [ 69 ],\n         \u0026#34;BMS_HVBatCellTempMin\u0026#34; : [ 68 ],\n         \u0026#34;BMS_HVcppltnTempAve\u0026#34; : [ 69 ],\n         \u0026#34;BMS_HVcppltnTempMin\u0026#34; : [ 68 ],\n         \u0026#34;BMS_HVcppltnTempmax\u0026#34; : [ 70 ],\n         \u0026#34;BMS_MaxCellTemp\u0026#34; : [ 100 ],\n         \u0026#34;BMS_MaxCellVol\u0026#34; : [ 4310 ],\n         \u0026#34;BMS_MaxConDisCurnt\u0026#34; : [ 2000 ],\n         \u0026#34;BMS_MaxInstanDisCurnt\u0026#34; : [ 3920 ],\n         \u0026#34;BMS_MaxTempProbeCod\u0026#34; : [ 0 ],\n         \u0026#34;BMS_MaxVolCellCod\u0026#34; : [ 14 ],\n         \u0026#34;BMS_MinCellTemp\u0026#34; : [ 15 ],\n         \u0026#34;BMS_MinCellVol\u0026#34; : [ 3050 ],\n         \u0026#34;BMS_MinTempProbeCod\u0026#34; : [ 4 ],\n         \u0026#34;BMS_MinVolCellCod\u0026#34; : [ 30 ],\n         \u0026#34;BMS_NomCellCap\u0026#34; : [ 62 ],\n         \u0026#34;BMS_PwrRecupMaxConChrgCurnt\u0026#34; : [ 1860 ],\n         \u0026#34;BMS_PwrRecupMaxInstanChrgCurnt\u0026#34; : [ 3000 ],\n         \u0026#34;BMS_TempProbe\u0026#34; : [\n            [\n               89,\n               89,\n               89,\n               89,\n               88,\n               89,\n               88,\n               89,\n               88,\n               89,\n               88,\n               89,\n               89,\n               89,\n               88,\n               89,\n               88,\n               89\n            ]\n         ],\n         \u0026#34;BMS_TotalCellNo\u0026#34; : [ 90 ],\n         \u0026#34;BMS_TotalTempProbe\u0026#34; : [ 18 ],\n         \u0026#34;GPS_Heading\u0026#34; : [ 0 ],\n         \u0026#34;GPS_Latitude\u0026#34; : [ 0 ],\n         \u0026#34;GPS_Longitude\u0026#34; : [ 0 ],\n         \u0026#34;GPS_Speed\u0026#34; : [ 0 ],\n         \u0026#34;ICU_AverageVehicleSpeed\u0026#34; : [ 0 ],\n         \u0026#34;ICU_ICUTripAOdometer\u0026#34; : [ 0 ],\n         \u0026#34;ICU_ICUTripBOdometer\u0026#34; : [ 0 ],\n         \u0026#34;ICU_WashLiquidLevelWarn\u0026#34; : [ 0 ],\n         \u0026#34;ICU_drive_time\u0026#34; : [ 0 ],\n         \u0026#34;PTG_DoorOpenRatio\u0026#34; : [ 0 ],\n         \u0026#34;TPMS_PressureValue_FL\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_PressureValue_FR\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_PressureValue_RL\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_PressureValue_RR\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_TireTempValue_FL\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_TireTempValue_FR\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_TireTempValue_RL\u0026#34; : [ 255 ],\n         \u0026#34;TPMS_TireTempValue_RR\u0026#34; : [ 255 ],\n         \u0026#34;VCU_AtmosPressure\u0026#34; : [ 204 ],\n         \u0026#34;VCU_CruiseCtrTgtSpd\u0026#34; : [ 0 ],\n         \u0026#34;VCU_MCU_Input_Curr\u0026#34; : [ 1024 ],\n         \u0026#34;VCU_MCU_Input_Vol\u0026#34; : [ 648 ],\n         \u0026#34;VCU_MCU_Temp\u0026#34; : [ 72 ],\n         \u0026#34;VCU_MotorActualPower\u0026#34; : [ 0 ],\n         \u0026#34;VCU_MotorDTC_Num\u0026#34; : [ 1 ],\n         \u0026#34;VCU_MotorDTC_list\u0026#34; : [\n            [ 134293412 ]\n         ],\n         \u0026#34;VCU_MotorTemp\u0026#34; : [ 74 ],\n         \u0026#34;VCU_PCUInletCooltTemp\u0026#34; : [ 72 ],\n         \u0026#34;VCU_PwrCoolFanSpdDuty\u0026#34; : [ 2 ],\n         \u0026#34;VCU_VacuumPressure\u0026#34; : [ 81 ],\n         \u0026#34;VCU_VhclPwrCnsmpAvrg\u0026#34; : [ 144 ]\n      },\n      \u0026#34;startTime\u0026#34; : 0\n   },\n   \u0026#34;tboxSn\u0026#34; : \u0026#34;VE70045900-J7U0077\u0026#34;,\n   \u0026#34;version\u0026#34; : \u0026#34;0.1.0.0\u0026#34;,\n   \u0026#34;vin\u0026#34; : \u0026#34;XXXX000000000XXXX\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"定义-schema\"\u003e定义 schema\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"nn\"\u003eohmysummer.pipeline.schema\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.types._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDcSaleData\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eschema\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;createTime\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;iccid\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e      \u003cspan class=\"nc\"\u003eStringType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;tboxSn\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e     \u003cspan class=\"nc\"\u003eStringType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;version\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e    \u003cspan class=\"nc\"\u003eStringType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;vin\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e        \u003cspan class=\"nc\"\u003eStringType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;event\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;frequency\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;info\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_VacmPumpSta\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;diff_time\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;value\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;startTime\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;signal1s\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;frequency\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;info\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;APA_DistToparkslot\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;APA_Process_bar\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ActlExchgCurnt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatSOC_Actl\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatSOC_Rpt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_IsoResistance\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ESC_VehicleSpeed\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;HU_TargetSOC\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_DisplayVehicleSpeed\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_ICUTotalOdometer\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;LateralACC\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;LongitudeACC\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;SAS_Angle\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;SAS_RotSpeed\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_AcclPedalPos\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_ActlMotorRotateSpd\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_Actl_MotorRotateSpd\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_Actl_MotorTorque\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_BrkPedalPos\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_DrvRangeDistEst\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_DrvReq_MotorTorq\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MotorActualPower\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_VhclPwrCnsmpActl\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;YRS_YawRate\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;startTime\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;signal30s\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;frequency\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eFloatType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;info\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_ActTotalPower\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_EnvirTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_HVHActlPwr_HVAC\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_HVHDeviceInternTemp_HVAC\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_InAirPM25Value\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_IndoorTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_OutAirQualityLevel\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_RefrgHiPressure\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_SeatHeatTemp_FL_Rsrv\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;AC_SeatHeatTemp_FR_Rsrv\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BAT_HVHActlPwr\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BAT_HVHDeviceInternTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BAT_HighVolDCTolalPwr\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BAT_PumpSpeedDutyRequest\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_AuxHeatReqPower_Reserved\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatCapacity\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatSOH\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatteryDTC_Num\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatteryDTC_list\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatterySubSysCod\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatterySubSysNum\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_BatteryType\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_CellVol\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_CellVolAve\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_CellVolMax\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_CellVolMin\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ContactorTempAve_DCCharger\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ContactorTempAve_Negative\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ContactorTempAve_Positive\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_DCS_ActlChrgCurrent\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_DCS_ActlChrgPower\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_DCS_ActlChrgVoltage\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_DC_AC_RemChrgTime\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ESS_InletColantActtemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ESS_InletColanttargettemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_ESS_outletColantActtemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVBatActlVoltage\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVBatCellTempAve\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVBatCellTempMax\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVBatCellTempMin\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVcppltnTempAve\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVcppltnTempMin\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_HVcppltnTempmax\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxCellTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxCellVol\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxConDisCurnt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxInstanDisCurnt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxTempProbeCod\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MaxVolCellCod\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MinCellTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MinCellVol\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MinTempProbeCod\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_MinVolCellCod\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_NomCellCap\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_PwrRecupMaxConChrgCurnt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_PwrRecupMaxInstanChrgCurnt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_TempProbe\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_TotalCellNo\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;BMS_TotalTempProbe\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;GPS_Heading\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;GPS_Latitude\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;GPS_Longitude\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;GPS_Speed\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_AverageVehicleSpeed\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_ICUTripAOdometer\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_ICUTripBOdometer\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_WashLiquidLevelWarn\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ICU_drive_time\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;PTG_DoorOpenRatio\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_PressureValue_FL\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_PressureValue_FR\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_PressureValue_RL\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_PressureValue_RR\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_TireTempValue_FL\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_TireTempValue_FR\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_TireTempValue_RL\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TPMS_TireTempValue_RR\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_AtmosPressure\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_CruiseCtrTgtSpd\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MCU_Input_Curr\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MCU_Input_Vol\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MCU_Temp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MotorActualPower\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MotorDTC_Num\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MotorDTC_list\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_MotorTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_PCUInletCooltTemp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_PwrCoolFanSpdDuty\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_VacuumPressure\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;VCU_VhclPwrCnsmpAvrg\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eArrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;startTime\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntegerType\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eobject\u003c/span\u003e \u003cspan class=\"nc\"\u003eDcSaleData\u003c/span\u003e \u003cspan class=\"o\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"explode\"\u003eexplode\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eexplode\u003c/code\u003e 接收的参数是 Array 或 Map，如果是 Struct， 得先转换为 Array:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"nn\"\u003eohmysummer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eohmysummer.pipeline.kafka.WmKafkaDeserializer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eohmysummer.pipeline.schema.DcSaleData\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.\u003c/span\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"nc\"\u003eDataset\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eSparkSession\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.streaming.OutputMode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eorg.apache.spark.sql.functions._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  * 从 Kafka 读取  JSON 数据\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  *  https://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  *  https://stackoverflow.com/questions/43297973/how-to-read-records-in-json-format-from-kafka-using-structured-streaming\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  *  https://stackoverflow.com/questions/48361177/spark-structured-streaming-kafka-convert-json-without-schema-infer-schema\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  *  https://databricks.com/blog/2017/04/26/processing-data-in-apache-kafka-with-structured-streaming-in-apache-spark-2-2.html\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  *  https://databricks.com/blog/2017/02/23/working-complex-data-formats-structured-streaming-apache-spark-2-1.html\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e  */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eobject\u003c/span\u003e \u003cspan class=\"nc\"\u003eSparkStructuredStreaming\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eArray\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eSparkSession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ReadFromKafka\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emaster\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;local[*]\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetOrCreate\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eobject\u003c/span\u003e \u003cspan class=\"nc\"\u003eKafkaDeserializerWrapper\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003edeser\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eWmKafkaDeserializer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//      val deser = new WmJsonDeserializer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eudf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eregister\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;deserialize\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etopic\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eArray\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eByte\u003c/span\u003e\u003cspan class=\"o\"\u003e])\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nc\"\u003eKafkaDeserializerWrapper\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edeser\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edeserialize\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etopic\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereadStream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;kafka\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;kafka.bootstrap.servers\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;localhost:9092\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;subscribe\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;dc-sale-data\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;startingOffsets\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;earliest\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 测试环境使用最早的数据\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003espark.implicits._\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 反序列化 value 中的字节数组, 得到原始 JSON\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"k\"\u003e:\u003c/span\u003e \u003cspan class=\"kt\"\u003eDataset\u003c/span\u003e\u003cspan class=\"o\"\u003e[(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e, \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e)]\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eselectExpr\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;CAST(key AS STRING)\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u0026#34;deserialize(\u0026#34;dc-sale-data\u0026#34;, value) AS message\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eas\u003c/span\u003e\u003cspan class=\"o\"\u003e[(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e, \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eschema\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eDcSaleData\u003c/span\u003e\u003cspan class=\"o\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eschema\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eparsed\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eselect\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e$\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;key\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efrom_json\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e$\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;message\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eas\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;data\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003eevent\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparsed\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eselect\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexplode\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e$\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;data.signal1s.info\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e))).\u003c/span\u003e\u003cspan class=\"n\"\u003eselect\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;col.*\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eprintSchema\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003econsole\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewriteStream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;console\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoutputMode\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eOutputMode\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eAppend\u003c/span\u003e\u003cspan class=\"o\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eval\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e \u003cspan class=\"k\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econsole\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eawaitTermination\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果解析出来是空的， 可能就是 schema 定义的问题，多半是字段的类型弄错了。\u003c/p\u003e\n\u003ch2 id=\"参考\"\u003e参考\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://databricks.com/blog/2017/04/26/processing-data-in-apache-kafka-with-structured-streaming-in-apache-spark-2-2.html\"\u003eprocessing-data-in-apache-kafka-with-structured-streaming-in-apache-spark-2-2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.im/entry/5902bbada0bb9f0065eb9262\"\u003e用 Apache Spark 2.2 中的结构化流处理 API 处理 Kafka 数据\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://databricks.com/blog/2017/02/23/working-complex-data-formats-structured-streaming-apache-spark-2-1.html\"\u003eworking-complex-data-formats-structured-streaming-apache-spark-2-1\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","text":"Producer 发送 JSON 数据到 Kafka：\nfrom confluent_kafka import Producer p = Producer({\u0026#39;bootstrap.servers\u0026#39;: \u0026#39;localhost:9092\u0026#39;}) def delivery_report(err, msg): \u0026#34;\u0026#34;\u0026#34; Called once for each message produced to indicate delivery result. Triggered by poll() or flush(). \u0026#34;\u0026#34;\u0026#34; if err is not None: print(\u0026#39;Message delivery failed: {}\u0026#39;.format(err)) else: print(\u0026#39;Message delivered to {} [{}]\u0026#39;.format(msg.topic(), msg.partition())) with open(\u0026#34;/Users/ohmycloud/bigdata/Spark/camelia.json\u0026#34;) as f: data = f.read() p.poll(0) p.produce(\u0026#39;net-logs\u0026#39;, data.encode(\u0026#39;utf-8\u0026#39;), callback=delivery_report) p.flush() JSON 数据内容如下：\n{ \u0026#34;metadata\u0026#34;:{ \u0026#34;access_token\u0026#34;:\u0026#34;c.FmDPkzyzaQe...\u0026#34;, \u0026#34;client_version\u0026#34;:1 }, \u0026#34;devices\u0026#34;:{ \u0026#34;thermostats\u0026#34;:{ \u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;:{ \u0026#34;device_id\u0026#34;:\u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;, \u0026#34;locale\u0026#34;:\u0026#34;en-US\u0026#34;, \u0026#34;software_version\u0026#34;:\u0026#34;4.0\u0026#34;, \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;, \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Thermostat (upstairs)\u0026#34;, \u0026#34;last_connection\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;is_online\u0026#34;:true, \u0026#34;can_cool\u0026#34;:true, \u0026#34;can_heat\u0026#34;:true, \u0026#34;is_using_emergency_heat\u0026#34;:true, \u0026#34;has_fan\u0026#34;:true, \u0026#34;fan_timer_active\u0026#34;:true, \u0026#34;fan_timer_timeout\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;has_leaf\u0026#34;:true, \u0026#34;temperature_scale\u0026#34;:\u0026#34;C\u0026#34;, \u0026#34;target_temperature_f\u0026#34;:72, \u0026#34;target_temperature_c\u0026#34;:21.5, \u0026#34;target_temperature_high_f\u0026#34;:80, \u0026#34;target_temperature_high_c\u0026#34;:24.5, \u0026#34;target_temperature_low_f\u0026#34;:65, \u0026#34;target_temperature_low_c\u0026#34;:19.5, \u0026#34;eco_temperature_high_f\u0026#34;:80, \u0026#34;eco_temperature_high_c\u0026#34;:24.5, \u0026#34;eco_temperature_low_f\u0026#34;:65, \u0026#34;eco_temperature_low_c\u0026#34;:19.5, \u0026#34;away_temperature_high_f\u0026#34;:80, \u0026#34;away_temperature_high_c\u0026#34;:24.5, \u0026#34;away_temperature_low_f\u0026#34;:65, \u0026#34;away_temperature_low_c\u0026#34;:19.5, \u0026#34;hvac_mode\u0026#34;:\u0026#34;heat\u0026#34;, \u0026#34;previous_hvac_mode\u0026#34;:\u0026#34;heat\u0026#34;, \u0026#34;ambient_temperature_f\u0026#34;:72, \u0026#34;ambient_temperature_c\u0026#34;:21.5, \u0026#34;humidity\u0026#34;:40, \u0026#34;hvac_state\u0026#34;:\u0026#34;heating\u0026#34;, \u0026#34;where_id\u0026#34;:\u0026#34;UNCBGUnN24...\u0026#34;, \u0026#34;is_locked\u0026#34;:true, \u0026#34;locked_temp_min_f\u0026#34;:65, \u0026#34;locked_temp_max_f\u0026#34;:80, \u0026#34;locked_temp_min_c\u0026#34;:19.5, \u0026#34;locked_temp_max_c\u0026#34;:24.5, \u0026#34;label\u0026#34;:\u0026#34;Pat\u0026#39;s room\u0026#34;, \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34;, \u0026#34;sunlight_correction_enabled\u0026#34;:true, \u0026#34;sunlight_correction_active\u0026#34;:true, \u0026#34;fan_timer_duration\u0026#34;:\u0026#34;15\u0026#34;, \u0026#34;time_to_target\u0026#34;:\u0026#34;~15\u0026#34;, \u0026#34;time_to_target_training\u0026#34;:\u0026#34;training\u0026#34; } }, \u0026#34;smoke_co_alarms\u0026#34;:{ \u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;:{ \u0026#34;device_id\u0026#34;:\u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;, \u0026#34;locale\u0026#34;:\u0026#34;en-US\u0026#34;, \u0026#34;software_version\u0026#34;:\u0026#34;1.01\u0026#34;, \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;, \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Protect (upstairs)\u0026#34;, \u0026#34;last_connection\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;is_online\u0026#34;:true, \u0026#34;battery_health\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;co_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;smoke_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;is_manual_test_active\u0026#34;:true, \u0026#34;last_manual_test_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;ui_color_state\u0026#34;:\u0026#34;gray\u0026#34;, \u0026#34;where_id\u0026#34;:\u0026#34;UNCBGUnN24...\u0026#34;, \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34; } }, \u0026#34;cameras\u0026#34;:{ \u0026#34;awJo6rH0IldT2YlIVtYaGQ\u0026#34;:{ \u0026#34;device_id\u0026#34;:\u0026#34;awJo6rH...\u0026#34;, \u0026#34;software_version\u0026#34;:\u0026#34;4.0\u0026#34;, \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;, \u0026#34;where_id\u0026#34;:\u0026#34;d6reb_OZTM...\u0026#34;, \u0026#34;where_name\u0026#34;:\u0026#34;Hallway\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;Hallway (upstairs)\u0026#34;, \u0026#34;name_long\u0026#34;:\u0026#34;Hallway Camera (upstairs)\u0026#34;, \u0026#34;is_online\u0026#34;:true, \u0026#34;is_streaming\u0026#34;:true, \u0026#34;is_audio_input_enabled\u0026#34;:true, \u0026#34;last_is_online_change\u0026#34;:\u0026#34;2016-12-29T18:42:00.000Z\u0026#34;, \u0026#34;is_video_history_enabled\u0026#34;:true, \u0026#34;web_url\u0026#34;:\u0026#34;https://home.nest.com/cameras/device_id?auth=access_token\u0026#34;, \u0026#34;app_url\u0026#34;:\u0026#34;nestmobile://cameras/device_id?auth=access_token\u0026#34;, \u0026#34;is_public_share_enabled\u0026#34;:true, \u0026#34;activity_zones\u0026#34;:[ { \u0026#34;name\u0026#34;:\u0026#34;Walkway\u0026#34;, \u0026#34;id\u0026#34;:\u0026#34;244083\u0026#34; }, { \u0026#34;name\u0026#34;:\u0026#34;Walkway2\u0026#34;, \u0026#34;id2\u0026#34;:\u0026#34;244084\u0026#34; } ], \u0026#34;public_share_url\u0026#34;:\u0026#34;https://video.nest.com/live/STRING1?STRING2\u0026#34;, \u0026#34;snapshot_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;, \u0026#34;last_event\u0026#34;:{ \u0026#34;has_sound\u0026#34;:true, \u0026#34;has_motion\u0026#34;:true, \u0026#34;has_person\u0026#34;:true, \u0026#34;start_time\u0026#34;:\u0026#34;2016-12-29T00:00:00.000Z\u0026#34;, \u0026#34;end_time\u0026#34;:\u0026#34;2016-12-29T18:42:00.000Z\u0026#34;, \u0026#34;urls_expire_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;web_url\u0026#34;:\u0026#34;https://home.nest.com/cameras/device_id/cuepoints/STRING?auth=access_token\u0026#34;, \u0026#34;app_url\u0026#34;:\u0026#34;nestmobile://cameras/device_id/cuepoints/STRING?auth=access_token\u0026#34;, \u0026#34;image_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;, \u0026#34;animated_image_url\u0026#34;:\u0026#34;STRING1/device_id/STRING2?auth=access_token\u0026#34;, \u0026#34;activity_zone_ids\u0026#34;:[ \u0026#34;244083\u0026#34;, \u0026#34;244084\u0026#34; ] } } } }, \u0026#34;structures\u0026#34;:{ \u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;:{ \u0026#34;structure_id\u0026#34;:\u0026#34;VqFabWH21nwVyd4RWgJgNb292wa7hG_dUwo2i2SG7j3-BOLY0BA4sw\u0026#34;, \u0026#34;thermostats\u0026#34;:[ \u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;, \u0026#34;ggfgfdgrgrgg\u0026#34; ], \u0026#34;smoke_co_alarms\u0026#34;:[ \u0026#34;RTMTKxsQTCxzVcsySOHPxKoF4OyCifrs\u0026#34;, \u0026#34;ddddddddddd\u0026#34; ], \u0026#34;cameras\u0026#34;:[ \u0026#34;awJo6r...\u0026#34;, \u0026#34;ddddddssssssss\u0026#34; ], \u0026#34;away\u0026#34;:\u0026#34;home\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;Home\u0026#34;, \u0026#34;country_code\u0026#34;:\u0026#34;US\u0026#34;, \u0026#34;postal_code\u0026#34;:\u0026#34;94304\u0026#34;, \u0026#34;peak_period_start_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;peak_period_end_time\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34;, \u0026#34;time_zone\u0026#34;:\u0026#34;America/Los_Angeles\u0026#34;, \u0026#34;eta\u0026#34;:{ \u0026#34;trip_id\u0026#34;:\u0026#34;myTripHome1024\u0026#34;, \u0026#34;estimated_arrival_window_begin\u0026#34;:\u0026#34;2016-10-31T22:42:59.000Z\u0026#34;, \u0026#34;estimated_arrival_window_end\u0026#34;:\u0026#34;2016-10-31T23:59:59.000Z\u0026#34; }, \u0026#34;eta_begin\u0026#34;:\u0026#34;2016-08-04T13:21:37-07:00\u0026#34;, \u0026#34;co_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;smoke_alarm_state\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;rhr_enrollment\u0026#34;:true, \u0026#34;wwn_security_state\u0026#34;:\u0026#34;ok\u0026#34;, \u0026#34;wheres\u0026#34;:{ \u0026#34;Fqp6wJI...\u0026#34;:{ \u0026#34;where_id\u0026#34;:\u0026#34;Fqp6wJI...\u0026#34;, \u0026#34;name\u0026#34;:\u0026#34;Bedroom\u0026#34; } } } } } 代码 package wmdevice import org.apache.spark.sql.SparkSession import org.apache.spark.sql.functions._ import org.apache.spark.sql.streaming.OutputMode import org.apache.spark.sql.types._ object CamerasStructedStreaming { def main(args: Array[String]) { val spark = SparkSession .builder .appName(\u0026#34;Camelia\u0026#34;) .master(\u0026#34;local[*]\u0026#34;) .getOrCreate() val schema = new StructType() .add(\u0026#34;metadata\u0026#34;, new StructType() .add(\u0026#34;access_token\u0026#34;, StringType) .add(\u0026#34;client_version\u0026#34;, IntegerType)) .add(\u0026#34;devices\u0026#34;, new StructType() .add(\u0026#34;thermostats\u0026#34;, MapType(StringType, new StructType() .add(\u0026#34;device_id\u0026#34;, StringType) .add(\u0026#34;locale\u0026#34;, StringType) .add(\u0026#34;software_version\u0026#34;, StringType) .add(\u0026#34;structure_id\u0026#34;, StringType) .add(\u0026#34;name\u0026#34;, StringType) .add(\u0026#34;name_long\u0026#34;, StringType) .add(\u0026#34;last_connection\u0026#34;, TimestampType) .add(\u0026#34;is_online\u0026#34;, BooleanType) .add(\u0026#34;can_cool\u0026#34;, BooleanType) .add(\u0026#34;can_heat\u0026#34;, BooleanType) .add(\u0026#34;is_using_emergency_heat\u0026#34;, BooleanType) .add(\u0026#34;has_fan\u0026#34;, BooleanType) .add(\u0026#34;fan_timer_active\u0026#34;, BooleanType) .add(\u0026#34;fan_timer_timeout\u0026#34;, TimestampType) .add(\u0026#34;has_leaf\u0026#34;, BooleanType) .add(\u0026#34;temperature_scale\u0026#34;, StringType) .add(\u0026#34;target_temperature_f\u0026#34;, StringType) .add(\u0026#34;target_temperature_c\u0026#34;, StringType) .add(\u0026#34;target_temperature_high_f\u0026#34;, StringType) .add(\u0026#34;target_temperature_high_c\u0026#34;, StringType) .add(\u0026#34;target_temperature_low_f\u0026#34;, StringType) .add(\u0026#34;target_temperature_low_c\u0026#34;, StringType) .add(\u0026#34;eco_temperature_high_f\u0026#34;, StringType) .add(\u0026#34;eco_temperature_high_c\u0026#34;, StringType) .add(\u0026#34;eco_temperature_low_f\u0026#34;, StringType) .add(\u0026#34;eco_temperature_low_c\u0026#34;, StringType) .add(\u0026#34;away_temperature_high_f\u0026#34;, StringType) .add(\u0026#34;away_temperature_high_c\u0026#34;, StringType) .add(\u0026#34;away_temperature_low_f\u0026#34;, StringType) .add(\u0026#34;away_temperature_low_c\u0026#34;, StringType) .add(\u0026#34;hvac_mode\u0026#34;, StringType) .add(\u0026#34;previous_hvac_mode\u0026#34;, StringType) .add(\u0026#34;ambient_temperature_f\u0026#34;, StringType) .add(\u0026#34;ambient_temperature_c\u0026#34;, StringType) .add(\u0026#34;humidity\u0026#34;, StringType) .add(\u0026#34;hvac_state\u0026#34;, StringType) .add(\u0026#34;where_id\u0026#34;, StringType) .add(\u0026#34;is_locked\u0026#34;, BooleanType) .add(\u0026#34;locked_temp_min_f\u0026#34;, StringType) .add(\u0026#34;locked_temp_max_f\u0026#34;, StringType) .add(\u0026#34;locked_temp_min_c\u0026#34;, StringType) .add(\u0026#34;locked_temp_max_c\u0026#34;, StringType) .add(\u0026#34;label\u0026#34;, StringType) .add(\u0026#34;where_name\u0026#34;, StringType) .add(\u0026#34;sunlight_correction_enabled\u0026#34;, BooleanType) .add(\u0026#34;sunlight_correction_active\u0026#34;, BooleanType) .add(\u0026#34;fan_timer_duration\u0026#34;, StringType) .add(\u0026#34;time_to_target\u0026#34;, StringType) .add(\u0026#34;time_to_target_training\u0026#34;, StringType)) ) .add(\u0026#34;smoke_co_alarms\u0026#34;, MapType(StringType, new StructType() .add(\u0026#34;device_id\u0026#34;, StringType) .add(\u0026#34;locale\u0026#34;, StringType) .add(\u0026#34;software_version\u0026#34;, StringType) .add(\u0026#34;structure_id\u0026#34;, StringType) .add(\u0026#34;name\u0026#34;, StringType) .add(\u0026#34;name_long\u0026#34;, StringType) .add(\u0026#34;last_connection\u0026#34;, TimestampType) .add(\u0026#34;is_online\u0026#34;, BooleanType) .add(\u0026#34;battery_health\u0026#34;, StringType) .add(\u0026#34;co_alarm_state\u0026#34;, StringType) .add(\u0026#34;smoke_alarm_state\u0026#34;, StringType) .add(\u0026#34;is_manual_test_active\u0026#34;, BooleanType) .add(\u0026#34;last_manual_test_time\u0026#34;, TimestampType) .add(\u0026#34;ui_color_state\u0026#34;, StringType) .add(\u0026#34;where_id\u0026#34;, StringType) .add(\u0026#34;where_name\u0026#34;, StringType)) ) .add(\u0026#34;cameras\u0026#34;, MapType(StringType, new StructType() .add(\u0026#34;device_id\u0026#34;, StringType) .add(\u0026#34;software_version\u0026#34;, StringType) .add(\u0026#34;structure_id\u0026#34;, StringType) .add(\u0026#34;where_id\u0026#34;, StringType) .add(\u0026#34;where_name\u0026#34;, StringType) .add(\u0026#34;name\u0026#34;, StringType) .add(\u0026#34;name_long\u0026#34;, StringType) .add(\u0026#34;is_online\u0026#34;, BooleanType) .add(\u0026#34;is_streaming\u0026#34;, BooleanType) .add(\u0026#34;is_audio_input_enabled\u0026#34;, BooleanType) .add(\u0026#34;last_is_online_change\u0026#34;, TimestampType) .add(\u0026#34;is_video_history_enabled\u0026#34;, BooleanType) .add(\u0026#34;web_url\u0026#34;, StringType) .add(\u0026#34;app_url\u0026#34;, StringType) .add(\u0026#34;is_public_share_enabled\u0026#34;, BooleanType) .add(\u0026#34;activity_zones\u0026#34;, ArrayType(new StructType().add(\u0026#34;name\u0026#34;, StringType).add(\u0026#34;id\u0026#34;, StringType), true)) .add(\u0026#34;public_share_url\u0026#34;, StringType) .add(\u0026#34;snapshot_url\u0026#34;, StringType) .add(\u0026#34;last_event\u0026#34;, new StructType() .add(\u0026#34;has_sound\u0026#34;, BooleanType) .add(\u0026#34;has_motion\u0026#34;, BooleanType) .add(\u0026#34;has_person\u0026#34;, BooleanType) .add(\u0026#34;start_time\u0026#34;, TimestampType) .add(\u0026#34;end_time\u0026#34;, TimestampType) .add(\u0026#34;urls_expire_time\u0026#34;, TimestampType) .add(\u0026#34;web_url\u0026#34;, StringType) .add(\u0026#34;app_url\u0026#34;, StringType) .add(\u0026#34;image_url\u0026#34;, StringType) .add(\u0026#34;animated_image_url\u0026#34;, StringType) .add(\u0026#34;activity_zone_ids\u0026#34;, ArrayType(StringType, true)) ) ) ) ) .add(\u0026#34;structures\u0026#34;, MapType(StringType, new StructType() .add(\u0026#34;structure_id\u0026#34;, StringType) .add(\u0026#34;thermostats\u0026#34;, ArrayType(StringType, true)) .add(\u0026#34;smoke_co_alarms\u0026#34;, ArrayType(StringType, true)) .add(\u0026#34;cameras\u0026#34;, ArrayType(StringType, true)) .add(\u0026#34;away\u0026#34;, StringType) .add(\u0026#34;name\u0026#34;, StringType) .add(\u0026#34;country_code\u0026#34;, StringType) .add(\u0026#34;postal_code\u0026#34;, StringType) .add(\u0026#34;peak_period_start_time\u0026#34;, TimestampType) .add(\u0026#34;peak_period_end_time\u0026#34;, TimestampType) .add(\u0026#34;time_zone\u0026#34;, StringType) .add(\u0026#34;eta\u0026#34;, new StructType() .add(\u0026#34;trip_id\u0026#34;, StringType) .add(\u0026#34;estimated_arrival_window_begin\u0026#34;, TimestampType) .add(\u0026#34;estimated_arrival_window_end\u0026#34;, TimestampType) ) .add(\u0026#34;eta_begin\u0026#34;, TimestampType) .add(\u0026#34;co_alarm_state\u0026#34;, StringType) .add(\u0026#34;smoke_alarm_state\u0026#34;, StringType) .add(\u0026#34;rhr_enrollment\u0026#34;, BooleanType) .add(\u0026#34;wwn_security_state\u0026#34;, StringType) .add(\u0026#34;wheres\u0026#34;, MapType(StringType, new StructType() .add(\u0026#34;where_id\u0026#34;, StringType) .add(\u0026#34;name\u0026#34;, StringType)) )) ) val nestTimestampFormat = \u0026#34;yyyy-MM-dd\u0026#39;T\u0026#39;HH:mm:ss.sss\u0026#39;Z\u0026#39;\u0026#34; val jsonOptions = Map(\u0026#34;timestampFormat\u0026#34; -\u0026gt; nestTimestampFormat) val parsed = spark.readStream .format(\u0026#34;kafka\u0026#34;) .option(\u0026#34;kafka.bootstrap.servers\u0026#34;, \u0026#34;localhost:9092\u0026#34;) .option(\u0026#34;subscribe\u0026#34;, \u0026#34;net-logs\u0026#34;) .option(\u0026#34;startingOffsets\u0026#34;, \u0026#34;earliest\u0026#34;) .load() .select(from_json(col(\u0026#34;value\u0026#34;).cast(\u0026#34;string\u0026#34;), schema, jsonOptions).alias(\u0026#34;parsed_value\u0026#34;)) import spark.implicits._ val camera = parsed .select(explode($\u0026#34;parsed_value.devices.cameras\u0026#34;)) .select(\u0026#34;value.*\u0026#34;) camera.printSchema() val sightings = camera .select(\u0026#34;device_id\u0026#34;, \u0026#34;last_event.has_person\u0026#34;, \u0026#34;last_event.start_time\u0026#34;) val console = sightings.writeStream .format(\u0026#34;console\u0026#34;) .outputMode(OutputMode.Append()) val query = console.start() query.awaitTermination() } } JDBCSink import java.sql._ import org.apache.spark.sql.{ForeachWriter, Row} class JDBCSink(url:String, user:String, pwd:String) extends ForeachWriter[Row] { val driver = \u0026#34;com.mysql.jdbc.Driver\u0026#34; var connection:Connection = _ var statement:Statement = _ def open(partitionId: Long,version: Long): Boolean = { Class.forName(driver) connection = DriverManager.getConnection(url, user, pwd) statement = connection.createStatement true } def process(value: Row): Unit = { statement.executeUpdate(\u0026#34;INSERT INTO carema \u0026#34; + \u0026#34;VALUES (\u0026#34; + value.get(0) + \u0026#34;,\u0026#34; + value.get(1) + \u0026#34;,\u0026#34; + value.get(2) + \u0026#34;)\u0026#34;) } def close(errorOrNull: Throwable): Unit = { connection.close } } 写数据库 // 写入数据库 val url=\u0026#34;jdbc:mysql://127.0.0.1:6606/test?useUnicode=true\u0026amp;characterEncoding=utf-8\u0026amp;autoReconnect=true\u0026amp;failOverReadOnly=false\u0026amp;useSSL=false\u0026#34; val user =\u0026#34;root\u0026#34; val pwd = \u0026#34;111608\u0026#34; val writer = new JDBCSink(url,user, pwd) val query = sightings .writeStream .foreach(writer) .outputMode(\u0026#34;update\u0026#34;) .trigger(Trigger.ProcessingTime(\u0026#34;25 seconds\u0026#34;)) .start() query.awaitTermination() one more example json { \u0026#34;createTime\u0026#34; : 1536571926, \u0026#34;event\u0026#34; : { \u0026#34;frequency\u0026#34; : -1, \u0026#34;info\u0026#34; : { \u0026#34;VCU_VacmPumpSta\u0026#34; : { \u0026#34;diff_time\u0026#34; : [ 2, 11 ], \u0026#34;value\u0026#34; : [ 1, 0 ] } }, \u0026#34;startTime\u0026#34; : -1 }, \u0026#34;iccid\u0026#34; : \u0026#34;89860117750045560712\u0026#34;, \u0026#34;signal1s\u0026#34; : { \u0026#34;frequency\u0026#34; : 1, \u0026#34;info\u0026#34; : { \u0026#34;APA_DistToparkslot\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;APA_Process_bar\u0026#34; : [ 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127 ], \u0026#34;BMS_ActlExchgCurnt\u0026#34; : [ 10016, 10016, 10021, 10021, 10021, 10021, 10012, 10012, 10012, 10012, 10012, 10007, 10007 ], \u0026#34;BMS_BatSOC_Actl\u0026#34; : [ 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355 ], \u0026#34;BMS_BatSOC_Rpt\u0026#34; : [ 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355 ], \u0026#34;BMS_IsoResistance\u0026#34; : [ 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120 ], \u0026#34;ESC_VehicleSpeed\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;HU_TargetSOC\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;ICU_DisplayVehicleSpeed\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;ICU_ICUTotalOdometer\u0026#34; : [ 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252, 3252 ], \u0026#34;LateralACC\u0026#34; : [ 201, 202, 201, 201, 201, 201, 201, 202, 201, 201, 202, 200, 201 ], \u0026#34;LongitudeACC\u0026#34; : [ 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124 ], \u0026#34;SAS_Angle\u0026#34; : [ 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767 ], \u0026#34;SAS_RotSpeed\u0026#34; : [ 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767 ], \u0026#34;VCU_AcclPedalPos\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;VCU_ActlMotorRotateSpd\u0026#34; : [ 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000 ], \u0026#34;VCU_Actl_MotorRotateSpd\u0026#34; : [ 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384 ], \u0026#34;VCU_Actl_MotorTorque\u0026#34; : [ 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000 ], \u0026#34;VCU_BrkPedalPos\u0026#34; : [ 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2 ], \u0026#34;VCU_DrvRangeDistEst\u0026#34; : [ 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63 ], \u0026#34;VCU_DrvReq_MotorTorq\u0026#34; : [ 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000 ], \u0026#34;VCU_MotorActualPower\u0026#34; : [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], \u0026#34;VCU_VhclPwrCnsmpActl\u0026#34; : [ 209, 209, 209, 209, 209, 209, 210, 210, 210, 210, 210, 210, 210 ], \u0026#34;YRS_YawRate\u0026#34; : [ 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18000, 18005, 18000, 18000 ] }, \u0026#34;startTime\u0026#34; : 0 }, \u0026#34;signal30s\u0026#34; : { \u0026#34;frequency\u0026#34; : 0.3333333432674408, \u0026#34;info\u0026#34; : { \u0026#34;AC_ActTotalPower\u0026#34; : [ 5 ], \u0026#34;AC_EnvirTemp\u0026#34; : [ 136 ], \u0026#34;AC_HVHActlPwr_HVAC\u0026#34; : [ 0 ], \u0026#34;AC_HVHDeviceInternTemp_HVAC\u0026#34; : [ 63 ], \u0026#34;AC_InAirPM25Value\u0026#34; : [ 36 ], \u0026#34;AC_IndoorTemp\u0026#34; : [ 126 ], \u0026#34;AC_OutAirQualityLevel\u0026#34; : [ 0 ], \u0026#34;AC_RefrgHiPressure\u0026#34; : [ 8 ], \u0026#34;AC_SeatHeatTemp_FL_Rsrv\u0026#34; : [ 0 ], \u0026#34;AC_SeatHeatTemp_FR_Rsrv\u0026#34; : [ 0 ], \u0026#34;BAT_HVHActlPwr\u0026#34; : [ -1 ], \u0026#34;BAT_HVHDeviceInternTemp\u0026#34; : [ -1 ], \u0026#34;BAT_HighVolDCTolalPwr\u0026#34; : [ -1 ], \u0026#34;BAT_PumpSpeedDutyRequest\u0026#34; : [ -1 ], \u0026#34;BMS_AuxHeatReqPower_Reserved\u0026#34; : [ 0 ], \u0026#34;BMS_BatCapacity\u0026#34; : [ 198 ], \u0026#34;BMS_BatSOH\u0026#34; : [ 1000 ], \u0026#34;BMS_BatteryDTC_Num\u0026#34; : [ 1 ], \u0026#34;BMS_BatteryDTC_list\u0026#34; : [ [ 13698951 ] ], \u0026#34;BMS_BatterySubSysCod\u0026#34; : [ 1 ], \u0026#34;BMS_BatterySubSysNum\u0026#34; : [ 1 ], \u0026#34;BMS_BatteryType\u0026#34; : [ 6 ], \u0026#34;BMS_CellVol\u0026#34; : [ [ 3614, 3614, 3613, 3614, 3614, 3614, 3613, 3613, 3613, 3613, 3614, 3613, 3614, 3615, 3615, 3614, 3614, 3614, 3614, 3614, 3613, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3613, 3613, 3611, 3613, 3614, 3614, 3614, 3615, 3613, 3613, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3614, 3615, 3613, 3614, 3614, 3614, 3615, 3614, 3614, 3614, 3614, 3615, 3614, 3615, 3614, 3615, 3614, 3615, 3615, 3615, 3614, 3614, 3613, 3614, 3614, 3614, 3614, 3614, 3614, 3615, 3614, 3614, 3613, 3614, 3613, 3614, 3614, 3614, 3614, 3614, 3614, 3614 ] ], \u0026#34;BMS_CellVolAve\u0026#34; : [ 3613 ], \u0026#34;BMS_CellVolMax\u0026#34; : [ 3615 ], \u0026#34;BMS_CellVolMin\u0026#34; : [ 3611 ], \u0026#34;BMS_ContactorTempAve_DCCharger\u0026#34; : [ 70 ], \u0026#34;BMS_ContactorTempAve_Negative\u0026#34; : [ 73 ], \u0026#34;BMS_ContactorTempAve_Positive\u0026#34; : [ 72 ], \u0026#34;BMS_DCS_ActlChrgCurrent\u0026#34; : [ 0 ], \u0026#34;BMS_DCS_ActlChrgPower\u0026#34; : [ 0 ], \u0026#34;BMS_DCS_ActlChrgVoltage\u0026#34; : [ 0 ], \u0026#34;BMS_DC_AC_RemChrgTime\u0026#34; : [ 600 ], \u0026#34;BMS_ESS_InletColantActtemp\u0026#34; : [ 69 ], \u0026#34;BMS_ESS_InletColanttargettemp\u0026#34; : [ 70 ], \u0026#34;BMS_ESS_outletColantActtemp\u0026#34; : [ 70 ], \u0026#34;BMS_HVBatActlVoltage\u0026#34; : [ 3252 ], \u0026#34;BMS_HVBatCellTempAve\u0026#34; : [ 68 ], \u0026#34;BMS_HVBatCellTempMax\u0026#34; : [ 69 ], \u0026#34;BMS_HVBatCellTempMin\u0026#34; : [ 68 ], \u0026#34;BMS_HVcppltnTempAve\u0026#34; : [ 69 ], \u0026#34;BMS_HVcppltnTempMin\u0026#34; : [ 68 ], \u0026#34;BMS_HVcppltnTempmax\u0026#34; : [ 70 ], \u0026#34;BMS_MaxCellTemp\u0026#34; : [ 100 ], \u0026#34;BMS_MaxCellVol\u0026#34; : [ 4310 ], \u0026#34;BMS_MaxConDisCurnt\u0026#34; : [ 2000 ], \u0026#34;BMS_MaxInstanDisCurnt\u0026#34; : [ 3920 ], \u0026#34;BMS_MaxTempProbeCod\u0026#34; : [ 0 ], \u0026#34;BMS_MaxVolCellCod\u0026#34; : [ 14 ], \u0026#34;BMS_MinCellTemp\u0026#34; : [ 15 ], \u0026#34;BMS_MinCellVol\u0026#34; : [ 3050 ], \u0026#34;BMS_MinTempProbeCod\u0026#34; : [ 4 ], \u0026#34;BMS_MinVolCellCod\u0026#34; : [ 30 ], \u0026#34;BMS_NomCellCap\u0026#34; : [ 62 ], \u0026#34;BMS_PwrRecupMaxConChrgCurnt\u0026#34; : [ 1860 ], \u0026#34;BMS_PwrRecupMaxInstanChrgCurnt\u0026#34; : [ 3000 ], \u0026#34;BMS_TempProbe\u0026#34; : [ [ 89, 89, 89, 89, 88, 89, 88, 89, 88, 89, 88, 89, 89, 89, 88, 89, 88, 89 ] ], \u0026#34;BMS_TotalCellNo\u0026#34; : [ 90 ], \u0026#34;BMS_TotalTempProbe\u0026#34; : [ 18 ], \u0026#34;GPS_Heading\u0026#34; : [ 0 ], \u0026#34;GPS_Latitude\u0026#34; : [ 0 ], \u0026#34;GPS_Longitude\u0026#34; : [ 0 ], \u0026#34;GPS_Speed\u0026#34; : [ 0 ], \u0026#34;ICU_AverageVehicleSpeed\u0026#34; : [ 0 ], \u0026#34;ICU_ICUTripAOdometer\u0026#34; : [ 0 ], \u0026#34;ICU_ICUTripBOdometer\u0026#34; : [ 0 ], \u0026#34;ICU_WashLiquidLevelWarn\u0026#34; : [ 0 ], \u0026#34;ICU_drive_time\u0026#34; : [ 0 ], \u0026#34;PTG_DoorOpenRatio\u0026#34; : [ 0 ], \u0026#34;TPMS_PressureValue_FL\u0026#34; : [ 255 ], \u0026#34;TPMS_PressureValue_FR\u0026#34; : [ 255 ], \u0026#34;TPMS_PressureValue_RL\u0026#34; : [ 255 ], \u0026#34;TPMS_PressureValue_RR\u0026#34; : [ 255 ], \u0026#34;TPMS_TireTempValue_FL\u0026#34; : [ 255 ], \u0026#34;TPMS_TireTempValue_FR\u0026#34; : [ 255 ], \u0026#34;TPMS_TireTempValue_RL\u0026#34; : [ 255 ], \u0026#34;TPMS_TireTempValue_RR\u0026#34; : [ 255 ], \u0026#34;VCU_AtmosPressure\u0026#34; : [ 204 ], \u0026#34;VCU_CruiseCtrTgtSpd\u0026#34; : [ 0 ], \u0026#34;VCU_MCU_Input_Curr\u0026#34; : [ 1024 ], \u0026#34;VCU_MCU_Input_Vol\u0026#34; : [ 648 ], \u0026#34;VCU_MCU_Temp\u0026#34; : [ 72 ], \u0026#34;VCU_MotorActualPower\u0026#34; : [ 0 ], \u0026#34;VCU_MotorDTC_Num\u0026#34; : [ 1 ], \u0026#34;VCU_MotorDTC_list\u0026#34; : [ [ 134293412 ] ], \u0026#34;VCU_MotorTemp\u0026#34; : [ 74 ], \u0026#34;VCU_PCUInletCooltTemp\u0026#34; : [ 72 ], \u0026#34;VCU_PwrCoolFanSpdDuty\u0026#34; : [ 2 ], \u0026#34;VCU_VacuumPressure\u0026#34; : [ 81 ], \u0026#34;VCU_VhclPwrCnsmpAvrg\u0026#34; : [ 144 ] }, \u0026#34;startTime\u0026#34; : 0 }, \u0026#34;tboxSn\u0026#34; : \u0026#34;VE70045900-J7U0077\u0026#34;, \u0026#34;version\u0026#34; : \u0026#34;0.1.0.0\u0026#34;, \u0026#34;vin\u0026#34; : \u0026#34;XXXX000000000XXXX\u0026#34; } 定义 schema package ohmysummer.pipeline.schema import org.apache.spark.sql.types._ class DcSaleData { val schema = new StructType() .add(\u0026#34;createTime\u0026#34;, IntegerType) .add(\u0026#34;iccid\u0026#34;, StringType) .add(\u0026#34;tboxSn\u0026#34;, StringType) .add(\u0026#34;version\u0026#34;, StringType) .add(\u0026#34;vin\u0026#34;, StringType) .add(\u0026#34;event\u0026#34;, new StructType() .add(\u0026#34;frequency\u0026#34;, IntegerType) .add(\u0026#34;info\u0026#34;, new StructType() .add(\u0026#34;VCU_VacmPumpSta\u0026#34;, new StructType() .add(\u0026#34;diff_time\u0026#34;, ArrayType(IntegerType)) .add(\u0026#34;value\u0026#34;, ArrayType(IntegerType)) )) .add(\u0026#34;startTime\u0026#34;, IntegerType)) .add(\u0026#34;signal1s\u0026#34;,new StructType() .add(\u0026#34;frequency\u0026#34;, IntegerType) .add(\u0026#34;info\u0026#34;, new StructType() .add(\u0026#34;APA_DistToparkslot\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;APA_Process_bar\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ActlExchgCurnt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatSOC_Actl\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatSOC_Rpt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_IsoResistance\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ESC_VehicleSpeed\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;HU_TargetSOC\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_DisplayVehicleSpeed\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_ICUTotalOdometer\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;LateralACC\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;LongitudeACC\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;SAS_Angle\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;SAS_RotSpeed\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_AcclPedalPos\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_ActlMotorRotateSpd\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_Actl_MotorRotateSpd\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_Actl_MotorTorque\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_BrkPedalPos\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_DrvRangeDistEst\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_DrvReq_MotorTorq\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MotorActualPower\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_VhclPwrCnsmpActl\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;YRS_YawRate\u0026#34;, ArrayType(IntegerType, true), true) ) .add(\u0026#34;startTime\u0026#34;, IntegerType)) .add(\u0026#34;signal30s\u0026#34;, new StructType() .add(\u0026#34;frequency\u0026#34;, FloatType) .add(\u0026#34;info\u0026#34;, new StructType() .add(\u0026#34;AC_ActTotalPower\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_EnvirTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_HVHActlPwr_HVAC\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_HVHDeviceInternTemp_HVAC\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_InAirPM25Value\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_IndoorTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_OutAirQualityLevel\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_RefrgHiPressure\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_SeatHeatTemp_FL_Rsrv\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;AC_SeatHeatTemp_FR_Rsrv\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BAT_HVHActlPwr\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BAT_HVHDeviceInternTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BAT_HighVolDCTolalPwr\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BAT_PumpSpeedDutyRequest\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_AuxHeatReqPower_Reserved\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatCapacity\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatSOH\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatteryDTC_Num\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatteryDTC_list\u0026#34;, ArrayType(ArrayType(IntegerType), true), true) .add(\u0026#34;BMS_BatterySubSysCod\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatterySubSysNum\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_BatteryType\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_CellVol\u0026#34;, ArrayType(ArrayType(IntegerType), true), true) .add(\u0026#34;BMS_CellVolAve\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_CellVolMax\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_CellVolMin\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ContactorTempAve_DCCharger\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ContactorTempAve_Negative\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ContactorTempAve_Positive\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_DCS_ActlChrgCurrent\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_DCS_ActlChrgPower\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_DCS_ActlChrgVoltage\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_DC_AC_RemChrgTime\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ESS_InletColantActtemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ESS_InletColanttargettemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_ESS_outletColantActtemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVBatActlVoltage\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVBatCellTempAve\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVBatCellTempMax\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVBatCellTempMin\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVcppltnTempAve\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVcppltnTempMin\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_HVcppltnTempmax\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxCellTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxCellVol\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxConDisCurnt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxInstanDisCurnt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxTempProbeCod\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MaxVolCellCod\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MinCellTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MinCellVol\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MinTempProbeCod\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_MinVolCellCod\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_NomCellCap\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_PwrRecupMaxConChrgCurnt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_PwrRecupMaxInstanChrgCurnt\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_TempProbe\u0026#34;, ArrayType(ArrayType(IntegerType) , true), true) .add(\u0026#34;BMS_TotalCellNo\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;BMS_TotalTempProbe\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;GPS_Heading\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;GPS_Latitude\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;GPS_Longitude\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;GPS_Speed\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_AverageVehicleSpeed\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_ICUTripAOdometer\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_ICUTripBOdometer\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_WashLiquidLevelWarn\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;ICU_drive_time\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;PTG_DoorOpenRatio\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_PressureValue_FL\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_PressureValue_FR\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_PressureValue_RL\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_PressureValue_RR\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_TireTempValue_FL\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_TireTempValue_FR\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_TireTempValue_RL\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;TPMS_TireTempValue_RR\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_AtmosPressure\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_CruiseCtrTgtSpd\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MCU_Input_Curr\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MCU_Input_Vol\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MCU_Temp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MotorActualPower\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MotorDTC_Num\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_MotorDTC_list\u0026#34;, ArrayType(ArrayType(IntegerType) , true), true) .add(\u0026#34;VCU_MotorTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_PCUInletCooltTemp\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_PwrCoolFanSpdDuty\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_VacuumPressure\u0026#34;, ArrayType(IntegerType, true), true) .add(\u0026#34;VCU_VhclPwrCnsmpAvrg\u0026#34;, ArrayType(IntegerType, true), true)) .add(\u0026#34;startTime\u0026#34;, IntegerType)) } object DcSaleData {} explode explode 接收的参数是 Array 或 Map，如果是 Struct， 得先转换为 Array:\npackage ohmysummer import ohmysummer.pipeline.kafka.WmKafkaDeserializer import ohmysummer.pipeline.schema.DcSaleData import org.apache.spark.sql.{Dataset, SparkSession} import org.apache.spark.sql.streaming.OutputMode import org.apache.spark.sql.functions._ /** * 从 Kafka 读取 JSON 数据 * https://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html * https://stackoverflow.com/questions/43297973/how-to-read-records-in-json-format-from-kafka-using-structured-streaming * https://stackoverflow.com/questions/48361177/spark-structured-streaming-kafka-convert-json-without-schema-infer-schema * https://databricks.com/blog/2017/04/26/processing-data-in-apache-kafka-with-structured-streaming-in-apache-spark-2-2.html * https://databricks.com/blog/2017/02/23/working-complex-data-formats-structured-streaming-apache-spark-2-1.html */ object SparkStructuredStreaming { def main(args: Array[String]) { val spark = SparkSession .builder .appName(\u0026#34;ReadFromKafka\u0026#34;) .master(\u0026#34;local[*]\u0026#34;) .getOrCreate() object KafkaDeserializerWrapper { val deser = new WmKafkaDeserializer // val deser = new WmJsonDeserializer } spark.udf.register(\u0026#34;deserialize\u0026#34;, (topic: String, bytes: Array[Byte]) =\u0026gt; KafkaDeserializerWrapper.deser.deserialize(topic, bytes) ) val df = spark.readStream .format(\u0026#34;kafka\u0026#34;) .option(\u0026#34;kafka.bootstrap.servers\u0026#34;, \u0026#34;localhost:9092\u0026#34;) .option(\u0026#34;subscribe\u0026#34;, \u0026#34;dc-sale-data\u0026#34;) .option(\u0026#34;startingOffsets\u0026#34;, \u0026#34;earliest\u0026#34;) // 测试环境使用最早的数据 .load() import spark.implicits._ // 反序列化 value 中的字节数组, 得到原始 JSON val result: Dataset[(String, String)] = df.selectExpr(\u0026#34;CAST(key AS STRING)\u0026#34;, \u0026#34;\u0026#34;\u0026#34;deserialize(\u0026#34;dc-sale-data\u0026#34;, value) AS message\u0026#34;\u0026#34;\u0026#34;) .as[(String, String)] val schema = (new DcSaleData).schema val parsed = result.select($\u0026#34;key\u0026#34;, from_json($\u0026#34;message\u0026#34;, schema) as \u0026#34;data\u0026#34;) val event = parsed.select(explode(array($\u0026#34;data.signal1s.info\u0026#34;))).select(\u0026#34;col.*\u0026#34;) event.printSchema() val console = event.writeStream .format(\u0026#34;console\u0026#34;) .outputMode(OutputMode.Append()) val query = console.start() query.awaitTermination() } } 如果解析出来是空的， 可能就是 schema 定义的问题，多半是字段的类型弄错了。\n参考 processing-data-in-apache-kafka-with-structured-streaming-in-apache-spark-2-2 用 Apache Spark 2.2 中的结构化流处理 API 处理 Kafka 数据 working-complex-data-formats-structured-streaming-apache-spark-2-1 "},"name":"使用 Spark Structured Streaming 解析 JSON","published":"2017-03-15T16:36:25Z","summary":"Producer 发送 JSON 数据到 Kafka：\nfrom confluent_kafka import Producer p = Producer({\u0026#39;bootstrap.servers\u0026#39;: \u0026#39;localhost:9092\u0026#39;}) def delivery_report(err, msg): \u0026#34;\u0026#34;\u0026#34; Called once for each message produced to indicate delivery result. Triggered by poll() or flush(). \u0026#34;\u0026#34;\u0026#34; if err is not None: print(\u0026#39;Message delivery failed: {}\u0026#39;.format(err)) else: print(\u0026#39;Message delivered to {} [{}]\u0026#39;.format(msg.topic(), msg.partition())) with open(\u0026#34;/Users/ohmycloud/bigdata/Spark/camelia.json\u0026#34;) as f: data = f.read() p.poll(0) p.produce(\u0026#39;net-logs\u0026#39;, data.encode(\u0026#39;utf-8\u0026#39;), callback=delivery_report) p.flush() JSON 数据内容如下：\n{ \u0026#34;metadata\u0026#34;:{ \u0026#34;access_token\u0026#34;:\u0026#34;c.FmDPkzyzaQe...\u0026#34;, \u0026#34;client_version\u0026#34;:1 }, \u0026#34;devices\u0026#34;:{ \u0026#34;thermostats\u0026#34;:{ \u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;:{ \u0026#34;device_id\u0026#34;:\u0026#34;peyiJNo0IldT2YlIVtYaGQ\u0026#34;, \u0026#34;locale\u0026#34;:\u0026#34;en-US\u0026#34;, \u0026#34;software_version\u0026#34;:\u0026#34;4.","type":"entry","url":"http://localhost:1313/notes/spark-structured-streaming-%E8%A7%A3%E6%9E%90-json/"}