{"author":{"name":null,"type":"card","url":"http://localhost:1313/"},"content":{"html":"\u003cp\u003e小红帽系统比较不优秀的地方就是自带的 yum 是收费的，不注册就不让装软件！\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eThis system is not registered with an entitlement server. You can use subscription-manager to register. \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e所以要删掉自带的 yum：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpm -qa\u003cspan class=\"p\"\u003e|\u003c/span\u003egrep yum\u003cspan class=\"p\"\u003e|\u003c/span\u003exargs rpm -e --nodeps\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e下载这三个文件：\u003ccode\u003ewget -i url.txt\u003c/code\u003e:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://mirrors.163.com/centos/7/os/x86_64/Packages/yum-3.4.3-158.el7.centos.noarch.rpm                                                                                      \nhttp://mirrors.163.com/centos/7/os/x86_64/Packages/yum-plugin-fastestmirror-1.1.31-45.el7.noarch.rpm                                                                        \nhttp://mirrors.163.com/centos/7/os/x86_64/Packages/yum-metadata-parser-1.1.4-10.el7.x86_64.rpm \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e安装：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpm -ivh yum-* \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e从 \u003ca href=\"http://mirrors.163.com/.help/centos.html\"\u003emirrors.163.com\u003c/a\u003e 下载对应版本的 repo 文件,  repo 文件的内容如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# CentOS-Base.repo\n#\n# The mirror system uses the connecting IP address of the client and the\n# update status of each mirror to pick mirrors that are updated to and\n# geographically close to the client.  You should use this for CentOS updates\n# unless you are manually picking other mirrors.\n#\n# If the mirrorlist= does not work for you, as a fall back you can try the \n# remarked out baseurl= line instead.\n#\n#\n[base]\nname=CentOS-$releasever - Base - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=os\nbaseurl=http://mirrors.163.com/centos/$releasever/os/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#released updates\n[updates]\nname=CentOS-$releasever - Updates - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=updates\nbaseurl=http://mirrors.163.com/centos/$releasever/updates/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-$releasever - Extras - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=extras\nbaseurl=http://mirrors.163.com/centos/$releasever/extras/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-$releasever - Plus - 163.com\nbaseurl=http://mirrors.163.com/centos/$releasever/centosplus/$basearch/\ngpgcheck=1\nenabled=0\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e官网上说把该文件放入 \u003ccode\u003e/etc/yum.repos.d/\u003c/code\u003e。 但是没有说要要把 \u003ccode\u003e$releasever\u003c/code\u003e 替换为对应的版本，关于版本怎么查看：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euname -a \u003cspan class=\"c1\"\u003e# Linux haBigData1 3.10.0-693.el7.x86_64 #1 SMP Thu Jul 6 19:56:57 EDT 2017 x86_64 x86_64 x86_64 GNU/Linux \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e看 \u003ccode\u003eel7.x86_64\u003c/code\u003e 中字母 \u003ccode\u003ex\u003c/code\u003e 前面的那个数字就是 \u003ccode\u003e$releasever\u003c/code\u003e， 即现在我的 CentOS 使用的 Red Hat Linux 版本为 7（Red Hat Enterprise Linux 7.4(64-bit)）。\u003c/p\u003e\n\u003cp\u003e我需要把 \u003cstrong\u003eCentOS-Base.repo\u003c/strong\u003e 文件中所有的 \u003ccode\u003e$releasever\u003c/code\u003e 都替换为数字 \u003cstrong\u003e7\u003c/strong\u003e，而不是傻傻的拿过来直接用。替换完之后：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# CentOS-Base.repo\n#\n# The mirror system uses the connecting IP address of the client and the\n# update status of each mirror to pick mirrors that are updated to and\n# geographically close to the client.  You should use this for CentOS updates\n# unless you are manually picking other mirrors.\n#\n# If the mirrorlist= does not work for you, as a fall back you can try the \n# remarked out baseurl= line instead.\n#\n#\n[base]\nname=CentOS-7 - Base - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=os\nbaseurl=http://mirrors.163.com/centos/7/os/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#released updates\n[updates]\nname=CentOS-7 - Updates - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=updates\nbaseurl=http://mirrors.163.com/centos/7/updates/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-7 - Extras - 163.com\n#mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=extras\nbaseurl=http://mirrors.163.com/centos/7/extras/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-7 - Plus - 163.com\nbaseurl=http://mirrors.163.com/centos/7/centosplus/$basearch/\ngpgcheck=1\nenabled=0\ngpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e清除和创建缓存：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum clean all\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum makecache\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是执行 \u003ccode\u003eyum makecache\u003c/code\u003e 的时候又报错了：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eCannot find a valid baseurl for repo: atomic/$releasever/x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e发现 \u003ccode\u003e/etc/yum.repos.d\u003c/code\u003e 目录下面还有其它的 repo 文件：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els /etc/yum.repos.d  # atomic.repo  CentOS-Base.repo  redhat.repo \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e看报错信息，可能是 atomic.repo 这个文件中有 \u003ccode\u003e$releasever\u003c/code\u003e 没替换成 7，所以和上面一样，全部替换，再 \u003ccode\u003eyum makecache\u003c/code\u003e 就可以了！\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# Name: Atomic Rocket Turtle RPM Repository for CentOS / Red Hat Enterprise Linux 7 - \n# URL: http://www.atomicrocketturtle.com/\n[atomic]\nname = CentOS / Red Hat Enterprise Linux 7 - atomic\nmirrorlist = http://updates.atomicorp.com/channels/mirrorlist/atomic/centos-7-$basearch\nenabled = 1\nprotect = 0\ngpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY.art.txt\n\tfile:///etc/pki/rpm-gpg/RPM-GPG-KEY.atomicorp.txt\ngpgcheck = 1\n\n# Almost Stable, release candidates for [atomic]\n[atomic-testing]\nname = CentOS / Red Hat Enterprise Linux 7 - atomic - (Testing)\nmirrorlist = http://updates.atomicorp.com/channels/mirrorlist/atomic-testing/centos-7-$basearch\nenabled = 0\nprotect = 0\ngpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY.art.txt\n\tfile:///etc/pki/rpm-gpg/RPM-GPG-KEY.atomicorp.txt\ngpgcheck = 1\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"配置本地-yum-源\"\u003e配置本地 yum 源\u003c/h2\u003e\n\u003cp\u003e把 CDROM 里面的 \u003cstrong\u003ePackages\u003c/strong\u003e 和 \u003cstrong\u003erepodata\u003c/strong\u003e 和 \u003cstrong\u003eRPM-GPG-KEY-CentOS-7\u003c/strong\u003e 文件上传到服务器,  Packages 里面是 \u003cstrong\u003e.rpm\u003c/strong\u003e 文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eroot@bigdata1 cdrom\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"c1\"\u003e# ll\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x. \u003cspan class=\"m\"\u003e2\u003c/span\u003e root root \u003cspan class=\"m\"\u003e221184\u003c/span\u003e 12月  \u003cspan class=\"m\"\u003e4\u003c/span\u003e 01:07 Packages\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxrwxrwx. \u003cspan class=\"m\"\u003e2\u003c/span\u003e root root   \u003cspan class=\"m\"\u003e4096\u003c/span\u003e 12月  \u003cspan class=\"m\"\u003e4\u003c/span\u003e 01:07 repodata\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-rwxr-xr-x. \u003cspan class=\"m\"\u003e1\u003c/span\u003e root root   \u003cspan class=\"m\"\u003e1690\u003c/span\u003e 12月  \u003cspan class=\"m\"\u003e4\u003c/span\u003e 01:06 RPM-GPG-KEY-CentOS-7\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003e/etc/yum.repos.d\u003c/code\u003e 里面配置一个本地仓库：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[base-local]\nname=CentOS-local\nbaseurl=file:///data/cdrom\nkeepcache=1\nenabled=1\ngpgcheck=0\ngpgkey=file:///data/cdrom/RPM-GPG-KEY-CentOS-7\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"centos-7-安装-htop\"\u003eCentOS 7 安装 htop\u003c/h2\u003e\n\u003cp\u003e验证一下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum -y install epel-release\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum -y install htop\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","text":"小红帽系统比较不优秀的地方就是自带的 yum 是收费的，不注册就不让装软件！\nThis system is not registered with an entitlement server. You can use subscription-manager to register. 所以要删掉自带的 yum：\nrpm -qa|grep yum|xargs rpm -e --nodeps 下载这三个文件：wget -i url.txt:\nhttp://mirrors.163.com/centos/7/os/x86_64/Packages/yum-3.4.3-158.el7.centos.noarch.rpm http://mirrors.163.com/centos/7/os/x86_64/Packages/yum-plugin-fastestmirror-1.1.31-45.el7.noarch.rpm http://mirrors.163.com/centos/7/os/x86_64/Packages/yum-metadata-parser-1.1.4-10.el7.x86_64.rpm 安装：\nrpm -ivh yum-* 从 mirrors.163.com 下载对应版本的 repo 文件, repo 文件的内容如下：\n# CentOS-Base.repo # # The mirror system uses the connecting IP address of the client and the # update status of each mirror to pick mirrors that are updated to and # geographically close to the client. You should use this for CentOS updates # unless you are manually picking other mirrors. # # If the mirrorlist= does not work for you, as a fall back you can try the # remarked out baseurl= line instead. # # [base] name=CentOS-$releasever - Base - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=os baseurl=http://mirrors.163.com/centos/$releasever/os/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #released updates [updates] name=CentOS-$releasever - Updates - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=updates baseurl=http://mirrors.163.com/centos/$releasever/updates/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #additional packages that may be useful [extras] name=CentOS-$releasever - Extras - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=$releasever\u0026amp;arch=$basearch\u0026amp;repo=extras baseurl=http://mirrors.163.com/centos/$releasever/extras/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #additional packages that extend functionality of existing packages [centosplus] name=CentOS-$releasever - Plus - 163.com baseurl=http://mirrors.163.com/centos/$releasever/centosplus/$basearch/ gpgcheck=1 enabled=0 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 官网上说把该文件放入 /etc/yum.repos.d/。 但是没有说要要把 $releasever 替换为对应的版本，关于版本怎么查看：\nuname -a # Linux haBigData1 3.10.0-693.el7.x86_64 #1 SMP Thu Jul 6 19:56:57 EDT 2017 x86_64 x86_64 x86_64 GNU/Linux 看 el7.x86_64 中字母 x 前面的那个数字就是 $releasever， 即现在我的 CentOS 使用的 Red Hat Linux 版本为 7（Red Hat Enterprise Linux 7.4(64-bit)）。\n我需要把 CentOS-Base.repo 文件中所有的 $releasever 都替换为数字 7，而不是傻傻的拿过来直接用。替换完之后：\n# CentOS-Base.repo # # The mirror system uses the connecting IP address of the client and the # update status of each mirror to pick mirrors that are updated to and # geographically close to the client. You should use this for CentOS updates # unless you are manually picking other mirrors. # # If the mirrorlist= does not work for you, as a fall back you can try the # remarked out baseurl= line instead. # # [base] name=CentOS-7 - Base - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=os baseurl=http://mirrors.163.com/centos/7/os/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #released updates [updates] name=CentOS-7 - Updates - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=updates baseurl=http://mirrors.163.com/centos/7/updates/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #additional packages that may be useful [extras] name=CentOS-7 - Extras - 163.com #mirrorlist=http://mirrorlist.centos.org/?release=7\u0026amp;arch=$basearch\u0026amp;repo=extras baseurl=http://mirrors.163.com/centos/7/extras/$basearch/ gpgcheck=1 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 #additional packages that extend functionality of existing packages [centosplus] name=CentOS-7 - Plus - 163.com baseurl=http://mirrors.163.com/centos/7/centosplus/$basearch/ gpgcheck=1 enabled=0 gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7 清除和创建缓存：\nyum clean all yum makecache 但是执行 yum makecache 的时候又报错了：\nCannot find a valid baseurl for repo: atomic/$releasever/x86_64 发现 /etc/yum.repos.d 目录下面还有其它的 repo 文件：\nls /etc/yum.repos.d # atomic.repo CentOS-Base.repo redhat.repo 看报错信息，可能是 atomic.repo 这个文件中有 $releasever 没替换成 7，所以和上面一样，全部替换，再 yum makecache 就可以了！\n# Name: Atomic Rocket Turtle RPM Repository for CentOS / Red Hat Enterprise Linux 7 - # URL: http://www.atomicrocketturtle.com/ [atomic] name = CentOS / Red Hat Enterprise Linux 7 - atomic mirrorlist = http://updates.atomicorp.com/channels/mirrorlist/atomic/centos-7-$basearch enabled = 1 protect = 0 gpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY.art.txt file:///etc/pki/rpm-gpg/RPM-GPG-KEY.atomicorp.txt gpgcheck = 1 # Almost Stable, release candidates for [atomic] [atomic-testing] name = CentOS / Red Hat Enterprise Linux 7 - atomic - (Testing) mirrorlist = http://updates.atomicorp.com/channels/mirrorlist/atomic-testing/centos-7-$basearch enabled = 0 protect = 0 gpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY.art.txt file:///etc/pki/rpm-gpg/RPM-GPG-KEY.atomicorp.txt gpgcheck = 1 配置本地 yum 源 把 CDROM 里面的 Packages 和 repodata 和 RPM-GPG-KEY-CentOS-7 文件上传到服务器, Packages 里面是 .rpm 文件。\n[root@bigdata1 cdrom]# ll drwxr-xr-x. 2 root root 221184 12月 4 01:07 Packages drwxrwxrwx. 2 root root 4096 12月 4 01:07 repodata -rwxr-xr-x. 1 root root 1690 12月 4 01:06 RPM-GPG-KEY-CentOS-7 在 /etc/yum.repos.d 里面配置一个本地仓库：\n[base-local] name=CentOS-local baseurl=file:///data/cdrom keepcache=1 enabled=1 gpgcheck=0 gpgkey=file:///data/cdrom/RPM-GPG-KEY-CentOS-7 CentOS 7 安装 htop 验证一下：\nyum -y install epel-release yum -y install htop "},"name":"CentOS 配置 163 yum 源和本地 yum 源","published":"2017-01-05T16:16:21Z","summary":"yum 源","type":"entry","url":"http://localhost:1313/notes/%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE-163-yum-%E6%BA%90/"}