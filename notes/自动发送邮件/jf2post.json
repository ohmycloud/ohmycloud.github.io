{"author":{"name":null,"type":"card","url":"https://ohmyweekly.github.io/"},"content":{"html":"\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nsub getTime\n{\n    my $time = shift || time();\n    my ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime($time);\n\n    $year += 1900;\n    $mon ++;\n\n    $min  = \u0026#39;0\u0026#39;.$min  if length($min)  \u0026lt; 2;\n    $sec  = \u0026#39;0\u0026#39;.$sec  if length($sec)  \u0026lt; 2;\n    $mon  = \u0026#39;0\u0026#39;.$mon  if length($mon)  \u0026lt; 2;\n    $mday = \u0026#39;0\u0026#39;.$mday if length($mday) \u0026lt; 2;\n    $hour = \u0026#39;0\u0026#39;.$hour if length($hour) \u0026lt; 2;\n    \n    my $weekday = (\u0026#39;Sun\u0026#39;,\u0026#39;Mon\u0026#39;,\u0026#39;Tue\u0026#39;,\u0026#39;Wed\u0026#39;,\u0026#39;Thu\u0026#39;,\u0026#39;Fri\u0026#39;,\u0026#39;Sat\u0026#39;)[$wday];\n\n    return { \u0026#39;second\u0026#39; =\u0026gt; $sec,\n             \u0026#39;minute\u0026#39; =\u0026gt; $min,\n             \u0026#39;hour\u0026#39;   =\u0026gt; $hour,\n             \u0026#39;day\u0026#39;    =\u0026gt; $mday,\n             \u0026#39;month\u0026#39;  =\u0026gt; $mon,\n             \u0026#39;year\u0026#39;   =\u0026gt; $year,\n             \u0026#39;weekNo\u0026#39; =\u0026gt; $wday,\n             \u0026#39;wday\u0026#39;   =\u0026gt; $weekday,\n             \u0026#39;yday\u0026#39;   =\u0026gt; $yday,\n             \u0026#39;date\u0026#39;   =\u0026gt; \u0026#34;$year-$mon-$mday\u0026#34;\n          };\n}\n\nmy $date = getTime();  \nmy $today = $date-\u0026gt;{date};                          # 获取xxxx-xx-xx这样的日期\n#my $month = $date-\u0026gt;{month};                        # 获取月\n#my $day = $date-\u0026gt;{day};                            # 获取日\n#my $year = $date-\u0026gt;{year};                          # 获取年\n#my $weekday = $date-\u0026gt;{wday};                       # 获取星期\nmy $yesterday = getTime(time() - 86400)-\u0026gt;{date};   # 获取昨天的日期，也可以用 86400*N，获取N天前的日期\n\n# or using the eval{ $obj-\u0026gt;Method()-\u0026gt;Method()-\u0026gt;...-\u0026gt;Close()} trick ...\n        use Mail::Sender;\n        eval {\n        (new Mail::Sender)\n                -\u0026gt;OpenMultipart({\n                            smtp =\u0026gt; \u0026#39;smtp.winchannel.net\u0026#39;,\n                            from =\u0026gt; \u0026#39;daxigua@winchannel.net\u0026#39;,\n                             auth=\u0026gt; \u0026#39;LOGIN\u0026#39;,\n                          authid =\u0026gt; \u0026#39;daxigua@winchannel.net\u0026#39;,\n                         authpwd =\u0026gt; \u0026#39;win123456\u0026#39;,\n                              to =\u0026gt; \u0026#39;daxigua@sina.com\u0026#39;,\n                         subject =\u0026gt; \u0026#34;$today工作日结\u0026#34;,\n                        boundary =\u0026gt; \u0026#39;boundary-test-1\u0026#39;,\n                            type =\u0026gt; \u0026#39;multipart/related\u0026#39;\n                })\n                -\u0026gt;Attach({\n                        description =\u0026gt; \u0026#39;fujian\u0026#39;,\n                              ctype =\u0026gt; \u0026#39;application/x-zip-encoded\u0026#39;,\n                           encoding =\u0026gt; \u0026#39;Base64\u0026#39;,\n                        disposition =\u0026gt; \u0026#39;NONE\u0026#39;,\n                               file =\u0026gt; \u0026#34;E:/GSK-RX远程登记表.xlsx,E:/上传跟进情况$today.xlsx,E:/工作日志.xlsx\u0026#34;\n                })\n           \n                -\u0026gt;Close()\n        }\n        or die \u0026#34;Cannot send mail: $Mail::Sender::Error\\n\u0026#34;;\n\u003c/code\u003e\u003c/pre\u003e","text":"#!/usr/bin/perl use strict; use warnings; sub getTime { my $time = shift || time(); my ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime($time); $year += 1900; $mon ++; $min = \u0026#39;0\u0026#39;.$min if length($min) \u0026lt; 2; $sec = \u0026#39;0\u0026#39;.$sec if length($sec) \u0026lt; 2; $mon = \u0026#39;0\u0026#39;.$mon if length($mon) \u0026lt; 2; $mday = \u0026#39;0\u0026#39;.$mday if length($mday) \u0026lt; 2; $hour = \u0026#39;0\u0026#39;.$hour if length($hour) \u0026lt; 2; my $weekday = (\u0026#39;Sun\u0026#39;,\u0026#39;Mon\u0026#39;,\u0026#39;Tue\u0026#39;,\u0026#39;Wed\u0026#39;,\u0026#39;Thu\u0026#39;,\u0026#39;Fri\u0026#39;,\u0026#39;Sat\u0026#39;)[$wday]; return { \u0026#39;second\u0026#39; =\u0026gt; $sec, \u0026#39;minute\u0026#39; =\u0026gt; $min, \u0026#39;hour\u0026#39; =\u0026gt; $hour, \u0026#39;day\u0026#39; =\u0026gt; $mday, \u0026#39;month\u0026#39; =\u0026gt; $mon, \u0026#39;year\u0026#39; =\u0026gt; $year, \u0026#39;weekNo\u0026#39; =\u0026gt; $wday, \u0026#39;wday\u0026#39; =\u0026gt; $weekday, \u0026#39;yday\u0026#39; =\u0026gt; $yday, \u0026#39;date\u0026#39; =\u0026gt; \u0026#34;$year-$mon-$mday\u0026#34; }; } my $date = getTime(); my $today = $date-\u0026gt;{date}; # 获取xxxx-xx-xx这样的日期 #my $month = $date-\u0026gt;{month}; # 获取月 #my $day = $date-\u0026gt;{day}; # 获取日 #my $year = $date-\u0026gt;{year}; # 获取年 #my $weekday = $date-\u0026gt;{wday}; # 获取星期 my $yesterday = getTime(time() - 86400)-\u0026gt;{date}; # 获取昨天的日期，也可以用 86400*N，获取N天前的日期 # or using the eval{ $obj-\u0026gt;Method()-\u0026gt;Method()-\u0026gt;...-\u0026gt;Close()} trick ... use Mail::Sender; eval { (new Mail::Sender) -\u0026gt;OpenMultipart({ smtp =\u0026gt; \u0026#39;smtp.winchannel.net\u0026#39;, from =\u0026gt; \u0026#39;daxigua@winchannel.net\u0026#39;, auth=\u0026gt; \u0026#39;LOGIN\u0026#39;, authid =\u0026gt; \u0026#39;daxigua@winchannel.net\u0026#39;, authpwd =\u0026gt; \u0026#39;win123456\u0026#39;, to =\u0026gt; \u0026#39;daxigua@sina.com\u0026#39;, subject =\u0026gt; \u0026#34;$today工作日结\u0026#34;, boundary =\u0026gt; \u0026#39;boundary-test-1\u0026#39;, type =\u0026gt; \u0026#39;multipart/related\u0026#39; }) -\u0026gt;Attach({ description =\u0026gt; \u0026#39;fujian\u0026#39;, ctype =\u0026gt; \u0026#39;application/x-zip-encoded\u0026#39;, encoding =\u0026gt; \u0026#39;Base64\u0026#39;, disposition =\u0026gt; \u0026#39;NONE\u0026#39;, file =\u0026gt; \u0026#34;E:/GSK-RX远程登记表.xlsx,E:/上传跟进情况$today.xlsx,E:/工作日志.xlsx\u0026#34; }) -\u0026gt;Close() } or die \u0026#34;Cannot send mail: $Mail::Sender::Error\\n\u0026#34;; "},"name":"Perl 自动发送邮件","published":"2013-05-09T16:16:21Z","summary":"#!/usr/bin/perl use strict; use warnings; sub getTime { my $time = shift || time(); my ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime($time); $year += 1900; $mon ++; $min = \u0026#39;0\u0026#39;.$min if length($min) \u0026lt; 2; $sec = \u0026#39;0\u0026#39;.$sec if length($sec) \u0026lt; 2; $mon = \u0026#39;0\u0026#39;.$mon if length($mon) \u0026lt; 2; $mday = \u0026#39;0\u0026#39;.$mday if length($mday) \u0026lt; 2; $hour = \u0026#39;0\u0026#39;.$hour if length($hour) \u0026lt; 2; my $weekday = (\u0026#39;Sun\u0026#39;,\u0026#39;Mon\u0026#39;,\u0026#39;Tue\u0026#39;,\u0026#39;Wed\u0026#39;,\u0026#39;Thu\u0026#39;,\u0026#39;Fri\u0026#39;,\u0026#39;Sat\u0026#39;)[$wday]; return { \u0026#39;second\u0026#39; =\u0026gt; $sec, \u0026#39;minute\u0026#39; =\u0026gt; $min, \u0026#39;hour\u0026#39; =\u0026gt; $hour, \u0026#39;day\u0026#39; =\u0026gt; $mday, \u0026#39;month\u0026#39; =\u0026gt; $mon, \u0026#39;year\u0026#39; =\u0026gt; $year, \u0026#39;weekNo\u0026#39; =\u0026gt; $wday, \u0026#39;wday\u0026#39; =\u0026gt; $weekday, \u0026#39;yday\u0026#39; =\u0026gt; $yday, \u0026#39;date\u0026#39; =\u0026gt; \u0026#34;$year-$mon-$mday\u0026#34; }; } my $date = getTime(); my $today = $date-\u0026gt;{date}; # 获取xxxx-xx-xx这样的日期 #my $month = $date-\u0026gt;{month}; # 获取月 #my $day = $date-\u0026gt;{day}; # 获取日 #my $year = $date-\u0026gt;{year}; # 获取年 #my $weekday = $date-\u0026gt;{wday}; # 获取星期 my $yesterday = getTime(time() - 86400)-\u0026gt;{date}; # 获取昨天的日期，也可以用 86400*N，获取N天前的日期 # or using the eval{ $obj-\u0026gt;Method()-\u0026gt;Method()-\u0026gt;.","type":"entry","url":"https://ohmyweekly.github.io/notes/%E8%87%AA%E5%8A%A8%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/"}