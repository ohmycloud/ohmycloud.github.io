<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">

    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    
    
    

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

    
    <meta name="referrer" content="no-referrer">

    <title>
        
            焉知非鱼 ❚
        
    </title>

    
    


    
    
    
    

    
    
    
    

    
    
    

    
    
    
    <style>
     
     
     :root {
         --theme-color: #ac4142;
         --theme-color-light: rgba(172, 65, 66, 0.2);
     }
     
     html {
         line-height: 1.5;
     }
    </style>

    
    

    
    
    
    
    <link rel="stylesheet" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css">
    
    <link rel="preload" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css" as="style">

    



    
        <style>
         
         /* Background */ .chroma { background-color: #ffffff }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
/* LineHighlight */ .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* LineNumbers */ .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

         
         /* Overrides on top of the theme and Chroma CSS */
/* Chroma-based lines highlighting in code blocks */
.chroma .hl {
    background-color: #e8e8e8;
    /* Extend highlight up to 100 characters (assuming that the code blocks never have more than 100 characters in a line) */
    min-width: 100ch;
}
/* GenericHeading */ .chroma .gh { color: #999999; font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa; font-weight: bold }

         
        </style>
    

    

    
    
    

    
    <script src="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js"></script>
    
    <link rel="preload" href="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js" as="script">

    
    
    <script defer src="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js"></script>
    
    <link rel="preload" href="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js" as="script">

    

    

    
    
    

    
    
<!-- rel="me" links for IndieAuth -->







    
 
<meta property="og:title" content="焉知非鱼" />
<meta property="og:description"
      content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ohmyweekly.github.io/" />


    
        <meta property="og:updated_time" content="2022-12-27T00:00:00&#43;00:00"/>
    












     <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="焉知非鱼"/>
<meta name="twitter:description" content=""/>


    
    
    <link rel="alternate" type="application/rss+xml" href="https://ohmyweekly.github.io/index.xml" title="Rss for 焉知非鱼" />
    <link rel="alternate" type="application/atom+xml" href="https://ohmyweekly.github.io/atom.xml" title="Atom for 焉知非鱼" />
    <link rel="alternate" type="application/jf2feed+json" href="https://ohmyweekly.github.io/jf2feed.json" title="Jf2feed for 焉知非鱼" />
    
     






    
    
    
    <meta name="hugo-build-date" content="2024-03-01T16:16:06Z"/>
    <meta name="hugo-commit-hash" content="312735366b20d64bd61bff8627f593749f86c964"/>
    <meta name="generator" content="Hugo 0.123.7">
</head>


    
        <body lang="en">
    

        
        <div class="border" id="home"></div>

        <div class="wrapper">   
            
<nav id="nav" class="nav-collapse opened" aria-hidden="false">
    <ul class="navbar">
        <li><a class="active" href="/">Home</a></li>
        
            
                <li><a class="" href="https://ohmyweekly.github.io/posts/">Posts</a></li>
            
        
            
                <li><a class="" href="https://ohmyweekly.github.io/notes/">Notes</a></li>
            
        
        
            <li><a class="" href="https://ohmyweekly.github.io/search/">Search</a></li>
        
    </ul>
</nav>

            <div class="container">
                <header class="masthead">
                    <div class="masthead-title no-text-decoration">
                        <a href="/">焉知非鱼</a> <span class="blinking-cursor">❚</span>
                    </div>
                    <div class="masthead-tagline">
                        Wait the light to fall
                    </div>
                </header>

                

<div class="posts h-feed">
    <header>
        
        <data class="u-url" value="https://ohmyweekly.github.io/"></data>
         





        <data class="p-name" value="焉知非鱼"></data>
    </header>
    
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/leap-seconds/'> 润秒</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2019-01-05T13:13:57+0000" class="dt-published">Sat Jan 5, 2019</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>2019年1月有闰秒吗？（剧透：没有）
今晚我们将在午夜时分从10倒数到0，并来到新的一年。
但是当我们倒数到0时，它会是2019年吗？如果有闰秒怎么办？
快点 - 让我们检查IETF提供的闰秒列表。
不 - 它看起来不错，2017年1月1日是最后一个，并且该列表在2019年6月28日之前是 OK 的。
两年前，情况有所不同。
在“午夜”（UTC）时，它变成了2017年。
~ $ raku -e &#39;say DateTime.new(&#34;2017-01-01T00:00:00Z&#34;).year&#39; 2017 但实际上，从晚上（和年）的11:59:59开始已经过了两秒钟！
~ $ raku -e &#39;say DateTime.new(&#34;2017-01-01T00:00:00Z&#34;) - DateTime.new(&#34;2016-12-31T23:59:59Z&#34;)&#39; 2 在它变成2017年的那一刻，有一个闰秒。now返回的值表明了这一点。
虽然今晚会很好：
~ $ raku -e &#39;say DateTime.new(&#34;2019-01-01T00:00:00Z&#34;) - DateTime.new(&#34;2018-12-31T23:59:59Z&#34;)&#39; 1 如果我们想要更明确，我们可以使用 posix 和 from-posix 将 DateTime 转换为 Instant 并再返回 - 后者将布尔值作为第二个参数来指示是否应该考虑闰秒。
my $date = DateTime.new(&#34;2017-01-01T00:00:00Z&#34;); my $instant = Instant.from-posix: $date.posix, True; my $instant2 = Instant.from-posix: $date.posix; say $instant.DateTime.year; say $instant2.</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/leap-seconds/'
               title="Read more about 润秒">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 润秒</span>
            </a>
        </div>
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/exploring-stateful-streaming-with-spark-structured-streaming/'> 使用 Spark 结构化流探索状态流</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-26T21:14:24+0000" class="dt-published">Wed Dec 26, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>在之前的文章中，我们探讨了如何使用带DStream抽象的Sparks Streaming API进行处理状态流。今天，我想和你一起探索Spark 2.2，它在Structured Streaming API下支持状态流。在这篇文章中，我们将看到API如何成熟和发展，看看两种方法（流与结构化流）之间的差异，并了解对API进行了哪些更改。我们将通过上一篇文章中的示例，并使其适应新的API来实现。
回顾 Spark Streaming 状态管理 如果你需要在Spark中使用状态流，你必须在两个抽象之间进行选择（直到Spark 2.2）。updateStateByKey 和 mapWithState后者或多或少是前者的改进（API和性能方面）版本（具有一些不同的语义）。为了利用微批次之间的状态，你提供了一个StateSpec函数，mapWithState对于到达当前微批次的每个键值对，将调用该函数。对于 mapWithState，主要优点是：
状态的初始RDD - 可以加载具有先前保存状态的RDD 超时 - 超时管理由Spark处理。你可以为所有键值对设置单个超时。 部分更新 - 仅迭代当前微批中“触摸”的键以进行更新 返回类型 - 你可以选择任何返回类型。 但事情并不总是完美的&hellip;&hellip;
mapWithState 的痛点 mapWithState 比以前的 updateStateByKey API 有了很大的改进。但是去年在我使用它的过程中，体验过一些缺点：
检查点 为了确保Spark可以从失败的任务中恢复，它必须将数据 checkpoint 到分布式文件系统中，它可以在失败时从中恢复。使用 mapWithState 时，每个 executor 在内存中保存已累积的所有状态的 HashMap。在每个检查点，Spark 每次都会序列化整个状态。如果你在内存中持有很多状态，这可能会导致严重的处理延迟。例如，以下设置：
批处理间隔：4秒 检查点间隔：40秒（4秒批次x 10 常量 spark 系数） 每秒80,000条消息 消息大小：500B - 2KB 5 m4.2xlarge机器（8个vCPU，32GB RAM） 每台机器2个 executor executor 存储大小~7GB（每个） 将数据 checkpoint 到 HDFS 我经历了长达4小时的累积延迟，因为高负荷下的每个检查点在整个状态下花费30秒-1分钟，我们每4秒产生一次批次。我也看到人们在StackOverflow上对此感到困惑，因为实际上并不明白为什么有些批次比其他批次花费的时间要长得多。
如果你计划使用状态流来实现高吞吐量，则必须将此视为一个严重的警告。这个问题非常严重，以至于它让我找到了在Spark中使用内存状态的替代方法。但我们很快就会看到事情看起来很光明;）
在版本更新之间保存状态 软件是一个不断发展的过程，我们总是在改进，增强和实现新的功能要求。因此，我们需要能够从一个版本升级到另一个版本，最好不要影响现有数据。在内存数据中，这变得非常棘手。我们如何保持现状？我们如何确保从中断的地方继续？</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/exploring-stateful-streaming-with-spark-structured-streaming/'
               title="Read more about 使用 Spark 结构化流探索状态流">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 使用 Spark 结构化流探索状态流</span>
            </a>
        </div>
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/tips-and-ideas-for-the-raku-golf-code/'> 🎄 25/25. Raku Golf 代码的提示和想法</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-25T05:28:31+0000" class="dt-published">Tue Dec 25, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>欢迎来到第25天，这是Raku One-Liner Advent Calendar的最后一天！传统的 advent calendar 只有24个条目，我们今天的奖励帖子将专注于你可以在Raku高尔夫比赛中使用的一些提示和技巧。
有一个很棒的网站code-golf.io，你可以尝试解决一些问题，并将Raku移到最高分。我怀疑许多问题可以从这个One-Liner Advent Calendar 前几天所涵盖的技术中受益。
省略主题变量 如果在主题变量$_上调用方法，那么 Raku 实际上不需要变量名来理解你在说什么，所以，避免显式命名主题变量：
$_.say for 1..10 使用范围进行循环 Perl 中的范围是表达循环细节的好东西：用几个字符，指定循环变量的初始和最终状态。倒装形式通常更短。
for 1..10 {.say} .say for 1..10 想想你是否可以从0开始计数，在这种情况下，可以使用脱字符来获得从0开始的范围。以下代码打印数字0到9：
.say for ^10 在范围和序列之间进行选择 在循环中，序列可以与范围完全相同。选择可能取决于Golf软件是计数字节还是计数Unicode字符。在第一种情况下，两个点的范围优于三个点的范围。在第二种情况下，使用Unicode字符：
.say for 1..10 .say for 1...10 .say for 1…10 当你需要向下计数时，序列是你的朋友，因为他们可以推断出循环计数器更改的方向：
.say for 10…1 使用map而不是循环 在某些情况下，尤其是当你必须使用循环变量进行多个操作时，请尝试使用map迭代所有值：
(^10).map: *.say 省略括号 与 Perl 5 不同，Raku 不会强制你在常规形式的条件检查中使用括号：
if ($x &gt; 0) {say $x;exit} if $x &gt; 0 {say $x;exit} 有时，你也希望省略函数调用中的括号。
在声明数组或散列时，你都不需要括号。对于数组，使用引号构造：</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/tips-and-ideas-for-the-raku-golf-code/'
               title="Read more about 🎄 25/25. Raku Golf 代码的提示和想法">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 🎄 25/25. Raku Golf 代码的提示和想法</span>
            </a>
        </div>
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/summary-for-2018/'> 2018 总结</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-24T14:49:44+0000" class="dt-published">Mon Dec 24, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>总结个 🍉。</p>

    </div>

    
    
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/reading-files-with-argfiles-in-raku/'> 🎄 24/25. 在 Raku 中用 $*ARGFILES 读取文件</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-24T10:06:06+0000" class="dt-published">Mon Dec 24, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>欢迎来到Raku One-Liner Advent Calendar的第24天！
在前几天，我们正在读取文本文件，因此讨论 $*ARGFILES是合乎逻辑的，这是一个内置的动态变量，在处理多个输入文件时可能很方便。
如何读取命令行中传递的两个或多个文件？
$ raku work.pl a.txt b.txt 如果您需要将所有文件一起处理，就像它们是单个数据源一样，您可以要求我们今天的变量以单行方式完成工作：
.say for $*ARGFILES.lines 在程序内部，您不必考虑循环文件; $*ARGFILES将自动为您做到这一点。
如果命令行中没有文件，则该变量将附加到 STDIN：
$ cat a.txt b.txt | raku work.pl 确实很方便，不是吗？
6.d和MAIN 如果你想在更大的程序中使用它，我也必须警告你。考虑以下程序：
sub MAIN(*@files) { .say for $*ARGFILES.lines; } 在 Perl 6.d 中, $*ARGFILES 在MAIN子例程内部和它之外的工作方式不同。
这个程序将完全适用于 Raku.c，但不适用于Raku.d. 换句话说，在Rakudo Star中，包括版本2018.10，$*ARGFILES 在命令行中处理文件名，但从 Rakudo Star 2018.12 开始，如果在 MAIN 中使用它，它将始终连接到 $*IN。
这就是今天的 advent 文章的结束，几乎是今年整个日历的结束。不过，明天再来！</p>

    </div>

    
    
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/about-translation-of-raku-one-liner/'> 🎄 About Translation of Raku One-Liner Advent Calendar</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-23T11:10:28+0000" class="dt-published">Sun Dec 23, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>Thanks so much to Andrew Shitov, for writing so much nice articles, for allowing me to translate these posts to Chinese.
If you are fluent in english, please read the source posts:
Day 1 - https://raku.online/2018/12/01/generating-random-password/ Day 2 - https://raku.online/2018/12/02/grep-dividable-numbers/ Day 3 - https://raku.online/2018/12/03/generating-random-integers-in-perl-6/ Day 4 - https://raku.online/2018/12/04/working-with-big-numbers-in-perl-6/ Day 5 - https://raku.online/2018/12/05/what-is-the-date-today-in-raku/ Day 6 - https://raku.online/2018/12/06/palindrom-testing-in-perl-6/ Day 7 - https://raku.online/2018/12/07/the-joy-of-unicode-in-perl-6/ Day 8 - https://raku.online/2018/12/08/adding-up-even-fibonacci-numbers-in-perl-6/ Day 9 - https://raku.online/2018/12/09/more-on-x-in-perl-6/ Day 10 - https://raku.</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/about-translation-of-raku-one-liner/'
               title="Read more about 🎄 About Translation of Raku One-Liner Advent Calendar">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 🎄 About Translation of Raku One-Liner Advent Calendar</span>
            </a>
        </div>
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/calculating-totals-with-perl6/'> 🎄 23/25. 用 Raku 计算总数</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-23T08:44:56+0000" class="dt-published">Sun Dec 23, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>欢迎来到Raku One-Liner Advent Calendar的第23天！今年年底是人们计算年度结果的时间，Raku 也可以帮助解决这个问题。
今天，我们将看到一个单行程序，用于计算表格列的总数。
这是文件中的一些示例数据：
100.20 303.50 150.25 130.44 1505.12 36.41 200.12 305.60 78.12 这里是为每列打印三个数字总和的代码：
put [Z+] lines.map: *.words 该程序打印我们需要的数字：
430.76 2114.22 264.78 从昨天的帖子的更新中，我们知道，裸lines 和 $*IN.lines 是一样的，所以lines.map在输入流中迭代所有行。然后将每一行拆分成由空格分隔的单词子串。
解析输入数据的作业部分已完成。我们得到了许多与输入数据行相对应的序列。对于我们的示例文件，有如下内容：
((&#34;100.20&#34;, &#34;303.50&#34;, &#34;150.25&#34;).Seq, (&#34;130.44&#34;, &#34;1505.12&#34;, &#34;36.41&#34;).Seq, (&#34;200.12&#34;, &#34;305.60&#34;, &#34;78.12&#34;).Seq).Seq 现在，将每个序列的第一个元素，每个序列的第二个元素等相加起来。化简运算符和zip元运算符的组合只需要四个代码字符即可完成所有工作：[Z+]。
此时，我们有一个化简后的序列：
（430.76,2114.22,264.78）.Seq 最后一个简单的步骤是使用 put 例程打印值。如果你昨天做了功课，你会知道say使用gist方法（在序列周围添加括号）来显示结果，而put只是使用Str方法打印值。
还有 让我们在脚本中添加一些字符来演示如何跳过第一列，例如，跳过包含月份名称的列：
Jan 100.20 303.50 150.25 Feb 130.44 1505.12 36.41 Mar 200.12 305.60 78.12 您只需要创建一个切片并选择除第一列之外的所有列：
put &#39;Total &#39;, [Z+] lines.map: *.words[1..*] 如您所见，我们甚至不需要自己计算列数。1..* 范围可以完成这样的工作。
这就是今天的 advent 文章的结尾，所以明天再来吧！</p>

    </div>

    
    
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/use-carton-for-your-mojolicious-app-deployment/'> 第二十二天 - 使用 Carton 进行 Mojolicious 应用程序部署</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-22T14:29:15+0000" class="dt-published">Sat Dec 22, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>你有一个可爱的Mojolicious应用程序，它是时候部署它了！
但是&hellip;&hellip;它不能在生产服务器上运行！到底是怎么回事？哦，不，您所依赖的模块与开发服务器上的版本不同。你能做什么？
实际上，一些模块发展得很快（Hello Mojolicious！），这没有毛病，但可能会导致不兼容的变化。
还有一些可以在版本中解决或引入的错误，如果您的版本错误，则会遇到这些错误。
Cpanfile来救援 Cpanfile是一种用于描述Perl应用程序的CPAN依赖关系的格式。
有了cpanfile，我们可以列出我们需要的模块，但我们也可以强制模块的最小版本，它们的最大版本&hellip;&hellip;或者说“我想要那个模块的确切版本”。
但我们也可以列出可选模块：您可以支持不同的数据库，但如果用户想要使用PostgreSQL，则不必安装与MySQL相关的模块。
这是一个例子cpanfile：
# Do not ask for a specific version requires &#39;DateTime&#39;; # Ask a specific version requires &#39;Plack&#39;, &#39;== 1.0&#39;; # Ask a minimal version requires &#39;Net::DNS&#39;, &#39;&gt;= 1.12&#39;; # Or requires &#39;Net::DNS&#39;, &#39;1.12&#39;; # Ask a maximal version requires &#39;Locale::Maketext&#39;, &#39;&lt; 1.28&#39;; # Give a range requires &#39;Mojolicious&#39;, &#39;&gt;= 7.0, &lt; 8.0&#39;; # Optional modules feature &#39;postgresql&#39;, &#39;PostgreSQL support&#39; =&gt; sub { requires &#39;Mojo::Pg&#39;; }; feature &#39;mysql&#39;, &#39;MySQL support&#39; =&gt; sub { requires &#39;Mojo::mysql&#39;; }; feature &#39;ldap&#39;, &#39;LDAP authentication support&#39; =&gt; sub { requires &#39;Net::LDAP&#39;; }; Cpanfile格式可以做更多（推荐模块，用于特定阶段（需求configure，test&hellip;），使用没有公布关于CPAN &hellip;模块），但是这是一个关于 Carton 的文章：我让你读cpanfile文档🙂</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/use-carton-for-your-mojolicious-app-deployment/'
               title="Read more about 第二十二天 - 使用 Carton 进行 Mojolicious 应用程序部署">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 第二十二天 - 使用 Carton 进行 Mojolicious 应用程序部署</span>
            </a>
        </div>
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/reversing-a-file-with-raku/'> 🎄 22/25. 使用 Raku 反转文件</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-22T10:10:35+0000" class="dt-published">Sat Dec 22, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>欢迎来到Raku One-Liner Advent Calendar的第22天！今天，我们将继续使用文件，今天的目标是创建一个单行程序以相反的顺序打印文本文件的行（如tail -r那样）。
第一个单行程序使用 STDIN 流完成工作：
.say for $*IN.lines.reverse 运行程序为：
$ raku reverse.pl &lt; text.txt 如果要直接从Raku读取文件，请稍微修改程序以从命令行参数创建文件句柄：
.say for @*ARGS[0].IO.open.lines.reverse 现在运行如下：
$ raku reverse.pl text.txt 重要的是要记住，lines方法的默认行为是从最后的行序列中排除换行符（该方法返回Seq对象，而不是数组或列表）。它可能与你在使用Perl 5时习惯的方式相反。使用chomp是一种常见的做法。
在Raku中，lines方法根据IO::Handle对象的nl-in 属性中存储的值来拆分行。
您可以使用以下小脚本查看行分隔符的当前值：
dd $_ for @*ARGS[0].IO.open.nl-in 这是您默认找到的内容：
$[&#34;\n&#34;, &#34;\r\n&#34;] 有趣的是，你可以控制的 lines 的行为，并告诉 Perl 不排除换行符：
@*ARGS[0].IO.open(chomp =&gt; False).lines.reverse.put 该 chomp 属性由默认设置为 True。您还可以更改默认分隔符：
@*ARGS[0].IO.open( nl-in =&gt; &#34;\r&#34;, chomp =&gt; False ).lines.reverse.put 请注意，如果没有 chomping，则不需要对行进行显式的for循环：在最后两个单行中，直接在序列对象上调用.put方法。在早期版本中，字符串不包含换行符，因此它们将打印为单个长行。
今天我将给你留一些小功课：告诉 say 和 put 之间的差异。
明天见！</p>

    </div>

    
    
    
</article>
      
    
        <article class="summary h-entry notes">
    <header>
        <h2 class="post-title p-name no-text-decoration"><a class="u-url" href='https://ohmyweekly.github.io/notes/a-little-christmas-template-cooking/'> 第二十一天 - 一个小小的圣诞节模板烹饪</a> </h2>
        
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmyweekly.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>


        


    
    
    <div class="post-date">
        
        <time datetime="2018-12-21T20:46:54+0000" class="dt-published">Fri Dec 21, 2018</time>
        
        
    </div>


    </header>

    <div class="post p-summary" >
        <p>Advent Calendar向您展示了许多使用Mojolicious的好方法，因为您已经安装了Mojo，所以除了Web处理之外，您还可以使用它。今天的配方使用模板渲染引擎进行Web响应之外的其他操作。
首先，处理一些字符串模板。这是使用v5.26中发布的波浪形heredoc语法从Mojo::Template中取出的一个示例
use Mojo::Template; my $mt = Mojo::Template-&gt;new; say $mt-&gt;render(&lt;&lt;~&#39;EOF&#39;); % use Time::Piece; &lt;div&gt; % my $now = localtime; Time: &lt;%= $now-&gt;hms %&gt; &lt;/div&gt; EOF 带有前导百分号的行是Perl代码。其中一行加载模块，Time::Piece，另一行创建变量$now。该&lt;%= %&gt;插入值内联。您可以自己找出其他模板语法; 这些都在模块文档中。
您可以将其反转，以便值的来源来自模板外部。有时，这比在让表示层中有太多逻辑更可取：
use v5.26; use Mojo::Template; my $mt = Mojo::Template-&gt;new; use Time::Piece; my $now = localtime; say $mt-&gt;render(&lt;&lt;~&#39;EOF&#39;, $now-&gt;hms ); % my $time = shift; &lt;div&gt; Time: &lt;%= $time %&gt; &lt;/div&gt; EOF 如上所示，默认情况下，参数以位置方式传递给模板。然而，通过名称而不是位置来描述变量更为自然。该vars属性打开您将哈希传递给模板的能力; 哈希键成为模板本身的变量名。
use v5.26; use Mojo::Template; my $mt = Mojo::Template-&gt;new-&gt;vars(1); use Time::Piece; my $now = localtime; say $mt-&gt;render(&lt;&lt;~&#39;EOF&#39;, { time =&gt; $now-&gt;hms } ); &lt;div&gt; Time: &lt;%= $time %&gt; &lt;/div&gt; EOF 从文件（或许多文件）中获取该模板同样容易。这是我以前使用Template Toolkit执行此操作的一种方式，这是一个非常精细且功能强大的模块，与以前一样好。但是，我已经在使用了Mojo的很多东西，它已经有了一个模板引擎。我可以减少依赖计数并专注于一种模板语言。</p>

    </div>

    
    
    
        <div class="readmore no-text-decoration">
            <a href='https://ohmyweekly.github.io/notes/a-little-christmas-template-cooking/'
               title="Read more about 第二十一天 - 一个小小的圣诞节模板烹饪">
                read <span class="more"> more</span>
                <span class="screen-readers-only" > about 第二十一天 - 一个小小的圣诞节模板烹饪</span>
            </a>
        </div>
    
</article>
      
    
</div>



                <footer>
                    

<div class="pagination no-text-decoration">
    
        <a class="pagination-item newer" href="/page/32/">Newer</a>
    
    
        <a class="pagination-item older" href="/page/34/">Older</a>
    
</div>




                    <ul class="no-bullets feed right inline">
    
        
        
            <li class="inline no-text-decoration">
                <a href="https://ohmyweekly.github.io/index.xml">RSS</a>
            </li>
        
    
        
        
            <li class="inline no-text-decoration">
                <a href="https://ohmyweekly.github.io/atom.xml">ATOM</a>
            </li>
        
    
        
        
    
</ul>
<div class="clear-float"></div>

                </footer>
                <hr />
            </div>               

            <footer> 
                

<ul class="social no-text-decoration">
    
</ul>










 
    
    



<p class="generated no-text-decoration">
    Generated using  <a href="https://gitlab.com/kaushalmodi/hugo-theme-refined"><code class="nobr">hugo-theme-refined</code></a> + <span class="nobr">Hugo <a href="https://github.com/gohugoio/hugo/commit/312735366b20d64bd61bff8627f593749f86c964">0.123.7</a></span>
</p>

<p>
    
</p>




<div class="badges no-text-decoration">
    
    

    
</div>




<script type="application/javascript">var nav=responsiveNav("#nav");</script>




<script defer src="/js/libs/fragmentions/wrapper.min.e8c468c89edc4f5dccaa8c720c6b220b3088a16cd7b1e4a1e3345985788260c9.js"></script>









            </footer>
        </div> 
    </body>
</html>
