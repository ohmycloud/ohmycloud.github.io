{"author":{"name":null,"type":"card","url":"https://ohmycloud.github.io/"},"content":{"html":"\u003cp\u003e想把 Desgin Raku 中的 pod/html 转为 Markdown 格式,  Raku 的 pod2markdown 不能用, 只能下载 html 格式的了, 然后用 \u003ccode\u003epandoc test.html  -o result.markdown\u003c/code\u003e 转换了, 但是也不理想, 里面还有很多  html 标签,  写个脚本批量替换下吧。\ntoken 中的空白要显式地使用 \u003ccode\u003e\\s\u003c/code\u003e、\u003ccode\u003e\\h\u003c/code\u003e、\u003ccode\u003e\\t\u003c/code\u003e 等表示, rule 中 \u003ccode\u003e:sigspace\u003c/code\u003e 是开启的。程序很丑, 仅仅是记录一下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-raku\" data-lang=\"raku\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"k\"\u003ev\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"k\"\u003erule\u003c/span\u003e \u003cspan class=\"nf\"\u003er1\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003espan id\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"sr\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003eline_\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"sr\"\u003e\\d\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003espan id\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"sr\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003eline_\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"sr\"\u003e\\d\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;(\u003c/span\u003e\u003cspan class=\"sr\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"sr\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"ni\"\u003e$\u003c/span\u003e\u003cspan class=\"sr\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sr\"\u003emy rule r\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"sr\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\\\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003eline_\u003c/span\u003e\\\u003cspan class=\"nb\"\u003ed\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003espan\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e( \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003espan)?$}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r3 {^id\\=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;line_\\d+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e$}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r4 {\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;smartlink\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r5 {\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;div\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r6 {\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;indexgroup\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r7 {\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;__top\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy token r8 {^  \\s* \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003espan$}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r9 {^id\\=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;line_\\d+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e$}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy rule r10 {id\\=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;line_\\d+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e(\\s\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003espan)?$}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy token r11 {^ \\s* id\\=\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;line_\\d+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#34;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u0026lt;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003emy token r12 {^ \\s* \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e span \\s $}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003efor dir(test =\u0026gt; /.markdown$/) -\u0026gt; $file  {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    my $f = $file;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    $f ~~ s/.markdown//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    my @lines = $file.lines;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    my $out = open $f ~ \u0026#34;.md\u0026#34;, :w;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    for @lines -\u0026gt; $line is rw {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r1\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r2\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r3\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r4\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r5\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r6\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r7\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r8\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r9\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r10\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r11\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $line ~~ s/\u0026lt;r12\u0026gt;//;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        $out.say($line);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    $out.close;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","text":"想把 Desgin Raku 中的 pod/html 转为 Markdown 格式, Raku 的 pod2markdown 不能用, 只能下载 html 格式的了, 然后用 pandoc test.html -o result.markdown 转换了, 但是也不理想, 里面还有很多 html 标签, 写个脚本批量替换下吧。 token 中的空白要显式地使用 \\s、\\h、\\t 等表示, rule 中 :sigspace 是开启的。程序很丑, 仅仅是记录一下。\nuse v6; my rule r1 {\u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;( \u0026#39;\u0026lt;\u0026#39;span)?$} my rule r2 {id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;( \u0026#39;\u0026lt;\u0026#39;span)?$} my rule r3 {^id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;$} my rule r4 {\u0026#39;\u0026lt;\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;smartlink\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;} my rule r5 {\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;div\u0026#39;\u0026gt;\u0026#39;} my rule r6 {\u0026#39;\u0026lt;\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;indexgroup\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;} my rule r7 {\u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;__top\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;} my token r8 {^ \\s* \u0026#39;\u0026lt;\u0026#39;span$} my rule r9 {^id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;$} my rule r10 {id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;(\\s\u0026#39;\u0026lt;\u0026#39;span)?$} my token r11 {^ \\s* id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;} my token r12 {^ \\s* \u0026#39;\u0026lt;\u0026#39; span \\s $} for dir(test =\u0026gt; /.markdown$/) -\u0026gt; $file { my $f = $file; $f ~~ s/.markdown//; my @lines = $file.lines; my $out = open $f ~ \u0026#34;.md\u0026#34;, :w; for @lines -\u0026gt; $line is rw { $line ~~ s/\u0026lt;r1\u0026gt;//; $line ~~ s/\u0026lt;r2\u0026gt;//; $line ~~ s/\u0026lt;r3\u0026gt;//; $line ~~ s/\u0026lt;r4\u0026gt;//; $line ~~ s/\u0026lt;r5\u0026gt;//; $line ~~ s/\u0026lt;r6\u0026gt;//; $line ~~ s/\u0026lt;r7\u0026gt;//; $line ~~ s/\u0026lt;r8\u0026gt;//; $line ~~ s/\u0026lt;r9\u0026gt;//; $line ~~ s/\u0026lt;r10\u0026gt;//; $line ~~ s/\u0026lt;r11\u0026gt;//; $line ~~ s/\u0026lt;r12\u0026gt;//; $out.say($line); } $out.close; } "},"name":"正则替换","published":"2016-04-07T00:00:00Z","summary":"想把 Desgin Raku 中的 pod/html 转为 Markdown 格式, Raku 的 pod2markdown 不能用, 只能下载 html 格式的了, 然后用 pandoc test.html -o result.markdown 转换了, 但是也不理想, 里面还有很多 html 标签, 写个脚本批量替换下吧。 token 中的空白要显式地使用 \\s、\\h、\\t 等表示, rule 中 :sigspace 是开启的。程序很丑, 仅仅是记录一下。\nuse v6; my rule r1 {\u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;( \u0026#39;\u0026lt;\u0026#39;span)?$} my rule r2 {id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;( \u0026#39;\u0026lt;\u0026#39;span)?$} my rule r3 {^id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;$} my rule r4 {\u0026#39;\u0026lt;\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;smartlink\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;} my rule r5 {\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;div\u0026#39;\u0026gt;\u0026#39;} my rule r6 {\u0026#39;\u0026lt;\u0026#39;div class\\=\u0026#39;\u0026#34;\u0026#39;indexgroup\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;} my rule r7 {\u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;__top\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;} my token r8 {^ \\s* \u0026#39;\u0026lt;\u0026#39;span$} my rule r9 {^id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;$} my rule r10 {id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39; \u0026#39;\u0026lt;\u0026#39;span id\\=\u0026#39;\u0026#34;\u0026#39;line_\\d+\u0026#39;\u0026#34;\u0026#39;\u0026#39;\u0026gt;\u0026#39;\u0026#39;\u0026lt;\u0026#39;\u0026#39;/\u0026#39;span\u0026#39;\u0026gt;\u0026#39;(\\s\u0026#39;\u0026lt;\u0026#39;span)?","type":"entry","url":"https://ohmycloud.github.io/posts/2016-04-07-%E6%AD%A3%E5%88%99%E6%9B%BF%E6%8D%A2/"}