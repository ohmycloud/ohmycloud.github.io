<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">

    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    
    
    

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">

    
    <meta name="referrer" content="no-referrer">

    <title>
        
            Phasers ❚ 焉知非鱼
        
    </title>

    
    


    
    
    
    

    
    
    
    

    
    
    

    
    
    
    <style>
     
     
     :root {
         --theme-color: #ac4142;
         --theme-color-light: rgba(172, 65, 66, 0.2);
     }
     
     html {
         line-height: 1.5;
     }
    </style>

    
    

    
    
    
    
    <link rel="stylesheet" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css">
    
    <link rel="preload" href="/css/refined.min.7f6d3ee611034e4ebcbc063f1db3bc042fecdc8901afbedad80ff02bae409204.css" as="style">

    



    
        <style>
         
         /* Background */ .chroma { background-color: #ffffff }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: auto; overflow: auto; display: block; }
/* LineHighlight */ .chroma .hl { display: block; width: 100%;background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* LineNumbers */ .chroma .ln { margin-right: 0.4em; padding: 0 0.4em 0 0.4em; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

         
         /* Overrides on top of the theme and Chroma CSS */
/* Chroma-based lines highlighting in code blocks */
.chroma .hl {
    background-color: #e8e8e8;
    /* Extend highlight up to 100 characters (assuming that the code blocks never have more than 100 characters in a line) */
    min-width: 100ch;
}
/* GenericHeading */ .chroma .gh { color: #999999; font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa; font-weight: bold }

         
        </style>
    

    

    
    
    

    
    <script src="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js"></script>
    
    <link rel="preload" href="/js/responsive-nav-orig.min.e2b5f2a956b488f466da513820636134defdc38b90ed566248960593f2bb4ba5.js" as="script">

    
    
    <script defer src="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js"></script>
    
    <link rel="preload" href="/js/libs/fa/fontawesome-all.min.08916ac0fd078adfb58edc890460e2c8990729aee02bca7586404b56805f5219.js" as="script">

    

    

    
    
    

    
    
<!-- rel="me" links for IndieAuth -->







    
 
<meta property="og:title" content="Phasers" />
<meta property="og:description"
      content=" " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ohmycloud.github.io/posts/58.phasers/" />


    
        <meta property="article:published_time" content="2018-12-02T21:13:31&#43;08:00"/>
    
    
        <meta property="article:modified_time" content="2018-12-02T21:13:31&#43;08:00"/>
    









    




     <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Phasers"/>
<meta name="twitter:description" content=" "/>


    
    
    <link rel="alternate" type="application/jf2post+json" href="https://ohmycloud.github.io/posts/58.phasers/jf2post.json" title="Jf2post for 焉知非鱼" />
    
     



    
    
    
        
    


     
        
        <meta name="DC.Creator" content="焉知非鱼"/>
    



    
    
    
    <meta name="hugo-build-date" content="2024-03-01T16:16:06Z"/>
    <meta name="hugo-commit-hash" content="312735366b20d64bd61bff8627f593749f86c964"/>
    <meta name="generator" content="Hugo 0.123.7">
</head>


    
        <body lang="en">
    

        
        <div class="border" id="home"></div>

        <div class="wrapper">   
            
<nav id="nav" class="nav-collapse opened" aria-hidden="false">
    <ul class="navbar">
        <li><a class="" href="/">Home</a></li>
        
            
                <li><a class="" href="https://ohmycloud.github.io/posts/">Posts</a></li>
            
        
            
                <li><a class="" href="https://ohmycloud.github.io/notes/">Notes</a></li>
            
        
        
            <li><a class="" href="https://ohmycloud.github.io/search/">Search</a></li>
        
    </ul>
</nav>

            <div class="container">
                <header class="masthead">
                    <div class="masthead-title no-text-decoration">
                        <a href="/">焉知非鱼</a> <span class="blinking-cursor">❚</span>
                    </div>
                    <div class="masthead-tagline">
                        Wait the light to fall
                    </div>
                </header>

                








<article class="post h-entry posts">
    <header>
        <div class="center">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmycloud.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmycloud.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>

        <h1 class="post-title p-name">Phasers</h1>

        
        <data class="u-url" value="https://ohmycloud.github.io/posts/58.phasers/"></data>

        <div class="date-syndication">
            


    
    
    <div class="post-date">
        
        <time datetime="2018-12-02T21:13:31+0800" class="dt-published">Sun Dec 2, 2018</time>
        
        
    </div>


            




        </div>
         



    
    
    
        
    


    
        
        <span class="hide">
            &mdash; <a href="https://ohmycloud.github.io/" class="u-author">焉知非鱼</a>
        </span>
    


    </header>

    <div class="content">
        


        





                       


        <div class="e-content">
            




<p>程序的生命周期（执行时间表）分为几个阶段。<em>phaser</em>是在特定执行阶段调用的代码块。</p>
<h1 id="phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Phasers</a></h1>
<p>phaser 块只是包含它的闭包的 trait，并在适当的时刻自动调用。这些自动调用的块称为 <em>phasers</em>，因为它们通常标记从计算的一个阶段到另一个阶段的转换。例如，在编译编译单元结束时调用 <code>CHECK</code> 块。也可以安装其他类型的 phasers; 它们会在适当的时候自动调用，其中一些 phasers 响应各种控制异常和退出值。例如，如果块的退出成功或失败，则可能会调用某些 phasers，在这种情况下<em>成功</em>退出, 则在这时返回定义的值或列表，而不带任何 <code>Failure</code> 或异常。</p>
<p>以下是摘要：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">  <span class="k">BEGIN</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  * at compile time, as soon as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">  <span class="k">CHECK</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  * at compile time, as late as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">   <span class="k">INIT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  * at runtime, as soon as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">    <span class="k">END</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at runtime, as late as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">    <span class="k">DOC</span> <span class="o">[</span><span class="k">BEGIN</span><span class="o">|</span><span class="k">CHECK</span><span class="o">|</span><span class="k">INIT</span><span class="o">]</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1"># only in documentation mode </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="k">ENTER</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  * at every block entry time, repeats on loop blocks. </span>
</span></span><span class="line"><span class="cl">  <span class="k">LEAVE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every block exit time (even stack unwinds from exceptions) </span>
</span></span><span class="line"><span class="cl">   <span class="k">KEEP</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every successful block exit, part of LEAVE queue </span>
</span></span><span class="line"><span class="cl">   <span class="k">UNDO</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every unsuccessful block exit, part of LEAVE queue </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="k">FIRST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop initialization time, before any ENTER </span>
</span></span><span class="line"><span class="cl">   <span class="k">NEXT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop continuation time, before any LEAVE </span>
</span></span><span class="line"><span class="cl">   <span class="k">LAST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop termination time, after any LEAVE </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">PRE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  assert precondition at every block entry, before ENTER </span>
</span></span><span class="line"><span class="cl">   <span class="k">POST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  assert postcondition at every block exit, after LEAVE </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="k">CATCH</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch exceptions, before LEAVE </span>
</span></span><span class="line"><span class="cl"><span class="k">CONTROL</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch control exceptions, before LEAVE </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">   <span class="k">LAST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  supply tapped by whenever-block is done, runs very last </span>
</span></span><span class="line"><span class="cl">   <span class="k">QUIT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch async exceptions within a whenever-block, runs very last </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">COMPOSE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  when a role is composed into a class (Not yet implemented) </span>
</span></span><span class="line"><span class="cl">  <span class="k">CLOSE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  appears in a supply block, called when the supply is closed </span>
</span></span></code></pre></div><p>标记为 <code>*</code> 号的 phaser 具有运行时值，并且如果早于周围表达式进行求值，则只需保存其结果，以便在以后计算表达式的其余部分时在表达式中使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$compiletime</span> <span class="o">=</span> <span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">now</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">our</span> <span class="nv">$random</span> <span class="o">=</span> <span class="k">ENTER</span> <span class="p">{</span> <span class="nb">rand</span> <span class="p">};</span>
</span></span></code></pre></div><p>与其他语句前缀一样，这些产生值的构造可以放在块或语句的前面：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$compiletime</span> <span class="o">=</span> <span class="k">BEGIN</span> <span class="nb">now</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">our</span> <span class="nv">$random</span> <span class="o">=</span> <span class="k">ENTER</span> <span class="nb">rand</span><span class="p">;</span>
</span></span></code></pre></div><p>这些 phaser 的大多数将接收块或函数引用。语句形式对于将词法作用域的声明暴露给周围的词法作用域而不在块中“捕获”它特别有用。</p>
<p>它们声明了与前面示例相同作用域的相同变量，但在指定时间把语句作为整体运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">BEGIN</span> <span class="k">my</span> <span class="nv">$compiletime</span> <span class="o">=</span> <span class="nb">now</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">ENTER</span> <span class="k">our</span> <span class="nv">$random</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">;</span>
</span></span></code></pre></div><p>（但请注意，在运行时克隆任何周围闭包时，在编译时计算的变量值可能不会持久存在。）</p>
<p>大多数非值生成 phasers 也可能如此使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">END</span> <span class="nb">say</span> <span class="k">my</span> <span class="nv">$accumulator</span><span class="p">;</span>
</span></span></code></pre></div><p>但请注意：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">END</span> <span class="nb">say</span> <span class="k">my</span> <span class="nv">$accumulator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><p>在 <code>END</code> time 时将变量设置为 0 ，因为这是实际执行 “my” 声明的时间。只有无参数的 phasers 可以使用语句形式。这意味着 <code>CATCH</code> 和 <code>CONTROL</code> 始终需要一个块，因为它们接收一个设置 <code>$_</code> 为当前主题的参数，以便内部行为能够表现为 switch 语句。（如果允许使用裸语句，那么 <code>$_</code> 临时绑定会在 <code>CATCH</code>或者<code>CONTROL</code> 结束时泄漏出来，带来不可预测的，甚至可能是可怕的后果。异常处理程序应该减少不确定性，而不是增加它。）</p>
<p>其中一些 phasers 也具有可以在变量上设置的相应 trait; 他们使用 <code>will</code> 后面跟着小写的 phaser 名称。这些优点是将讨论中的变量作为主题传递给闭包：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">our</span> <span class="nv">$h</span> <span class="n">will</span> <span class="n">enter</span> <span class="p">{</span> <span class="o">.</span><span class="nf">rememberit</span><span class="p">()</span> <span class="p">}</span> <span class="n">will</span> <span class="n">undo</span> <span class="p">{</span> <span class="o">.</span><span class="nf">forgetit</span><span class="p">()</span> <span class="p">};</span>
</span></span></code></pre></div><p>只有在块内可以多次出现的 phaser 才有资格获得这种每个变量(per-variable)形式; 这不包括 <code>CATCH</code> 和其他例如 <code>CLOSE</code> 或 <code>QUIT</code> phaser 。</p>
<p>phaser 外部的块的主题作为 <code>OUTER::&lt;$_&gt;</code> 仍然可用。返回值是否可修改可能是所讨论的 phaser 的策略。特别地，不应在 <code>POST</code> phaser 内修改返回值，但 <code>LEAVE</code> phaser 可能更自由。</p>
<p>在方法的词法作用域中定义的任何 phaser 都是闭合 <code>self</code> 以及正常词汇。（或者等效地，实现可以简单地将所有这样的 phaser 转换为其引导的调用者是当前对象的子方法。）</p>
<p>当多个 phaser 被安排在同一时刻运行时，一般的打破平局的原则是初始化 phaser 按照声明的顺序执行，而最终 phaser 以相反的顺序执行，因为设置和拆除通常希望以相反的顺序相互发生。</p>
<h2 id="执行顺序httpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">执行顺序</a>&nbsp;<a class="headline-hash no-text-decoration" href="#执行顺序httpsdocsrakuorglanguagephasers___top">#</a> </h2>
<p>编译开始</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">      <span class="k">BEGIN</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at compile time, As soon as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">      <span class="k">CHECK</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at compile time, As late as possible, only ever runs once </span>
</span></span><span class="line"><span class="cl">    <span class="n">COMPOSE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  when a role is composed into a class (Not yet implemented) </span>
</span></span></code></pre></div><p>执行开始</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">       <span class="k">INIT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at runtime, as soon as possible, only ever runs once </span>
</span></span></code></pre></div><p>在块执行开始之前</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">        <span class="k">PRE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  assert precondition at every block entry, before ENTER </span>
</span></span></code></pre></div><p>循环执行开始</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">      <span class="k">FIRST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop initialization time, before any ENTER </span>
</span></span></code></pre></div><p>块执行开始</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">      <span class="k">ENTER</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every block entry time, repeats on loop blocks. </span>
</span></span></code></pre></div><p>可能会发生异常</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">      <span class="k">CATCH</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch exceptions, before LEAVE </span>
</span></span><span class="line"><span class="cl">    <span class="k">CONTROL</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch control exceptions, before LEAVE </span>
</span></span></code></pre></div><p>循环结束，继续或结束</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">       <span class="k">NEXT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop continuation time, before any LEAVE </span>
</span></span><span class="line"><span class="cl">       <span class="k">LAST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at loop termination time, after any LEAVE </span>
</span></span></code></pre></div><p>块结束</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">      <span class="k">LEAVE</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every block exit time (even stack unwinds from exceptions) </span>
</span></span><span class="line"><span class="cl">       <span class="k">KEEP</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every successful block exit, part of LEAVE queue </span>
</span></span><span class="line"><span class="cl">       <span class="k">UNDO</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at every unsuccessful block exit, part of LEAVE queue </span>
</span></span></code></pre></div><p>块的后置条件</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">       <span class="k">POST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  assert postcondition at every block exit, after LEAVE </span>
</span></span></code></pre></div><p>异步 whenever-block 结束</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">       <span class="k">LAST</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  if ended normally with done, runs once after block </span>
</span></span><span class="line"><span class="cl">       <span class="k">QUIT</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  catch async exceptions </span>
</span></span></code></pre></div><p>程序终止</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl">        <span class="k">END</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="c1">#  at runtime, ALAP, only ever runs once </span>
</span></span></code></pre></div><h1 id="程序执行-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">程序执行 phasers</a></h1>
<h2 id="begin">BEGIN&nbsp;<a class="headline-hash no-text-decoration" href="#begin">#</a> </h2>
<p>编译时运行，一旦 phaser 中的代码编译完毕，就只运行一次。</p>
<p>返回值可在以后的 phaser 中使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">About to print 3 things</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">^</span><span class="mi">3</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="o">^</span><span class="mi">10</span> <span class="o">.</span><span class="nb">pick</span> <span class="o">~</span> <span class="p">&#39;</span><span class="s1">-</span><span class="p">&#39;</span> <span class="o">~</span> <span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">say</span>  <span class="p">&#34;</span><span class="s2">Generating BEGIN value</span><span class="p">&#34;;</span> <span class="o">^</span><span class="mi">10</span> <span class="o">.</span><span class="nb">pick</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Generating BEGIN value </span>
</span></span><span class="line"><span class="cl"><span class="c1"># About to print 3 things </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3-3 </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4-3 </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 6-3 </span>
</span></span></code></pre></div><p>phaser 中的 <code>^10 .pick</code> 只产生一次，并在运行时期间由循环重用。注意怎么 <code>BEGIN</code> 块中的 <a href="https://docs.raku.org/routine/say">say</a> 是在上述循环执行之前是怎么执行的。</p>
<h2 id="check">CHECK&nbsp;<a class="headline-hash no-text-decoration" href="#check">#</a> </h2>
<p>在编译时运行，尽可能晚，只运行一次。</p>
<p>可以具有即使在后期 phases 提供的返回值。</p>
<p>在运行时生成的代码仍然可以启动 <code>CHECK</code> 和 <code>INIT</code> phasers，但当然这些 phaser 无法做出需要及时返回的事情。你需要一个虫洞。</p>
<h2 id="init">INIT&nbsp;<a class="headline-hash no-text-decoration" href="#init">#</a> </h2>
<p>在 main 执行期间编译后运行，尽快运行一次。它可以具有即使在后期 phases 也提供的返回值。</p>
<p>当 phaser 位于不同的模块中时， phaser <code>INIT</code> 和 <code>END</code> phaser 将被视为在使用模块中就像在 <code>use</code> 时声明一样。（如果模块被多次使用，则依赖于此顺序是错误的，因为仅在第一次注意到它们时才安装 phaser 。）</p>
<p>在运行时生成的代码仍然可以启动 <code>CHECK</code> 和 <code>INIT</code> phaser，但当然这些 phaser 无法做出需要及时返回的事情。你需要一个虫洞。</p>
<p>对 <code>INIT</code> 克隆闭包的所有副本只运行一次。</p>
<h2 id="end">END&nbsp;<a class="headline-hash no-text-decoration" href="#end">#</a> </h2>
<p>在 main 执行期间编译后运行，尽可能晚，只运行一次。</p>
<p>当 phaser 位于不同的模块中时， <code>INIT</code> 和 <code>END</code> phaser 将被视为在正使用的模块中就像在 <code>use</code> 时声明一样。（如果模块被多次使用，则依赖于此顺序是错误的，因为仅在第一次注意到它们时才安装 phaser 。）</p>
<h1 id="block-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Block phasers</a></h1>
<p>块的上下文中的执行具有其自己的 phases。</p>
<p>块离开 phaser 等待直到调用堆栈实际展开才能运行。只有在某个异常处理程序决定以这种方式处理异常之后才会展开。也就是说，仅仅因为异常被抛出堆栈帧并不意味着我们已经正式离开了块，因为异常可能是可恢复的。在任何情况下，异常处理程序都指定在失败代码的动态作用域内运行，无论异常是否可恢复。堆栈已展开，仅在未恢复异常时才调用 phaser 。</p>
<p>这些可以在块内多次出现。所以它们确实不是真正的 trait - 它们将自己添加到存储在实际 trait 中的列表中。如果你检查块的 <code>ENTER</code> trait，你会发现它实际上是一个 phaser 列表而不是一个 phaser 。</p>
<p>所有这些 phaser 块都可以看到任何先前声明的词法变量，即使在调用闭包时尚未详细说明这些变量（在这种情况下，变量会计算为未定义的值。）</p>
<h2 id="enter">ENTER&nbsp;<a class="headline-hash no-text-decoration" href="#enter">#</a> </h2>
<p>在每个块进入时运行，在循环块上重复。</p>
<p>可以具有即使在后期 phases 提供的返回值。</p>
<p>从 <code>ENTER</code> phaser 抛出的异常将中止 <code>ENTER</code> 队列，但是从 <code>LEAVE</code> phaser 抛出的异常将不会。</p>
<h2 id="leave">LEAVE&nbsp;<a class="headline-hash no-text-decoration" href="#leave">#</a> </h2>
<p>在每个块退出时运行（甚至堆栈从异常中展开），除非程序突然退出（例如 <a href="https://docs.raku.org/routine/exit"><code>exit</code></a>）。</p>
<p><code>LEAVE</code> 在任何 <code>CATCH</code> 和 <code>CONTROL</code> phaser 之后必须计算给定块的 phaser 。这包括 <code>LEAVE</code> 变体，<code>KEEP</code> 和 <code>UNDO</code>。<code>POST</code> 在其他一切之后对 phaser 进行计算，以保证偶数 <code>LEAVE</code> phaser 不会违反后置条件。</p>
<p>从 <code>ENTER</code> phaser 抛出的异常将中止 <code>ENTER</code> 队列，但是从 <code>LEAVE</code> phaser 抛出的异常将不会。</p>
<p>如果 <code>POST</code> 失败或任何类型的 <code>LEAVE</code> 块在堆栈展开时抛出异常，则展开继续并收集要处理的异常。展开完成后，将从该点抛出所有新异常。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">answer</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">LEAVE</span> <span class="nb">say</span> „<span class="n">I</span> <span class="nb">say</span> <span class="nb">after</span> <span class="n">the</span> <span class="k">return</span> <span class="nb">value</span><span class="o">.</span>“<span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="mi">42</span> <span class="c1"># this is the return value </span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>注意:</strong> 铭记 <code>LEAVE</code> phaser 直接在程序的块，即使用错误的参数尝试调用该例程, 他们也将得到执行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">sub</span> <span class="nf">foo</span> <span class="p">(</span><span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Hello!</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">    <span class="k">LEAVE</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">oh noes!</span><span class="p">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="n">foo</span> <span class="nb">rand</span><span class="p">;</span> <span class="c1"># OUTPUT: «oh noes!» </span>
</span></span></code></pre></div><p>虽然子程序的主体没有得到执行，因为 sub 的<a href="https://docs.raku.org/type/Int">Int</a> 和 <a href="https://docs.raku.org/routine/rand"><code>rand</code></a> 期望返回一个 <a href="https://docs.raku.org/type/Num">Num</a>，其块进入和离开时（指令绑定失败），因此 <code>LEAVE</code> phaser <em>正</em>运行。</p>
<h2 id="keep">KEEP&nbsp;<a class="headline-hash no-text-decoration" href="#keep">#</a> </h2>
<p>在每个成功的块出口处运行，作为 LEAVE 队列的一部分（共享相同的执行顺序）。</p>
<h2 id="undo">UNDO&nbsp;<a class="headline-hash no-text-decoration" href="#undo">#</a> </h2>
<p>在每个不成功的块出口处运行，作为 LEAVE 队列的一部分（共享相同的执行顺序）。</p>
<h2 id="pre">PRE&nbsp;<a class="headline-hash no-text-decoration" href="#pre">#</a> </h2>
<p>断言每个块条目的前提条件。在 ENTER phase 之前运行。</p>
<p><code>PRE</code> phaser 在任何 <code>ENTER</code> 或 <code>FIRST</code> 之前启动。</p>
<p>失败的 <code>PRE</code> 和 <code>POST</code> phaser 抛出的异常不能被同一个块中的 <code>CATCH</code> 异常捕获，这意味着如果<code>PRE</code>phaser 失败，则 <code>POST</code> phaser 不会运行。</p>
<h2 id="post">POST&nbsp;<a class="headline-hash no-text-decoration" href="#post">#</a> </h2>
<p>在每个块条目处断言后置条件。在 LEAVE phase 后运行。</p>
<p>对于如 <code>KEEP</code> 和 <code>POST</code> 的 phaser，在正常情况下退出作用域时运行，返回值（如果有的话）从该作用域可作为 phaser 中的当前主题。</p>
<p><code>POST</code> 块可以以两种方式之一来定义。要么 <code>POST</code> 定义为单独的 phaser ，在这种情况下 <code>PRE</code> 和 <code>POST</code> 不共享词法作用域。或者，任何 <code>PRE</code> phaser 都可以将其对应的 <code>POST</code> 定义为嵌入式 phaser 块，该 phaser 块封闭在 <code>PRE</code> 的词法作用域内。</p>
<p>如果 <code>POST</code> 失败或任何类型的 <code>LEAVE</code> 块在堆栈展开时抛出异常，则展开继续并收集要处理的异常。展开完成后，将从该点抛出所有新异常。</p>
<p><code>PRE</code> 和 <code>POST</code> phaser 抛出的异常不能被同一个块中的  <code>CATCH</code> 异常捕获，这意味着如果 <code>PRE</code> phaser 失败，<code>POST</code> phaser 就不会运行。</p>
<h1 id="loop-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Loop phasers</a></h1>
<p><code>FIRST</code>，<code>NEXT</code> 和 <code>LAST</code> 仅在循环的词法作用域内有意义，并且可能仅在这样的循环块的顶层发生。</p>
<h2 id="first">FIRST&nbsp;<a class="headline-hash no-text-decoration" href="#first">#</a> </h2>
<p>在 ENTER 之前运行循环初始化。</p>
<h2 id="next">NEXT&nbsp;<a class="headline-hash no-text-decoration" href="#next">#</a> </h2>
<p>循环继续（通过 <code>next</code> 或因为你到达循环的底部并循环回来）时运行，在LEAVE之前。</p>
<p>仅当正常到达循环块的末尾或 <code>next</code>显式 执行时，才执行 <code>NEXT</code>。 与 <code>LEAVE</code> phaser 不同，<code>NEXT</code> 如果通过除由 <code>next</code> 引发的控制异常之外的任何异常退出循环块，则不执行 <code>NEXT</code> phaser。特别地，<code>last</code> 绕过了 <code>NEXT</code> phaser 的计算。</p>
<h2 id="last">LAST&nbsp;<a class="headline-hash no-text-decoration" href="#last">#</a> </h2>
<p>在循环结束时运行，在 <code>LEAVE</code> 之后(或者当它使用 <code>last</code> 或 <code>return</code> 退出时; 或者因为你到了循环的底部) 。</p>
<h1 id="exception-handling-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Exception handling phasers</a></h1>
<h2 id="catch">CATCH&nbsp;<a class="headline-hash no-text-decoration" href="#catch">#</a> </h2>
<p>在 LEAVE phase 之前，当前块引发异常时运行。</p>
<h2 id="control">CONTROL&nbsp;<a class="headline-hash no-text-decoration" href="#control">#</a> </h2>
<p>在 LEAVE phase 之前，当前块引发控制异常时运行。它通过 <code>return</code>，<code>fail</code>，<code>redo</code>，<code>next</code>，<code>last</code>，<code>emit</code>，<code>take</code>，<code>warn</code>，<code>proceed</code> 和 <code>succeed</code> 发生。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="nb">say</span> <span class="nb">elems</span> <span class="k">gather</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">CONTROL</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">when</span> <span class="ne">CX::Warn</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">WARNING!!! </span><span class="nv">$_</span><span class="p">&#34;;</span> <span class="o">.</span><span class="nb">resume</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">when</span> <span class="ne">CX::Take</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#34;</span><span class="s2">Don&#39;t take my stuff</span><span class="p">&#34;;</span> <span class="o">.</span><span class="nb">resume</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">warn</span> <span class="p">&#39;</span><span class="s1">people take stuff here</span><span class="p">&#39;;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">take</span> <span class="p">&#39;</span><span class="s1">keys</span><span class="p">&#39;;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OUTPUT: </span>
</span></span><span class="line"><span class="cl"><span class="c1"># WARNING!!! people take stuff here </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Don&#39;t take my stuff </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 0 </span>
</span></span></code></pre></div><h1 id="object-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Object phasers</a></h1>
<h2 id="compose-not-yet-implemented">COMPOSE (Not yet implemented)&nbsp;<a class="headline-hash no-text-decoration" href="#compose-not-yet-implemented">#</a> </h2>
<p>将角色组合到一个类中时运行。</p>
<h1 id="asynchronous-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">Asynchronous phasers</a></h1>
<h2 id="last-1">LAST&nbsp;<a class="headline-hash no-text-decoration" href="#last-1">#</a> </h2>
<p>当<a href="https://docs.raku.org/type/Supply">Supply</a> 完成 <code>done</code> 调用或当一个 <code>supply</code> 块正常退出时运行。它在 <code>whenever</code> 块完成后完全运行。</p>
<p>此 phaser 重用该名称 <code>LAST</code>，但与 <code>LAST</code> 循环 phaser 的工作方式不同。此 phaser 类似于用 <code>tap</code> supply 设置例程 <code>done</code>。</p>
<h2 id="quit">QUIT&nbsp;<a class="headline-hash no-text-decoration" href="#quit">#</a> </h2>
<p>当 <a href="https://docs.raku.org/type/Supply">Supply</a> 以异常提前终止时运行。它在放置的  <code>whenever</code> 块完成后运行。</p>
<p>此 phaser 类似于 <code>quit</code> 在 <code>tap</code> supply 时设置例程 <code>quit</code>。</p>
<h2 id="close">CLOSE&nbsp;<a class="headline-hash no-text-decoration" href="#close">#</a> </h2>
<p>出现在 supply 块中。supply 关闭时调用。</p>
<h1 id="doc-phasershttpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">DOC phasers</a></h1>
<h2 id="doc">DOC&nbsp;<a class="headline-hash no-text-decoration" href="#doc">#</a> </h2>
<p>phaser <code>BEGIN</code>，<code>CHECK</code> 和 <code>INIT</code> 仅在文档模式时，前面带有 <code>DOC</code> 关键字。当使用 <code>--doc</code> 运行时编译器在文档中。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">DOC</span> <span class="k">INIT</span> <span class="p">{</span> <span class="nb">say</span> <span class="p">&#39;</span><span class="s1">init</span><span class="p">&#39;</span>  <span class="p">}</span>  <span class="c1"># prints &#39;init&#39; at initialization time when in documentation mode. </span>
</span></span></code></pre></div>

        </div>
    </div>
</article>



                <footer>
                    




<div class="no-text-decoration">
    <div class="jump top"><a href="#" title="Top of this page">⮉</a></div>
    <div class="jump bottom"><a href="#bottom" title="Bottom of this page">⮋</a></div>
</div>


 
    
        <div class="hugotoc no-text-decoration">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#执行顺序httpsdocsrakuorglanguagephasers___top"><a href="https://docs.raku.org/language/phasers#___top">执行顺序</a></a></li>
  </ul>

  <ul>
    <li><a href="#begin">BEGIN</a></li>
    <li><a href="#check">CHECK</a></li>
    <li><a href="#init">INIT</a></li>
    <li><a href="#end">END</a></li>
  </ul>

  <ul>
    <li><a href="#enter">ENTER</a></li>
    <li><a href="#leave">LEAVE</a></li>
    <li><a href="#keep">KEEP</a></li>
    <li><a href="#undo">UNDO</a></li>
    <li><a href="#pre">PRE</a></li>
    <li><a href="#post">POST</a></li>
  </ul>

  <ul>
    <li><a href="#first">FIRST</a></li>
    <li><a href="#next">NEXT</a></li>
    <li><a href="#last">LAST</a></li>
  </ul>

  <ul>
    <li><a href="#catch">CATCH</a></li>
    <li><a href="#control">CONTROL</a></li>
  </ul>

  <ul>
    <li><a href="#compose-not-yet-implemented">COMPOSE (Not yet implemented)</a></li>
  </ul>

  <ul>
    <li><a href="#last-1">LAST</a></li>
    <li><a href="#quit">QUIT</a></li>
    <li><a href="#close">CLOSE</a></li>
  </ul>

  <ul>
    <li><a href="#doc">DOC</a></li>
  </ul>
</nav>
            <a href="#" class="back-to-top">Back to top</a>
        </div>
    
    
<script src="/js/libs/jquery/3.3.1/jquery.slim.min.min.22ee3db0c0e99fd0fbce3aee19672bd53d25469daf734bd4c165649f6eaf7d7f.js"></script>

<link rel="preload" href="/js/libs/jquery/3.3.1/jquery.slim.min.min.22ee3db0c0e99fd0fbce3aee19672bd53d25469daf734bd4c165649f6eaf7d7f.js" as="script">

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6, .h-feed h2');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>








<div class="backtotop center no-text-decoration">
    <a href="#">back to <span class="top">top</span></a>
</div>


<div class="right">
    <div class="taxo no-text-decoration">
         
            
                <ul class="no-bullets inline categories">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts categorized in ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmycloud.github.io/categories/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
         
            
                <ul class="no-bullets inline tags">
                    
                        
                        
                        
                            
                            
                            
                            
                            
                            <li class="__rakulang__"
                                
                                
                                title="See all 0 posts tagged with ‘rakulang’"
                                
                            >
                                <a class="p-category" href="https://ohmycloud.github.io/tags/rakulang/">rakulang</a>
                            </li>
                        
                    
                </ul>
            
        
    </div>

</div>
<div class="clear-float"></div>



<div class="prev-next-navigator clear-float">
    
        <span class="prev-post left no-text-decoration">
            <a href="https://ohmycloud.github.io/notes/automatic-reload-for-rapid-development/" class="nobr">« 第二天 - 自动重载以实现快速开发</a>
        </span>
    
    
        <span class="next-post right no-text-decoration">
            <a href="https://ohmycloud.github.io/posts/57.perl-6-native-types/" class="nobr">Raku 原生类型 »</a>
        </span>
    
</div>


<a id="bottom"></a>









                       







                    <ul class="no-bullets feed right inline">
    
        
        
    
</ul>
<div class="clear-float"></div>

                </footer>
                <hr />
            </div>               

            <footer> 
                

<ul class="social no-text-decoration">
    
</ul>










 
    
    



<p class="generated no-text-decoration">
    Generated using  <a href="https://gitlab.com/kaushalmodi/hugo-theme-refined"><code class="nobr">hugo-theme-refined</code></a> + <span class="nobr">Hugo <a href="https://github.com/gohugoio/hugo/commit/312735366b20d64bd61bff8627f593749f86c964">0.123.7</a></span>
</p>

<p>
    
</p>




<div class="badges no-text-decoration">
    
    

    
</div>




<script type="application/javascript">var nav=responsiveNav("#nav");</script>




<script defer src="/js/libs/fragmentions/wrapper.min.e8c468c89edc4f5dccaa8c720c6b220b3088a16cd7b1e4a1e3345985788260c9.js"></script>









            </footer>
        </div> 
    </body>
</html>
